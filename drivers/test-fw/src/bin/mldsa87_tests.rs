/*++

Licensed under the Apache-2.0 license.

File Name:

    ml_dsa87_tests.rs

Abstract:

    File contains test cases for ML_DSA87 API tests

--*/

#![no_std]
#![no_main]

use caliptra_cfi_lib::CfiCounter;
use caliptra_drivers::{
    Array4x12, Array4x8, Hmac, HmacData, HmacKey, HmacMode, HmacTag, KeyId, KeyReadArgs, KeyUsage,
    KeyWriteArgs, Mldsa87, Mldsa87Msg, Mldsa87PrivKey, Mldsa87PubKey, Mldsa87Result, Mldsa87Seed,
    Mldsa87SignRnd, Mldsa87Signature, Trng,
};
use caliptra_registers::csrng::CsrngReg;
use caliptra_registers::entropy_src::EntropySrcReg;
use caliptra_registers::hmac::HmacReg;
use caliptra_registers::mldsa::MldsaReg;
use caliptra_registers::soc_ifc::SocIfcReg;
use caliptra_registers::soc_ifc_trng::SocIfcTrngReg;
use caliptra_test_harness::test_suite;
const PUBKEY: [u32; 648] = [
    2776943115, 2278814877, 3145177904, 1115298293, 3891791449, 2184980234, 2020299903, 831515674,
    4069053305, 312832371, 2930448613, 1762516023, 2284577342, 626395074, 1982083788, 4260306807,
    2048792879, 2066462906, 3376598221, 4258254945, 716540906, 3228370860, 4227265245, 995152723,
    1969023223, 2101544496, 577017510, 863843867, 3941852917, 717828831, 41099135, 3097591753,
    162318810, 2890528773, 816407175, 1966902258, 362468064, 228586644, 2480816774, 2917103086,
    1474686386, 1714379146, 2156733459, 1802409140, 3869121947, 1968119186, 906399498, 3374264381,
    2726843582, 3244241474, 1588308380, 1176305605, 2589131228, 1117338090, 2799648312, 1629580629,
    523467774, 2839705437, 4172622022, 454297261, 2455051598, 2466738651, 3345601590, 1942656338,
    793569608, 226831269, 2150147880, 3354251725, 3435439597, 3992691402, 2270586786, 2471264339,
    3026288341, 892388765, 3651109074, 3355191846, 128874991, 3595444075, 1560361401, 3138128004,
    3720380410, 552733775, 1971360729, 169104023, 4089549564, 431787144, 753996941, 3909040157,
    2633405770, 3390823185, 927810328, 2449721886, 463082827, 1233821549, 1106238034, 1894126534,
    3339817497, 273879814, 1671142667, 3442617444, 1841861607, 3461754084, 815186727, 1311069391,
    2115256440, 1361482217, 294762487, 2884553213, 1879149407, 1828504594, 1298731983, 4237098887,
    2529577268, 2493786431, 3458910867, 439524015, 1970515051, 1900318804, 2706461166, 2956401619,
    732555775, 2615357999, 664982399, 543705246, 2627871277, 1831570972, 933487741, 2632148329,
    2415194350, 1828971213, 883762233, 3856647617, 1382801495, 2832015287, 874841008, 187815290,
    542777466, 841113866, 3686119581, 2880316067, 2293718593, 1093473558, 2337449259, 1255990794,
    1177858302, 3219447589, 1645849729, 3925404693, 3947780756, 399434436, 1148027456, 148630373,
    714460950, 1308763211, 3752320101, 1698804611, 187009963, 1756233002, 264286754, 14261675,
    1708891677, 2632418875, 1283575566, 2097855703, 3748796666, 652971934, 1499110510, 3434472601,
    4242960749, 651339714, 3353285188, 4004359450, 2968139806, 4248574635, 1980896723, 1771432532,
    3022316065, 520375649, 3862538371, 1126901296, 795720796, 2649962129, 3470390934, 3013572714,
    1477919769, 3406181471, 1216855383, 1594255521, 2169628549, 1068706924, 847332510, 913908005,
    129545315, 1804076302, 432565057, 3448544381, 245810209, 1196824690, 12020780, 1873189872,
    942153130, 2766915162, 1508099580, 3893279586, 495495122, 142721521, 284150413, 3563159367,
    112990334, 2450884401, 3639573987, 1916660191, 1869592682, 4013041706, 3557228412, 1158826936,
    331584751, 529244442, 839633546, 574563898, 1759893155, 204523180, 2598241387, 287475744,
    2205601880, 2683031048, 2726456077, 2180810200, 2488746912, 2087434384, 2261397413, 1120377589,
    2062575616, 2480296816, 1020316272, 512703825, 8191283, 1690719047, 2807975098, 1051833149,
    847315860, 2946937931, 1712605409, 791235361, 3796430939, 2397679128, 2674048103, 1086598195,
    657276629, 4111009182, 3579938023, 2248681984, 1096386494, 4099510195, 49484434, 2793696671,
    2603031741, 2055506213, 232200660, 2555661502, 3916811043, 1543421126, 871548074, 1228583378,
    258912188, 2957073625, 1311565145, 2257389720, 2005400431, 3909565202, 3314663965, 536180039,
    1997305039, 3519366893, 395169197, 1554021199, 1764412415, 510038037, 1342073882, 3214643864,
    1990049252, 171448937, 1971025383, 394900289, 1815339120, 1733458112, 1477778722, 2972545569,
    1847797195, 2157512198, 41346775, 2283903370, 3558756838, 2112221990, 3597505411, 4106091904,
    3632174287, 701026714, 217015778, 1173910565, 129557381, 3648279303, 1897857230, 1633665788,
    1106358081, 1037052124, 859221490, 4015189821, 3995444153, 2023282844, 951638887, 1712308416,
    3475445276, 1294655751, 1188766152, 985364620, 1308798695, 2246965130, 1362128006, 191265323,
    156288229, 3110196334, 3589144525, 2263097119, 1145520389, 4014071749, 1692259599, 1103767406,
    3856189184, 775311834, 2366160550, 3539160261, 3724995895, 3678569943, 3110879235, 2324180658,
    369984574, 4037172221, 442903740, 1365054521, 3857931379, 2812167662, 654123320, 260581224,
    190358008, 442598758, 3390432274, 3868319215, 4225209788, 219376240, 3913485475, 1396869235,
    2503625076, 1846761921, 3665199528, 3746786786, 549160620, 3012124522, 1720801132, 776619834,
    2772396083, 1553287323, 3133033680, 560400589, 770147577, 2959780081, 3404836449, 875537507,
    806127768, 1036659419, 3427495372, 1935638836, 4289106188, 2513342933, 2640797586, 3159163320,
    1246135714, 4262858471, 2691574365, 2254199943, 3328356408, 2404660825, 1620985751, 4136544681,
    1406098833, 3721509074, 111863982, 1830980874, 1171214625, 777023461, 351118678, 2147787298,
    3743831983, 3369115676, 1001731485, 2927625020, 1349604263, 2010975425, 3105887410, 3422412258,
    1399942223, 362042682, 4149883491, 1449152930, 3579252275, 3749738101, 3297594869, 1507049517,
    2568910015, 156601174, 34674256, 892595192, 2722043111, 917185713, 2947804729, 345279465,
    1519762243, 3066395201, 1726263875, 1255703576, 1724426824, 3735301436, 2050042202, 580262109,
    452885936, 3412908273, 2859781728, 2240419681, 1099750857, 3706820658, 1184260280, 865603908,
    588859358, 3258127425, 2666286264, 3477629777, 4208348966, 202141071, 2423952447, 1517566988,
    2428513390, 1430059701, 1366268898, 624999194, 2731034999, 2167608954, 3401675083, 3596002346,
    878155881, 2239122165, 162042640, 1121980837, 3625139040, 2392368061, 3821594187, 2662795843,
    1015415814, 691955295, 459511611, 1681985403, 202271548, 3306658118, 1213075802, 2299802135,
    2065608602, 1544440991, 1979639251, 216324747, 2079774003, 2172221769, 2374029264, 440873412,
    3802438206, 643177657, 2829768908, 2988238216, 1180991709, 3743103167, 2875942752, 844484424,
    3178788396, 382924091, 3355985886, 2376216687, 1444253252, 1691999547, 1137127894, 4215982317,
    3758963229, 1193890218, 187277940, 3645065514, 1336269716, 70186536, 728109174, 1536478646,
    1458640559, 2834649727, 2395011729, 2828998824, 3811034525, 4225335533, 3586186533, 2037334715,
    4035936804, 917493407, 3318844147, 737277253, 350028548, 959003440, 1484706691, 2341812761,
    658922216, 368652964, 79164620, 3697159099, 3993455199, 277706177, 499198216, 1614890756,
    2996338091, 2049628768, 682920741, 1635716347, 3782313543, 958189263, 891498929, 2370004746,
    3804559373, 2980099956, 2343239974, 438566467, 171505826, 1620138274, 1277952602, 1902160978,
    830125244, 722106837, 1859235515, 3387262711, 4142084119, 3379632074, 4114474292, 3495487418,
    2425771741, 976002404, 1601468221, 1045042004, 2226705169, 4265800949, 1743189240, 3272422412,
    1798172007, 4066141118, 3327837180, 537221961, 121886623, 1582532171, 28668308, 3864677699,
    1627609832, 673085870, 3026864530, 2343620645, 1386119959, 854892392, 2335437345, 3833312425,
    1940059501, 802836169, 1036792648, 961526824, 2219462359, 4287632075, 4288465284, 863979505,
    1160856419, 270651153, 3317976717, 1281278485, 2369724472, 2964541342, 2295207931, 1290585,
    4157486040, 1355111127, 4256936413, 3779315450, 1686148431, 601568735, 4117327245, 1916109237,
    218404948, 1635853986, 1497204702, 3936927513, 3217199940, 2263824362, 3373901322, 308789050,
    3426243042, 1446678989, 1220012748, 2400963638, 1091655397, 1337382622, 3112847401, 4267279755,
    2672475605, 1128797729, 2557885435, 3677011367, 914740701, 1678929951, 3338343838, 1852551145,
    4223251046, 4224677731, 2301996097, 3259107612, 507300411, 2227393644, 4198550980, 641797757,
    2994995196, 740048324, 2636932354, 3600728522, 2000964805, 2530210814, 3329950169, 3180893122,
    2201518649, 239238871, 625520461, 1733126011, 2274402445, 3428043747, 1776066689, 857477720,
    3773831948, 654799745, 806388653, 3124322543, 3974465987, 1844077508, 3774605481, 1673411265,
];

const SIGNATURE: [u32; 1157] = [
    3067996612, 3431559922, 1168177386, 424193376, 2089129013, 2703842330, 592963684, 2927210516,
    319705278, 2184780178, 4142639107, 1624095937, 1151625644, 1633596719, 1729905358, 626395230,
    2221949591, 2454094112, 1985678083, 3639695469, 606506693, 3931844131, 1366558812, 3161586012,
    2754591306, 1688407579, 3614803870, 2410997725, 2627765758, 3593359290, 784485598, 610642609,
    2623333752, 1954353603, 1721819536, 3138743825, 3157399554, 4057487475, 2854253252, 1608881350,
    5536225, 4051792536, 4051834611, 3701096651, 1121374715, 296481140, 1664161999, 1136128513,
    3677998113, 969449886, 1412110372, 1391836055, 3108480997, 3240695785, 1317558556, 743468919,
    2348402098, 2332237351, 3911074307, 2937746012, 1012082629, 2611074934, 2228394803, 1257702044,
    16570491, 1792872359, 2594433191, 1788428829, 3530788583, 384230710, 3084154547, 867189080,
    1303503464, 2682984240, 31183963, 2699162080, 2753824328, 2103893118, 841888082, 3568244586,
    315696459, 1241156162, 1692450194, 2470092026, 380210281, 3456349757, 386058524, 3826625301,
    2710251918, 1922689, 1402642250, 1239482903, 598961131, 324822997, 641517657, 1239410867,
    1394170051, 1832097434, 1920667353, 1454780062, 610115840, 2655680958, 3785323454, 145019927,
    713503789, 4178249218, 1196314919, 3141859269, 12420575, 376811941, 410153951, 22808968,
    866694529, 2659009981, 2402107409, 3486459772, 1457906644, 2173129968, 3423718415, 3508455897,
    2983005298, 1090920951, 3295168004, 1676305331, 2358947517, 1434303109, 1008040372, 1276928879,
    124615040, 3082842798, 2033648874, 1346204909, 1114939721, 1998722577, 3700906802, 778542391,
    726722447, 3525935049, 1361218411, 1321861731, 781745015, 3847691241, 822121891, 4215009126,
    2496498252, 2801068775, 839208119, 1060570849, 3423451693, 2504035869, 1478019034, 3540226089,
    2642442261, 928585303, 1947942620, 2057867170, 2976042736, 3147731423, 2699219998, 1038567315,
    2699636499, 2097544291, 3273892032, 1624503504, 2223254913, 2110089196, 4071682365, 2338231971,
    1490402916, 3989541062, 2862503055, 3775567546, 1835456019, 4065116907, 1113478627, 3816647192,
    632462954, 1939501224, 1900727867, 1754134928, 374138250, 901512848, 1993840308, 2165789078,
    1261039075, 3561866408, 2905761220, 1631572236, 1804060363, 3707150295, 2246856429, 4004057935,
    2399283517, 4037947595, 174825115, 2507057254, 461465234, 2095710423, 1480307237, 3681199194,
    2969361954, 3559454188, 74420945, 1684931046, 1060668371, 3373063110, 3491534266, 277197923,
    3890687601, 3878682840, 2741408323, 826912089, 4133123133, 873241140, 1332624184, 2000313458,
    1154020245, 2895206610, 392331591, 2633896860, 1988487405, 3861473125, 159690598, 1885719461,
    82865514, 3535694466, 2056150389, 496952970, 3326658731, 1561932242, 1792947476, 537746641,
    975215921, 2805343944, 3326010130, 1865615787, 3093050008, 3223683427, 1163126610, 2212655777,
    2630776172, 3954845959, 1522607854, 2569492548, 1331779480, 109411125, 1827041512, 2707451580,
    2941220540, 2592544636, 2690473997, 1915949457, 1121563175, 933159648, 4207617032, 3019061241,
    2207357507, 1127696380, 2199649444, 143009274, 4219716711, 624445683, 4207049930, 4281652851,
    250140272, 817475292, 4132429998, 842455493, 1108745124, 4021593981, 1318428648, 926131124,
    111913661, 4136456638, 2824757322, 3721642422, 914838125, 3801508348, 1583439219, 4220234805,
    1208002162, 2171351772, 3052874088, 1651829037, 3889967174, 2987590388, 2318672221, 1135057488,
    213674601, 3797823847, 4226549574, 1479739425, 3052110453, 4066970667, 290670846, 2969554940,
    3130737721, 286215916, 4056783361, 1236826954, 963929590, 1711143536, 1424011746, 3332061861,
    2701956247, 3831009290, 1019213558, 3976879443, 3858072638, 3100483173, 719882007, 596452367,
    2829663435, 3880282764, 3006548538, 2835968189, 1910920556, 3190086299, 2859942280, 1388633537,
    2481254627, 2232346135, 2394455140, 240901134, 1255094665, 1071990546, 2701908242, 262301599,
    2300555715, 1739554362, 4279799884, 1672385947, 3805316310, 3322511075, 1785978429, 1930671131,
    1546757316, 125914771, 3341328969, 2528362317, 305566473, 425595855, 1436770891, 3924552103,
    711209615, 3418562029, 849007302, 1033864316, 3260719167, 2975233439, 2226327059, 2303347980,
    920081389, 3913395025, 2912084682, 3935348614, 899926210, 380955201, 1804124039, 1387546194,
    1031982562, 217564973, 3087703343, 3195438256, 1139369572, 3807585380, 3517826240, 438261806,
    3668155676, 12650015, 2019162416, 3412573245, 3888340458, 3351274980, 392840058, 3877571410,
    3248000799, 3487078543, 2027141306, 1043982200, 236575867, 425653656, 2850158083, 2202737032,
    2152505610, 1885878365, 1331885761, 147540636, 2990171359, 2603509300, 1384217498, 1959588400,
    1098045117, 3542601460, 3612590354, 1532368629, 2068153999, 674602089, 2739072271, 3533914671,
    4146185758, 3887860477, 3003702174, 3557217912, 2340664894, 2284715489, 3458562989, 1898979924,
    739310265, 1190277395, 232651522, 1178231190, 770702533, 2419043210, 3260334769, 2998404345,
    1322651153, 2245147985, 4204387205, 1064105704, 248308316, 2642847647, 136893040, 2390611282,
    1315646882, 728729236, 2390171619, 1574262746, 1885188139, 3099854403, 1017145233, 729163291,
    2812195835, 104497201, 2978479329, 3208845546, 3916853356, 967153227, 817953542, 1698420395,
    386106837, 3085556602, 760757514, 3396004196, 896139650, 1699998236, 2290643574, 4201795702,
    994311574, 4130872661, 3967099133, 3183499846, 1964158674, 3791788753, 1153776560, 225910586,
    2832222433, 4202144341, 3185579668, 2223177125, 1929429681, 1959408985, 1904404382, 2197891928,
    2603890946, 3397811802, 2557520199, 3925416947, 2222795583, 3333874386, 3388015919, 1739668530,
    1906217052, 876579334, 537416401, 2188000685, 3649964214, 221555187, 4124427917, 1372277924,
    2445643741, 2607397129, 1695048709, 756697832, 2454566486, 1453012951, 3288099676, 289290077,
    550587173, 2583220086, 3607897586, 3508557076, 706121026, 819583287, 4204132471, 2896842306,
    3851747094, 706971574, 2516697593, 2291099280, 1126928997, 1048037444, 2095598160, 1321784904,
    2212417593, 2690068009, 2903124655, 2671286986, 3085043295, 4151459840, 4232665813, 430844129,
    3121070284, 2043709611, 3864271361, 4274960721, 2273731955, 2705477844, 1563200459, 3898722477,
    2497027166, 2054083718, 3305697222, 541034582, 1072020722, 2323128088, 3765152170, 3916409297,
    1145549351, 1542140987, 1905434268, 2648633391, 4174573497, 437111596, 3822378308, 4201378984,
    4115254550, 974193437, 1125112600, 1169256832, 3082763221, 3303965054, 389608581, 670913804,
    3523066080, 1262847155, 301753473, 2014709060, 91816381, 762774181, 76598137, 3027900502,
    2732252929, 1164136440, 1876816370, 1264475289, 1284815326, 2866091505, 3041561955, 4267801860,
    3850937007, 3266915441, 1993519222, 2281315141, 2221134237, 2070287090, 2829626320, 617725675,
    3041980972, 92233004, 3601328316, 3669511686, 4021113915, 2890598780, 1453235350, 909663569,
    36143949, 2554328448, 583964874, 3538045963, 3308050428, 272667228, 1405421211, 2122924604,
    4225660644, 3121143928, 2234506368, 2130136185, 680784832, 2040800611, 2299923495, 842184317,
    2867434653, 3883210610, 4021681642, 2816820970, 437170274, 2358907952, 346929672, 3201731592,
    646740038, 1524026120, 4095913128, 3575545257, 2267285908, 3245283989, 3953312466, 68429780,
    686162652, 2201013367, 828435611, 410255969, 2666469276, 1200496558, 2432320613, 3292639570,
    657489049, 716893765, 3462326055, 2794494781, 566994879, 506119081, 3230536233, 1295433079,
    52106387, 2201929362, 2276446299, 1893532320, 3590432633, 3645466379, 1588285511, 3710649781,
    3670675865, 119681852, 3761442243, 3874368819, 2197341256, 2887328495, 2047061561, 8653146,
    2412111895, 1592000209, 3816072709, 50634152, 1900568149, 1352143966, 205610199, 234546383,
    2954920286, 43376113, 623947727, 1713550060, 3169010019, 2233730307, 839556542, 3955513495,
    209269925, 3636041915, 1367886522, 1389855112, 2646959639, 3151577236, 1893047917, 337966714,
    267689012, 1688058188, 3683218767, 2602773210, 2645541956, 2206544832, 1274251022, 3409196511,
    2472002472, 3519059668, 904092121, 232852186, 1995047704, 722718338, 1012201193, 2903992691,
    309838229, 3216962270, 3679173575, 2513077105, 2070310192, 3324842649, 1863164413, 4128331650,
    2879414959, 4061720139, 3702948793, 1165550761, 2621921308, 1462620585, 3286148422, 3016567332,
    1707833080, 1025266517, 2768185073, 1660157018, 1705575419, 1032546171, 2916187459, 941572443,
    3659179394, 1233481305, 346178936, 744449137, 1283045768, 3512827622, 2217234429, 1225938008,
    720531700, 1740413448, 3725546155, 4160178684, 679271564, 87588031, 1235559399, 4088212811,
    1771037806, 1648512569, 1444218773, 1364228314, 1794964391, 2430827956, 4031979082, 4200860082,
    920806535, 320488877, 1349111029, 1158647650, 518075300, 4114499750, 3342239718, 3424499891,
    4087914726, 2841503152, 3571053584, 1453324897, 1877760392, 3627174181, 1572370588, 2047840956,
    305477293, 3444240743, 2177133589, 396951720, 1713448809, 3757735602, 3146206216, 420640168,
    3917501872, 506637669, 1053178529, 1782998951, 3421492116, 1254727345, 2392747858, 2166047951,
    2648969777, 1231983166, 861008218, 4272878432, 3388403055, 2766467474, 130301603, 542730414,
    3587099300, 1904686980, 2461935242, 2282782562, 2727283385, 1807857295, 3050401473, 2938305166,
    3946929102, 2476952484, 1595231945, 1474247507, 4256628933, 3543081942, 4213747597, 3177839341,
    1728962517, 2801698627, 4074642892, 3560010203, 4095335248, 4110320883, 1032728126, 1184137092,
    788570115, 3745911672, 34844727, 890510735, 3117653476, 2908600117, 1710184516, 3701432602,
    2363698446, 3619253260, 623087712, 2045544776, 2634335858, 624757125, 2375715495, 435733530,
    3988192130, 2985990230, 3756014230, 1673798628, 171240362, 751161144, 2635361916, 2522431503,
    2220240560, 39104033, 1931478998, 1994558663, 63511893, 1773281712, 2092646231, 3618825355,
    3425343727, 2550778824, 3489097872, 587425635, 2765824239, 2911012800, 2092137819, 793612362,
    1479903732, 2205900599, 2893864225, 3944357853, 4190992819, 2704160644, 542607469, 946361941,
    3895466808, 1795944423, 699858022, 3069068237, 424827512, 1228199248, 2734924441, 948453589,
    1526152549, 1761487313, 1028616483, 3060933594, 3926243157, 2516232289, 4287781975, 3950263243,
    1638581681, 3662791353, 3712368400, 570980776, 3214142047, 3057800440, 78813080, 858775602,
    2661732, 3405431776, 3870957185, 414149821, 3228811925, 3477134826, 436280478, 2326059336,
    1824566634, 3900791550, 4098351814, 803484854, 929195970, 2430563259, 1735664854, 1004932099,
    592058652, 95463338, 3578205859, 698571119, 229475093, 787360474, 297477542, 4203943957,
    968099761, 3455977594, 101762105, 2051166550, 1633561751, 1388150956, 640354501, 84236895,
    2006253519, 1289588719, 2498211858, 1981202412, 1485640030, 3390759124, 536326803, 2627125347,
    231808475, 361612418, 186772581, 1585248020, 4107684637, 3154629470, 3740184469, 1248815180,
    2841570194, 334589841, 2662220907, 3080680531, 3162212408, 1917546998, 1501121744, 1465775031,
    1312013346, 2249987995, 3729267976, 3202555093, 2603470934, 1896015098, 660797649, 1101253167,
    2989825052, 1650164485, 2775724846, 2895687663, 3726292413, 2781483699, 703513544, 4153121636,
    3317774976, 3821855828, 2667273647, 844340980, 2422175482, 3488072540, 3501630128, 1810671840,
    3417468945, 3368867939, 3700196686, 3173847898, 3296080333, 3573610335, 868959995, 219037974,
    190811670, 1739552301, 1199446693, 342344044, 1760899417, 3323657080, 1995674861, 489856717,
    3356838194, 3258471133, 3208862900, 2560034403, 4141048411, 3348031478, 1242371189, 619101226,
    628027225, 1128133482, 2800207815, 1006091719, 1491970129, 1417892139, 1630625258, 4284352298,
    3517787861, 37857342, 3874319945, 4032354401, 1533534982, 2556001047, 521847103, 665403218,
    3701670770, 63387156, 2949920325, 3161727570, 3232481821, 708443854, 3780880567, 3656898995,
    3177478109, 367826090, 1687828233, 3754246913, 3146996679, 2975859547, 337815436, 1394151814,
    4255917708, 2938855562, 2989810723, 1940825833, 221267926, 1353251709, 2578668667, 4143192878,
    2348514952, 3717030080, 1076487636, 2283355107, 2416130548, 3507428358, 3726630039, 1257683182,
    646350351, 1416547638, 504204593, 2180684750, 297606615, 3098788049, 4099018458, 4014796097,
    1393863086, 3189482348, 4163365830, 3553129177, 582634262, 974060281, 3157592744, 2633607123,
    3038996527, 548249409, 735564380, 999136840, 3789206210, 3388427995, 246251164, 196596135,
    4255674721, 2463106533, 4254035271, 433486451, 1442039033, 1987822215, 3402663185, 407871540,
    1246982639, 2625581037, 130233824, 1407663434, 1097780572, 3030075725, 2236289651, 183978456,
    817806910, 3240917980, 3311733124, 3356725026, 1589606932, 1338882016, 2128438379, 1135586068,
    1315032151, 2770866819, 3605158323, 1052355645, 3949011640, 3973350895, 822079466, 1811526085,
    1342363551, 2845795352, 2146798421, 2826898554, 1143824422, 2178114683, 3588133542, 2211512723,
    2891721532, 1556994402, 4285967156, 813497217, 3486832789, 983623735, 352259712, 1913143440,
    897873033, 2291172279, 2370322616, 3930589681, 424277704, 2214833368, 859897252, 3028582008,
    3923375746, 2383292158, 1653097296, 984838572, 2204789197, 2780673579, 3821524683, 4242737268,
    4195890597, 1026796788, 649310629, 1553331429, 3998801666, 3762643337, 2431234646, 3421623375,
    2408297063, 2221473791, 2391938892, 1589422934, 1239331561, 3966753166, 90610657, 1799095746,
    3037200665, 3419586009, 464220361, 1638309765, 300123196, 1932959138, 1479461567, 2649720360,
    2787363843, 3357957891, 1672660029, 3510620498, 3099900323, 4078701317, 4199583462, 1235345778,
    256603297, 2798708210, 118117478, 2392440298, 590957396, 2105720829, 171935134, 2829710339,
    303522670, 1886557076, 134961257, 2882134760, 71212714, 3130235034, 3573152768, 0, 0, 0, 8,
    270016296, 808794880,
];

const MESSAGE: [u8; 64] = [
    29, 204, 154, 221, 65, 56, 204, 167, 12, 130, 160, 47, 200, 7, 250, 159, 194, 82, 16, 98, 102,
    89, 177, 73, 39, 15, 105, 116, 233, 169, 31, 160, 5, 186, 46, 229, 44, 126, 198, 98, 20, 39,
    194, 203, 249, 170, 183, 196, 80, 111, 6, 194, 23, 17, 183, 73, 119, 95, 8, 123, 190, 17, 14,
    186,
];

const MLDSA_MSG: [u32; 16] = [
    0x78fb03e7, 0x22ed1fc4, 0xf2a5e244, 0x9600e616, 0x0d298750, 0x179a0dd9, 0xb503d306, 0xbc2ac6d4,
    0x735f11ee, 0x23f6c548, 0x358498db, 0x04f50a80, 0xfb169e3c, 0x1c6cd56e, 0xd41baaf3, 0xd418f5c8,
];

const MLDSA_PRIVKEY: [u32; 1224] = [
    0x75a8f4c9, 0x56c0d7da, 0x6c7fe78f, 0xb03e722e, 0xd1fc4f2a, 0x5e244960, 0x0e616f61, 0x995a4a88,
    0x6cc78ec2, 0x951cb85c, 0xea8ad554, 0xf2bd8e5f, 0x41711246, 0x91225db8, 0x3acba371, 0x8a8d7a58,
    0xb3350f28, 0x761d9044, 0x8d83f17d, 0x0dd25db8, 0xe6c97cc0, 0x7f7bed1e, 0xb59dfcaf, 0x2d7fc3c2,
    0xbb2f81c8, 0xdf94af42, 0x27242980, 0xe27b71f5, 0x373e3e1f, 0x51b55491, 0x477f2839, 0x27792dca,
    0x54268ccc, 0x32469996, 0x50ca0084, 0x002651c9, 0x18110bb1, 0x91034986, 0x59220844, 0x2050dc00,
    0x5121b504, 0x9030650c, 0x4068d3a4, 0x1101060e, 0x62a83152, 0xc8051c08, 0x88d0282c, 0x49c80d13,
    0xa940ca24, 0x4682a220, 0x23a77098, 0x8620d224, 0x418a3872, 0x09a22962, 0x284199a0, 0x111b3209,
    0x9a86511a, 0x89400125, 0x9193a60d, 0xe3244d01, 0x306e9916, 0x6604c465, 0xa4c06801, 0xc0116292,
    0x4522a511, 0x5a180600, 0x218e5a06, 0x255ca611, 0x63a48de2, 0x362583c4, 0x4121154a, 0x9ca28901,
    0x23885812, 0x918ba024, 0x42184ecc, 0x447064b2, 0x25c28604, 0x2243095a, 0x0049e204, 0x4c99a250,
    0x50b44863, 0x148a81c6, 0x2d441401, 0xe2a48d1b, 0x258421b0, 0x11840605, 0x5396518c, 0x18600ca6,
    0x44142512, 0x5b460893, 0x2886cb36, 0x805c9001, 0xe2b22998, 0x480604c7, 0x45139524, 0x4b284ca2,
    0x148684b2, 0x31a2808d, 0x59b2010b, 0x02451091, 0x50c28609, 0x98324810, 0x97290ca4, 0x2592a665,
    0x09864dd3, 0x34248c36, 0x21db3406, 0x4b96408a, 0x146650c4, 0x0022094e, 0xdc964981, 0xa221d942,
    0x450ba865, 0x62088dd2, 0x24060b16, 0x8de31661, 0x9098300a, 0x0291cb26, 0x6a992881, 0x4ab688e2,
    0xc851e2a8, 0x85543442, 0x40a6705b, 0xb8082118, 0x8401842d, 0x14084da1, 0xa0204908, 0x09c82252,
    0x6296088c, 0x92482289, 0x4de24491, 0x12322a1c, 0x80609200, 0x89dc322a, 0xd1164198, 0x0680db24,
    0x05131609, 0xd4b88c89, 0x98112480, 0x65544830, 0x10244ed0, 0x12512303, 0x529a4666, 0x04445151,
    0xb0850b47, 0x26d8940d, 0x543802da, 0x08004b46, 0x32208785, 0x63b851dc, 0x30096432, 0x51549205,
    0x9242101c, 0x1228c940, 0x6e98868d, 0x1b978c61, 0x064a4040, 0x4e99120e, 0x59066181, 0xc68d42c2,
    0x04099411, 0x10868d58, 0xa4714ac6, 0x61810051, 0x13a791d8, 0x04261c11, 0x50e4900c, 0x93880991,
    0x36256130, 0x2c594660, 0x00460402, 0xa7441c87, 0x6000c60d, 0xd8268e90, 0x342801a5, 0x600ba851,
    0x890469e1, 0x00311938, 0x50a0904d, 0x80b43120, 0x8271c310, 0x621bc000, 0xd91030e3, 0x366861a0,
    0x00242846, 0x52340119, 0x328001a6, 0x80c2c631, 0xdb90294c, 0x88492048, 0x05639069, 0x10303211,
    0x062acaa8, 0x60829429, 0x1a3792a1, 0x04695b48, 0x5002496a, 0x0ac20dd4, 0x08520106, 0x0ea1b22d,
    0x02284251, 0x00308812, 0x86880248, 0x49a62063, 0x824d5ab8, 0x2404a070, 0x64282124, 0x218c5124,
    0x461a306d, 0x12432043, 0x288c8806, 0x8020c640, 0xc31606d8, 0xb4515024, 0x52d0100c, 0x02b74c1b,
    0x30509318, 0x91040406, 0xc9c08c92, 0x80651149, 0x2e123581, 0x44a88084, 0x2430c886, 0x41da0245,
    0x44b091c0, 0x90319902, 0x60123150, 0x53c288d3, 0xb60062b8, 0x705c9409, 0x1ba66001, 0x09050b41,
    0x90514442, 0x2440415c, 0x9005d100, 0x4a04b441, 0xdcb29190, 0x4032c9b2, 0x701bc690, 0xe2c24548,
    0xc44890c8, 0x2920296e, 0x21426c81, 0x800d2139, 0x4013b985, 0xd4b45199, 0x8491dc86, 0x0110230a,
    0x82802890, 0x9211cb40, 0x4111c009, 0x60486d61, 0x460c8c90, 0x01490048, 0xd9004811, 0x08619824,
    0x24500041, 0x03b83108, 0x86488302, 0x0524c160, 0x64c60d41, 0x02259120, 0x6d209791, 0xd2449141,
    0x4440cc38, 0x9048424a, 0x1c321102, 0x45265a82, 0x50840270, 0x88b66811, 0x10621b07, 0x22234946,
    0x81960c23, 0x383149c2, 0x89dab865, 0x4a9864d9, 0x08401206, 0x6a101301, 0x5a3042dc, 0xb081c484,
    0x40cb8624, 0x14490658, 0x886d1380, 0x1108a064, 0xd996800c, 0x165061a6, 0x4542308a, 0x11936c1a,
    0x14824426, 0x0d429841, 0xa2a60800, 0x87484332, 0x4a23066e, 0x1c3061c2, 0x28620207, 0x600b8780,
    0x53328e19, 0xc88ce084, 0x2111478a, 0x5244449b, 0x166c5880, 0x21c8048d, 0x20062409, 0xc8104b94,
    0x68a10030, 0x14920c09, 0x122e4182, 0x805ca24d, 0xd2340e44, 0x908c4844, 0x91214000, 0x01c96809,
    0x036cd328, 0x094b0806, 0xd806098c, 0x20801010, 0x48e12851, 0x438600d4, 0xb0018b14, 0x0c20b671,
    0x12b7110c, 0x4020d300, 0x0862088a, 0x62266503, 0x28425922, 0x11488230, 0x21c46c1c, 0x25821a21,
    0x0d03a82d, 0xdaa011a0, 0x22702003, 0x48419070, 0xd0160de0, 0x484d8418, 0x4a9a1844, 0x8cc24920,
    0x394c19a5, 0x4102c744, 0x1a2852db, 0x86712434, 0x04943010, 0x21026181, 0x940c23c8, 0x81819640,
    0x23151251, 0x3408a440, 0x8e8cb851, 0xa02282da, 0x424620c8, 0x69cc8801, 0x20a6881a, 0xc96d4b92,
    0x8853b84c, 0x90124a09, 0x094d5006, 0x8aa0c280, 0x62466940, 0x4880dc48, 0x66d43002, 0x0a366a20,
    0xc631cb28, 0x52223930, 0x88a2080b, 0x32104014, 0x29a42868, 0x23028dd4, 0x108e02c3, 0x2484262a,
    0x04b4450b, 0x494d8020, 0x45001162, 0x0c40840b, 0x39490434, 0x508a3806, 0x0a2645c8, 0x1644e094,
    0x30114201, 0x01b76864, 0x82104a38, 0x120ab845, 0xd4c260e0, 0x0262cc30, 0x898b3629, 0xa1c82821,
    0x09216434, 0x4261962d, 0xd1040081, 0x10455238, 0x4400232e, 0x14188e18, 0xb4098136, 0x4e604671,
    0xa46666e7, 0xc3edef33, 0xd3bb22d2, 0x66af551a, 0x9e8d856c, 0x8b9e6826, 0xa77b04bd, 0x5ee6373c,
    0xa783f6bb, 0xcc93274a, 0x40de303b, 0x27f24f07, 0x7ea155ff, 0x532cf96d, 0x668ff300, 0xed79a8cb,
    0x199de6d5, 0xe809ac4f, 0xd59187bc, 0x048e2c0d, 0x7958a09f, 0xf88c8207, 0x2ad300df, 0xeb310d7b,
    0x43577645, 0x99e8e72d, 0xbf6f48b9, 0x4f861728, 0x3e244ef8, 0x312db99a, 0x36891e84, 0x8fe631b2,
    0x7f095e4b, 0x4a140758, 0xa319cb19, 0x3ba87688, 0x31a849f5, 0x6c0d14fb, 0xde09cc90, 0x4ffd6efb,
    0x8681db22, 0x8af4a2c6, 0x1caf571a, 0x39ca3e53, 0xf9613aea, 0x0f7dbac8, 0x750352f0, 0xda0806d4,
    0x8602d4c8, 0x89f36371, 0x96a0a683, 0xd3a5603a, 0xb458bc36, 0x698989c4, 0x5bba3c5b, 0xb23d80cf,
    0xc58e2320, 0x492f49a9, 0xfe78ff59, 0xa1b2c81c, 0xc5d8f5e0, 0xef55ecd4, 0x5eef5f56, 0x337023af,
    0xa797eea5, 0x2164fbe7, 0x06c8d922, 0xbfa0e641, 0xed31b8e9, 0x7f6dcad6, 0xe37a6d41, 0xf14b5d98,
    0xf94f9c82, 0xbddc5e3c, 0xa0942e97, 0xef10ce4e, 0x530bbf9e, 0x3efe6b7a, 0x0bb89ae4, 0x4f1eedd0,
    0x72c1950f, 0x116327fd, 0x0007e53f, 0x6bf49d98, 0x5ef5598e, 0x43b4deeb, 0x51d91d0b, 0xf4827b41,
    0xe08dec27, 0x3e148a35, 0xe97ee54a, 0xeaa4cffc, 0xe575ae51, 0x79cc38d5, 0x6a494a33, 0x102fc319,
    0xbbc0c88b, 0x5746c9ff, 0xda533c7a, 0xfd95b7f4, 0x2c1e3276, 0x8dd7c63c, 0x9b1e7932, 0x9005ea3c,
    0x06c16576, 0x8ea6f13f, 0x39010409, 0xd1501fa0, 0x88af59a0, 0xbe340d54, 0x269f76bd, 0x79143770,
    0x495769f6, 0x8505bbe4, 0xdfebdd7f, 0xcb40032c, 0x668530e0, 0x12446f7b, 0x91669a07, 0x0b41c1c9,
    0xe80dc01e, 0x1b3e4a8b, 0x6a4c38ca, 0xbcacb226, 0xe0319dcb, 0x174525e7, 0x50e96e43, 0xe76991b0,
    0x43711549, 0x667942bc, 0xc13b9303, 0x22a86d18, 0x214c0822, 0xedda5108, 0x56916287, 0xec59a739,
    0xd2122ed1, 0xcd0d0454, 0xa7a12bcc, 0x1f6e261a, 0xa8277038, 0x4c96a78d, 0x2128ef6b, 0xda7236bc,
    0xf6d266ce, 0xc43b64c5, 0x5f7f66cd, 0x85e36246, 0xc8d52226, 0xcf123408, 0x7cf6336b, 0xfc0638d5,
    0x3ec9e742, 0x016e5945, 0x46c730eb, 0x4e384e5b, 0x65ec5747, 0x7be6a51d, 0x08b55391, 0x32bfb5fd,
    0xabcb5d75, 0xd844700d, 0x55736504, 0x0cf15b6a, 0x3e44f155, 0xe0399c91, 0xe9ebaa29, 0x8f83cc33,
    0x0e211d96, 0xa385a4d8, 0xc2b58b1c, 0x7d062aeb, 0x8fee64bc, 0xb71dfa2a, 0x95c63764, 0x60b8712d,
    0x198a1124, 0x9474fbcc, 0x842ebb83, 0x3302c2f8, 0x7c05aa86, 0x95a24d4f, 0xbb61222e, 0x9a652c0e,
    0x6f83124a, 0x9718a78e, 0x3ca5b7e9, 0x95a0fd5b, 0x5779a52d, 0xbcd62a42, 0xa74282b9, 0x50e2012e,
    0x34b442b6, 0xc3cdc698, 0x98bfc724, 0x51f2bad9, 0x203f1688, 0x70acf5e4, 0xdec7c73a, 0xaa424876,
    0x32797973, 0xc02576c0, 0x559069bc, 0xe9d1deb7, 0xde83ec3c, 0xa392ea23, 0x61a01b4c, 0x499819b8,
    0x7955b4d2, 0xcadce486, 0x12435abc, 0x565045c8, 0x07174ae4, 0xe0cd6f0f, 0x1b4a2b2a, 0x68e0de6c,
    0xc43d3a43, 0x0866b0a9, 0x661d25a4, 0xc61f3930, 0x9de0a73c, 0xac07ff3f, 0x8ef9ff37, 0x5adb5636,
    0x68e7b24a, 0x57975396, 0x8776398a, 0x03985540, 0x439d882e, 0x5da790fb, 0xc48c1602, 0xacbbb26a,
    0x19a8ff7e, 0x40142dd5, 0xc04f8a58, 0x030ad3ec, 0x73d93cc8, 0x36fb33eb, 0x367ab837, 0xdcb2853b,
    0xc8a920ab, 0x88da45d3, 0x4ec9fac7, 0x6e4c641d, 0xc9b024f6, 0x8c4c49d0, 0xf850fb19, 0x8ac08844,
    0x2a489626, 0x5e638cf4, 0xdf499729, 0xb8eab5a3, 0xd118066c, 0xa4041d79, 0x33708534, 0x8072fcdf,
    0xed2f52e4, 0xe68a8ea9, 0xf7b517ec, 0xd1fb9ff2, 0xf4cecc47, 0x9dd3f6b0, 0x27ad0667, 0xeca482be,
    0xc3b66366, 0x70001679, 0xc98e2de0, 0x0330fa4c, 0x52b88c7b, 0x3247d62b, 0x39afd734, 0x5a3f21c9,
    0xb67ad2c0, 0x401de77c, 0x97f61e57, 0x82871136, 0x1ab5dd13, 0x0ef4e39d, 0xf62d6fad, 0xc9332456,
    0x4be89dff, 0x54514589, 0xe5d86920, 0x9f475ca5, 0xaa709643, 0xe34163dc, 0xf2f2543d, 0x7fefd090,
    0xfe5b879c, 0x45bbacee, 0x50f4dc22, 0xe534d0e5, 0xace33a38, 0xe52799d6, 0x4a28d647, 0xd01a3b9b,
    0x2209d8d4, 0xb404d7e6, 0x685e77d3, 0xbd3ae5d9, 0xf8b92ce0, 0x75242638, 0xa443253c, 0xb8bd3b23,
    0xf5722f56, 0x9f413f4c, 0x4101fddc, 0x2ccb2869, 0x5ffbea86, 0xb0c6b640, 0x26870c90, 0x9c9f6e51,
    0x742204b1, 0xa97799c0, 0xdc6192db, 0x410bada1, 0x6ad8a837, 0x66d446c8, 0xb5e78849, 0x1095ade0,
    0x86a1d72b, 0x7a675af5, 0x680367a9, 0x662b25c1, 0x778a838d, 0x861ba0cc, 0xc332f9bc, 0x77b38855,
    0xecbc6850, 0x35820a93, 0x4c65568b, 0x27264253, 0xa0054ed9, 0xc89f6562, 0x8eb52e3d, 0x89ad8348,
    0x58191987, 0xfaf8ae0b, 0x26fe6ccc, 0x3189863b, 0x828c2e5d, 0x76896eac, 0x16431fc7, 0x427a3b8a,
    0xb22a172c, 0x4511582d, 0xea87a24a, 0xdb9746c8, 0xd562293c, 0x86f7bb0e, 0x9352d075, 0x0f6bf6d9,
    0x5705e550, 0x66d33798, 0x785e4045, 0xb52d3655, 0x51ca9699, 0x45760693, 0x1535215e, 0x601e00b3,
    0x354d5947, 0x204a4132, 0x89f914c9, 0x635dab78, 0x7f8709a2, 0xe2a18a91, 0xa9dfcbdb, 0x89e976bf,
    0xb5a8164c, 0xd74af910, 0xa653f1e6, 0x963afe79, 0x4bdd11cc, 0x6a43a8ed, 0x9d944c92, 0x4b05d17a,
    0x4a578bc8, 0xcec95c9f, 0x4d022263, 0x0d781cea, 0x802fd7e0, 0x374640de, 0x287d182b, 0x49312e6f,
    0xa1e59948, 0xaf753c5e, 0x71ac862c, 0x42761c2b, 0x29b99d26, 0xe6f90176, 0xdfdb689a, 0x46628a37,
    0x83c47d0e, 0x55ec089f, 0x5ec8e950, 0x6d10f218, 0xfe48f8b4, 0x19dbce81, 0x6f18b66b, 0x60a25769,
    0xf74e3bb1, 0xccfe197d, 0x44d9f593, 0xbb2a2469, 0x64a0c3f9, 0xa8432cc9, 0xa4f1e121, 0x27e28ada,
    0x6201a41c, 0x50faa872, 0x25f9682e, 0xcaadfca1, 0xa8000eed, 0xeef33b96, 0x11d2ed7d, 0x2ea2e1a2,
    0xdcd34a44, 0x69328123, 0x9de958ac, 0x55fa4d7b, 0x5cd84f6f, 0xc59fc0b8, 0xb136285a, 0x324b67d1,
    0xf494f017, 0x839a026c, 0x44a7cc39, 0x93a979a6, 0xf9c8067c, 0x8e884c34, 0xec6992ea, 0x0071e5d0,
    0x7c107569, 0x5700a9c9, 0xab84c9a5, 0x3f55d14d, 0x90d6abca, 0xa03fecbf, 0xfa0ce0df, 0xfc2e1d34,
    0x69985ebc, 0x98f75a76, 0xff610a0b, 0x90f82dc4, 0x5058665a, 0xaaabd2f9, 0xaa753522, 0xc26659f5,
    0x7ffe8d56, 0x8167e7c5, 0x107b4d04, 0xd823eb8e, 0xdeee7d05, 0x7c381541, 0x950e13ea, 0xf62b54de,
    0x03fddad6, 0x044d6b47, 0x8913e674, 0x735a21b9, 0x47ffb28c, 0xc840d359, 0x73b7a599, 0x9789ba06,
    0x512f2c9e, 0xf1a1e093, 0x752f4a94, 0x4ab19397, 0xcc2f8e0e, 0xe77e49c9, 0x05c42091, 0xc07edab5,
    0x44be8449, 0x05c2338e, 0x1400f51a, 0x18fe4256, 0x911ba3cc, 0x35cfe147, 0x029f0396, 0xa5d81fbe,
    0x38fc18e9, 0xabfcc512, 0xb173e2d1, 0xa81df25f, 0xe81f20ad, 0x07f782f6, 0x08c906fe, 0x3294b0fb,
    0x0ec6d022, 0xe02b3153, 0xdc81161f, 0xfcec3f5b, 0xf11719dc, 0xfb42492f, 0xccfa33fd, 0xd66e0727,
    0x240c4772, 0x3bd3e904, 0x83d0da00, 0x2b7e672e, 0x9cd6d0e0, 0xb9140c5b, 0x5dfb6691, 0x33ed958d,
    0x67d8776d, 0x6627246d, 0x4691025d, 0x309e5fa0, 0x8554dbc4, 0x87776898, 0x3c024510, 0x280151af,
    0xd429f437, 0xec329c82, 0x6644bdd5, 0xa2c7e121, 0x5c682e07, 0xabdb7f23, 0x23f83c9e, 0x6562a9f9,
    0xed195f97, 0x9bd22a40, 0x625d69ad, 0x544dba34, 0x52157683, 0x2cb72049, 0x58cc800b, 0xab4207e6,
    0xaec8b356, 0x8f1eb5f2, 0x549d7c07, 0x9249963c, 0x86f847ee, 0x2688c24b, 0xe4e95ed9, 0xf2b5b49f,
    0xa5a415a9, 0x02abf372, 0x79a16b95, 0x2ba393e5, 0xfa14dc15, 0xba1d056b, 0xda84824c, 0x7dad55a5,
    0xf0f810f3, 0x4d046a02, 0x4a842128, 0x31b37f91, 0x2c326fff, 0xad7dec9b, 0xe81b44c0, 0x989e88c3,
    0x7c2effec, 0x74bba627, 0xfeb61b12, 0xd7d0dd8b, 0x372af5e5, 0x235e9fb0, 0x3fe1d340, 0xcbce8f89,
    0x0ca41cad, 0xab4e39f3, 0x00c05929, 0x3e714cd1, 0xe1545ef6, 0x80d0f81e, 0xc330be8e, 0xec657372,
    0x28329e89, 0xfc877bc4, 0x618fb09e, 0x07fb8603, 0xcaee7b18, 0x010c362e, 0x197b969c, 0xa949b2fd,
    0x9df1eb0a, 0xe0d2e2e9, 0x0049c1c1, 0xab0187ae, 0x7900743f, 0x9f62ad7f, 0xf980fadb, 0x9b704719,
    0x13f730cd, 0x9939f921, 0xc6277996, 0x360904fd, 0x43b61341, 0x1bde79ec, 0x0106767b, 0xf36fc478,
    0xc63754b5, 0x2d9578e2, 0xd1132110, 0x5b921f4a, 0xc2c89f7f, 0x22cf9dd8, 0x645fc283, 0xe3e1e33f,
    0xd8bc1e15, 0x4c3fe314, 0xeeab254a, 0x32465178, 0x3537ba88, 0xffd0c6c2, 0x778b39a4, 0xb69d5a9a,
    0xb9a1504e, 0x8c229422, 0x17e7445b, 0x33901080, 0x1b6eb3f1, 0xb9a14ef5, 0xfac78bf2, 0xe5325041,
    0xf58c5750, 0xa8913c7a, 0x2d9abbcc, 0xfd713b81, 0x75c7e995, 0x4dc80e8a, 0x0157dc00, 0x2d602bbe,
    0xe1f2ceb2, 0x7202de0e, 0xb2da573b, 0x78ec3e18, 0x31847042, 0x98c8fdec, 0x6d720de5, 0x33400c23,
    0x48cedcbd, 0xaadc77b8, 0x1322e5f1, 0xf8c5f762, 0x6fafff90, 0x54c770bd, 0xe6b40cb6, 0x781e2b59,
    0xf88da77d, 0x51ae942c, 0x8a866d60, 0x602f842f, 0xb565963b, 0x9a6bed84, 0xee933923, 0x28930330,
    0x59ee1342, 0xbe69f6bc, 0x234cb711, 0x2fb06d62, 0xca58e66f, 0xe71ef4f2, 0x52d4a6b9, 0x6ab3a870,
    0x90d99460, 0x78fc8c7b, 0xa42529d5, 0xade2e058, 0x449e1a51, 0x1d69cc5f, 0x59d554b5, 0xa084cec9,
    0x7a707873, 0x91d8801c, 0x3fc2d1d8, 0x05bb34f6, 0xe7c0d6ad, 0x64656a77, 0x001f8c32, 0x5f35b671,
    0xd30026d3, 0x80e88452, 0xb0994e2c, 0xc6c65afd, 0x5fc3bd84, 0x77793cfd, 0x75251601, 0xa0d83a02,
    0x71a1eb93, 0x56bf0d15, 0x0938d6a7, 0x783625eb, 0x40d0981a, 0xe8471c34, 0x99360a37, 0xc6fd1571,
    0x3c904d53, 0x01dd799a, 0x4dde2ea0, 0xaf6f3062, 0xcd407ff4, 0xe6471428, 0x8df7269d, 0xf0d6e645,
    0xcc015abe, 0xc5b80321, 0x54c305fd, 0x698caf15, 0x4e4a9fee, 0x366f81b8, 0xe94b9764, 0x1a80380f,
    0x2bfbae1d, 0x9b3e441c, 0x8fbb5e9d, 0x17c36281, 0xb6e7357b, 0x1475fb07, 0xcfe27444, 0x89b4005d,
    0x36d68b05, 0x3ae414a3, 0xabafdabf, 0x6fbefba8, 0x698d202a, 0x3419eb54, 0x93dbdb1d, 0x3aa8e3d1,
    0x5b5f00c4, 0xd63dacb7, 0xc12eb59d, 0xca01b758, 0x75f39f4e, 0xc58d4d06, 0x38cc4bf8, 0x0b095023,
    0x7c059c4d, 0x94269ffa, 0x0a6bec85, 0x0fde9ce9, 0xa602f3a7, 0xaa920062, 0x88d26d7e, 0x46d5283f,
    0x2a1ecaa3, 0x9d96f234, 0x1a764985, 0xec2e77bb, 0x2ace8ecf, 0xea13056c, 0x4fb82cc7, 0xcaf73aeb,
    0xed283cb0, 0x9325deef, 0x5cd31c16, 0x718fad00, 0xc30582da, 0xc8da374c, 0xe8f3522e, 0xa2751b28,
    0x0b510445, 0x6e15b45f, 0x453fc276, 0x25bde9d4, 0x2ff360c6, 0x8c6c469c, 0x75ee9f2f, 0x33790891,
    0xb57444c2, 0x7c04030e, 0x8a9afab3, 0x4acb6765, 0x9c1680f4, 0x2b5542a9, 0x9e7f174c, 0xd0b0449c,
    0x18962466, 0x32a547f2, 0x2daa7675, 0xef737436, 0xdc13abad, 0xf2d318a9, 0x23be7233, 0xafc1c12b,
    0xe2b68d6b, 0x07f394ac, 0xf9f1c21e, 0x5ded418e, 0x01ec49e4, 0x1332e9cf, 0x181224b1, 0x7ca718c5,
    0x92271af1, 0x8e76c50c, 0xd2231777, 0xc196a3c0, 0x0a9457e5, 0x3799ad6e, 0xa5b2f07e, 0x91ceab58,
    0x750feb32, 0x5da820ce, 0xe2882685, 0x35d0a9da, 0x8762c754, 0xcf5e23e7, 0x239c5cdb, 0x8f9b7e95,
    0x4d43c8d2, 0x3986e19c, 0x3f19f7db, 0xb8208a3b, 0x7fae5e3a, 0x4b36bd49, 0x9e847243, 0x45246038,
    0x447baa41, 0xfcc6727d, 0xf8cb273a, 0x98e5aa23, 0xb47fc976, 0xdda9e361, 0xe58e332b, 0x96dac60b,
    0x54d8f6cf, 0x1db959d0, 0xc32685bc, 0xa75c66d7, 0x46ddd40c, 0xaadcc15b, 0xca8f1aa8, 0x654088bc,
    0xbbb8b2a0, 0x9333d0c8, 0x2d11f813, 0x3de13404, 0x6eab0404, 0x73f1a98f, 0xb11e5dba, 0x50f09fa7,
];

const MLDSA_PUBKEY: [u32; 648] = [
    0x75a8f4c9, 0x56c0d7da, 0x6c7fe78f, 0xb03e722e, 0xd1fc4f2a, 0x5e244960, 0x0e616f61, 0x995a4a88,
    0xbabd9257, 0x1c680253, 0x9c86367b, 0xac5d6c33, 0xee7ad2f4, 0x7331681d, 0xaa2ecd32, 0x72a07c98,
    0x88ef4fb3, 0xd7d7b553, 0x4d62d48d, 0xb4e7aab9, 0xa3dcb673, 0x2cf5959d, 0x5acd4b25, 0x8fd9aad0,
    0x57598db1, 0xa8503dd8, 0xf788f9b5, 0x51423a93, 0xdec204c8, 0xa67890b5, 0x33bdad35, 0x44e65dd2,
    0xda8876e6, 0x803e5d77, 0xc6fa1f1c, 0x232ac032, 0x8c69650c, 0x63e23fd7, 0x24496b95, 0x236b585f,
    0x76fd7c94, 0x9b0204dd, 0xf23e55c8, 0x83c88b34, 0xa55b2d3b, 0x377de412, 0x2f9cbe78, 0x143efc7a,
    0xb9d23b98, 0x67f5f939, 0xdf336a02, 0x5653b525, 0xd7f23586, 0xf82c3aad, 0x578883ed, 0xdab3868a,
    0x08115bd0, 0xc313ad31, 0xff44f4f6, 0xb855025e, 0x5ff68b72, 0xc9d353ce, 0x54194914, 0xb266ef4d,
    0x3f1f8740, 0x142a53d1, 0xc27bf5ef, 0x2d7e8840, 0x2c565079, 0x247080ae, 0x0d07d6d7, 0x568fb887,
    0xfe18bcfd, 0x8261ed2e, 0xf494c18a, 0x8e6b8a20, 0x9781a4cd, 0x2cd32cf6, 0x1ea4474e, 0x74aa20a2,
    0x2da5fd0b, 0x4955db1e, 0x2b9a6c3c, 0x38072c90, 0x42d2744a, 0x5810f3c3, 0xe9645b84, 0xdbfa7891,
    0xf5bc4e41, 0xfddd2df1, 0xbacd84ae, 0x80bee050, 0x2cacac54, 0x7fd6521a, 0xefcb4b95, 0xb58bcc19,
    0x4c6b5a4e, 0x5214018b, 0x6f2ba80f, 0x21122004, 0xed559a86, 0x776826f3, 0xd777c25a, 0x283eada7,
    0xbd2004b8, 0x8e19d7b1, 0x5fea24a1, 0x53c08f09, 0x36e896ea, 0x2ed175c0, 0x7a2cd400, 0x81d14708,
    0x7f8e7e8b, 0x56bd438f, 0x7dac54ba, 0x3a2d7255, 0x6bacab5c, 0x6a6c8d63, 0x2acf6e41, 0x1e1e9299,
    0xf2a2fd4c, 0x6519ac22, 0x62abe387, 0x4871039d, 0x177bffe6, 0xd167821f, 0x05e46393, 0xb1fcd5a2,
    0xce192183, 0xff741b18, 0x5280a379, 0x840c75b9, 0xec706c16, 0x17db9224, 0x958572be, 0xf0158b00,
    0x0f6c5bce, 0x5066c4e3, 0x11509efb, 0x92437c86, 0x5ef4f6c2, 0xe8493a26, 0xed8b2fd9, 0x9adfc161,
    0xa9059dff, 0x794ed52a, 0xf6c83b78, 0x94fb2c79, 0x265468c2, 0x30cddf36, 0xbfe6ebaf, 0x11463f0e,
    0xf4ccc789, 0xef23eecf, 0x3933638a, 0xc5ed3bfd, 0xc0122b79, 0x1efd23d7, 0xc239bf96, 0x9b886ec3,
    0x626cf86b, 0x9d012c28, 0x09ea6ba6, 0x3a4f8e77, 0xcbadb40f, 0x1a8b7c2b, 0x7ac21c00, 0xd3ac87d9,
    0x8e61ce66, 0x91a7f5b2, 0x351d80d8, 0xed30b5a9, 0x006153a4, 0x878e5175, 0x69f192f9, 0x4f84bb9a,
    0x4f35a45b, 0xb41ee126, 0xd93c19db, 0x43a981c5, 0x7377dc9b, 0xce867a76, 0xf2c49d0d, 0x9e8801a1,
    0x726c8eeb, 0x70f7ebdf, 0xac83e46a, 0x9cc27185, 0x02e590a9, 0xd70e82a9, 0xccf56d33, 0x526c8e25,
    0x75172c72, 0xe4259aa6, 0x39999175, 0x827b9380, 0x3c5b43e5, 0x0c8833a8, 0x0cc52a11, 0xb2c959b5,
    0x572dea35, 0x924e1233, 0x7bed0e92, 0xa4efda31, 0xe1e161b2, 0xb57b4828, 0xe9d95685, 0xe7db7ac7,
    0x95186a8b, 0x966f90ca, 0xf876f405, 0xf1ee9d64, 0x59fbb274, 0x0783870f, 0xe6a5c3fe, 0x8036ed64,
    0x7bf544b8, 0x8958c4f2, 0x63409f56, 0xa61588d7, 0xd8bbb407, 0x3e7fd7c3, 0xc9e25006, 0xc97bc180,
    0x43505441, 0x4cefef80, 0xd77dd7dc, 0x81099f4b, 0xf565d4e8, 0x91bd8636, 0x8669faec, 0xd31f1f1a,
    0x246c9698, 0x38432715, 0x309aa45e, 0x8ed86151, 0x7c13ac94, 0x602933a2, 0xcd3bfa06, 0x735e62c4,
    0xbeb652cb, 0x12257948, 0x8ba8530b, 0xb5878787, 0x495cad69, 0x6d7c5e1d, 0xe65a66e4, 0xfbeeafaa,
    0x259768ea, 0x2608ed25, 0xb5586ee1, 0xc06ceacd, 0x5510e416, 0x7f7aa4db, 0xac15c68a, 0x2a710660,
    0x96eb8f0f, 0xe6ae7345, 0xc2434a87, 0xd28bec35, 0xe506be01, 0xaf27edf6, 0x0752de9c, 0x9014b22d,
    0xe55778ac, 0x5010c780, 0xe79fcc35, 0x7aa29326, 0xec748bcc, 0x593e62e6, 0xdbc51ffb, 0x3f282033,
    0xe8935d8e, 0xf7efff37, 0xed6d1cdf, 0x5a204558, 0x773a1b8c, 0x7ecb8794, 0x9013bdff, 0xd6e8e05c,
    0x817e86df, 0xb7b62986, 0x19870fe7, 0x3e2b6099, 0x2209207d, 0x94b856fd, 0x56f4c39a, 0xd937def5,
    0x7aeea0c8, 0x32f54bf4, 0x08755f39, 0x88a39ef8, 0x71335bdc, 0x2169f675, 0xc95ea265, 0x8266e29e,
    0x39fe97c0, 0xc2093e8a, 0x2eaa9db7, 0x5a6a4fee, 0x8f6889be, 0x3a606c79, 0x956c24f3, 0xb560cce1,
    0xc3716145, 0x3868d9bb, 0xab0a87d8, 0x5375126b, 0x6dc3e0d1, 0xf67b32a0, 0x006a8d3c, 0x705df2c6,
    0xb03ba0fa, 0x2b9634c3, 0xb0869552, 0xa0dac3b2, 0x1ecc8ba1, 0x7b341c22, 0x10d0a23b, 0x5fd68bb1,
    0x335ac96c, 0x3ef3701e, 0x0a2acd38, 0x90a4aebc, 0x908bc063, 0xbbf2ef3d, 0x50cf0f8d, 0xa48f7dde,
    0xb86f9d77, 0x3e544c70, 0x44704107, 0x6e99c93d, 0xb9d39780, 0xdf774da3, 0x5a0163da, 0x3ea50f17,
    0xa69a2144, 0x10736015, 0xa4abf71f, 0x43083324, 0x951fad48, 0x5ebaf55d, 0xe945f8c6, 0xefc3e8be,
    0x26917e5a, 0x29605040, 0x5a97fecb, 0xfd2625fc, 0x676ad1a9, 0x145bb8a9, 0xc1f1b3a4, 0x6519f77d,
    0xa83c44d2, 0x861cad6a, 0x56ab01bf, 0x84f7709f, 0x0f5270ec, 0x550f6691, 0xc47e6b18, 0xf4b5b884,
    0x118fd4af, 0x03d30460, 0x119322ea, 0xef583a15, 0xf00a561a, 0xfc498539, 0x3ad53b68, 0x1d41d469,
    0x790a24bd, 0xc6056eb9, 0x2dce833a, 0xb33581e0, 0x8267cefb, 0xbc206761, 0x92a7608f, 0xb7e34228,
    0x01d93518, 0x43b47626, 0x3c0d1d54, 0x42613d6e, 0xb9924662, 0xb20bc213, 0xca335a52, 0xa5f3cbcb,
    0x8fca9d91, 0x64170c89, 0x28dd5d2e, 0xaf9290d8, 0x2ea8ff72, 0x99e772de, 0x20567c79, 0xd6ebae9b,
    0xf5834cad, 0x8d55acca, 0x5e9b22e9, 0xcd0942dd, 0x262f06d2, 0xb21c2488, 0x38d8b76c, 0xac91e98f,
    0xa4d5369f, 0xe26a609c, 0x2e6547c2, 0x9137d45e, 0x4f4b0872, 0x4df78651, 0x1fbd75eb, 0x72dc72db,
    0x2ff0b8d9, 0x0461eead, 0x262feb19, 0x08f0605c, 0xf60b5f48, 0x733e3ee3, 0x1b12eda1, 0xc220eecf,
    0xca7160ea, 0xe73da742, 0xaaa34081, 0x49ee2559, 0x85ed681d, 0x733ab497, 0x71bbd77e, 0x344976ac,
    0x45556a83, 0xcf5ea3a5, 0x57d6f2d8, 0x54af1396, 0xfe62bf2a, 0x582f3a25, 0x2b9cbb00, 0xaff5e7a5,
    0xdaa0b44d, 0x3355374c, 0x70bc6117, 0xdbcf67cd, 0xe2c02527, 0x5a49105b, 0xf0d464b5, 0x54761c8e,
    0x0340fccf, 0xb2993728, 0x381f0a01, 0x5dcc10d7, 0xa2697067, 0x1ff41c6c, 0x12cff6e7, 0x1e16a376,
    0x3964042a, 0xb8ee7a1d, 0x9dd7dc8c, 0x73229061, 0xda4cf614, 0xd2f53366, 0x28ff9dc9, 0x2a1a5fd3,
    0x3240ef00, 0x575d5008, 0xa2f1a632, 0xb7bb843a, 0xb18113b1, 0xf0975b6e, 0xca7abb6c, 0x18c2d17c,
    0x9542b8ff, 0x6e99c186, 0xfcdaf6f0, 0xab62dd37, 0x646277ad, 0x482d7f06, 0x6c3c7678, 0xd5a9acc3,
    0xc162c8ad, 0x3ea326eb, 0xcdd51824, 0x0a6040b7, 0x17dbe698, 0xf6e0e49f, 0x35741289, 0xa61f143b,
    0xd0c2f335, 0x84733ea0, 0x5c0f6032, 0x1ace1874, 0xf0c2ff27, 0x30f729b9, 0xb20fcf64, 0x994719b9,
    0x5c0126af, 0x36e379af, 0xb8940ea2, 0x8f69a436, 0x02a10091, 0x81547aa7, 0xf1c6b59b, 0xdfb5f010,
    0xfba702e1, 0x93d67af6, 0xa2d0277f, 0x474e5042, 0x80eb8c56, 0x5afe7696, 0xd8fed00c, 0xdd560536,
    0xea3959d2, 0xd7d1dbd7, 0x02cd325c, 0xcde51cdf, 0x0c1af06b, 0x62089ceb, 0x523ab942, 0xa50a36e6,
    0x7c786b83, 0xf93c29b5, 0x15cb56af, 0x23c5412c, 0x1b2ff1be, 0x9e01b53b, 0x6325c54f, 0x3e7fa5fb,
    0x3f2d167b, 0xfe6f7aae, 0x10cd4994, 0x86c74f26, 0xe76e8fc1, 0x8e7fe42b, 0x09757222, 0xdddbaa0d,
    0x97f88aa1, 0xf9fc0cf1, 0xc9f781b2, 0x8abd0a7e, 0xb9334646, 0x829fddfc, 0x9f505ecd, 0x9bc8edda,
    0xc160366b, 0xbc04aa2e, 0x62a7a209, 0x594a87f9, 0xe121dfe9, 0x61da3adc, 0x7764dd63, 0x844b4fce,
    0x43478d15, 0x1fcda95f, 0xf1770b3d, 0x87a6727f, 0xc274d7ed, 0x11a1f0e2, 0x86992e87, 0xdab4763c,
    0xdc33027f, 0xb60d42a3, 0x06501721, 0x4496e54c, 0x3d0ef595, 0x3254c024, 0x08d3ce80, 0x7cdd58ff,
    0xdce15af9, 0x4762c489, 0x0f47f621, 0x5fbc2838, 0x2f72c934, 0x6b4d74dd, 0x7c768a06, 0x7ff6aa96,
    0xe495dfa9, 0xd13470b6, 0xadc362bd, 0x8c442d77, 0x94143894, 0x4521f67e, 0x85673c5f, 0xf3735129,
    0x09b8371d, 0xcde344cc, 0x8a602c33, 0x27903300, 0x3c4b7bb5, 0x1354b2e6, 0x6c415e7c, 0xf3cd0130,
    0x04cc968b, 0xe01a21d9, 0x104f92e9, 0x307d9d95, 0x81c2c125, 0x581739cf, 0x740dde7d, 0x530e22a3,
    0xe0811755, 0x9843a0ed, 0xf0b6d576, 0xb4b528c8, 0xe21d00fe, 0x8814f357, 0xd63d0f4b, 0x091f4a9b,
    0x4b3de3de, 0x2f3ddba9, 0x528f7c6e, 0x95433aea, 0x0ddc9077, 0x472572bc, 0x7f015542, 0xcbccac3d,
    0xb5ea7269, 0xcd97e060, 0xe3bfa854, 0xdb263906, 0x946e6e5a, 0x973f355d, 0xd585da0d, 0x39603f52,
    0x91880424, 0x0f4c8a26, 0x40de27cf, 0x9cc53003, 0x201b6dc5, 0x8a2ed125, 0xa52f4644, 0x4938a93f,
    0xecdfdbe5, 0x04898fd1, 0x27e70f9f, 0x1ae29eef, 0x61e6ac0d, 0x3b7c6a84, 0x561bff14, 0x4eb78dfe,
    0x9783f717, 0xbe8381bf, 0x94582504, 0x24b61f09, 0x5c1001be, 0x264376f4, 0xba325cef, 0xf9bb4752,
    0xcd3d8806, 0x870b5cfb, 0xfd252637, 0x364818ec, 0x11bff699, 0xcc10f310, 0x2fdd62a5, 0xb527ed7a,
];

const MLDSA_SIGN: [u32; 1157] = [
    0x0bb1a8f8, 0x7379be41, 0xfcb54c78, 0x6637e5d7, 0x4075f783, 0xb620dd54, 0xa994399c, 0x45b3bd31,
    0x6cbd5da4, 0x28fd6bb0, 0x2ab01f79, 0x6a92a4f5, 0x281bc101, 0x9d56ecd0, 0x5591a5aa, 0xa3ead352,
    0x500b9d5e, 0xa1061491, 0x54010860, 0x2770573b, 0x30d76ea2, 0xdb6db91e, 0xf64490a7, 0xfbb05370,
    0x69d7743b, 0x4e72ffeb, 0x413aeb47, 0x23ae6f37, 0x4c71f2e5, 0x5172dc81, 0x0d2b31e2, 0x3fdf2ca9,
    0x0c28d1dd, 0xce9ac43f, 0x34990b4e, 0xe79a1318, 0x63418a4e, 0x4a9d19e7, 0xacb43109, 0xc7612783,
    0x2eb12986, 0xf19cf295, 0x8c5384a8, 0xc6f9b65a, 0x647c7053, 0x1746e806, 0xa6f7dcf4, 0xb60b37b7,
    0xe9d0e855, 0xb307d7f7, 0xa89b64f5, 0xed7d510b, 0x9f238c15, 0x52009e84, 0x2606a43f, 0xb6d1a791,
    0x4dc695d9, 0xe5fc285a, 0x48b81cd6, 0xf32a64c7, 0x513f3703, 0x88352ba1, 0xdd507b5a, 0x168700ed,
    0x7d15409a, 0x4f3d8f86, 0x192490cd, 0x9eeb595b, 0x24e8f508, 0x006c3346, 0x9db189bf, 0x15c2adf5,
    0x0885502f, 0x1ed9581b, 0x1db01cc7, 0xb1f29662, 0x6a861293, 0x69725a49, 0x2f7eda8e, 0x499392ce,
    0x9fee7ebf, 0xdf9038d4, 0xd516d003, 0x1cd9865d, 0x785aa8d4, 0xc92bc332, 0xb4c8ef29, 0x82700844,
    0x10f2c9b0, 0xf927724c, 0xdf31eaf8, 0x0d05adfc, 0xb33127b3, 0xfea84d08, 0x4dd8de0b, 0xdaffc052,
    0x59d655c2, 0xffa9cd3a, 0x9a73b96f, 0x89b4591b, 0x05072e0b, 0xfa8a0d9f, 0x30f24352, 0xcccaa351,
    0x0d357e05, 0x9b66c79a, 0x366a463d, 0xdd644cf5, 0x3fa3764e, 0xa342546f, 0xf0c481f3, 0x9f0ac354,
    0x517c861d, 0xc73e257b, 0x4dfb83e1, 0x0db73376, 0x148eee3b, 0x4047e11c, 0x9600132c, 0xc3a2bd01,
    0xfb9dcbc0, 0xa801a92c, 0x941dd109, 0x34e1668d, 0x4aecadd1, 0x2089732f, 0xa9734577, 0x7f8c9434,
    0x2cd2c7d7, 0x626baa6c, 0xc01a7090, 0x53b23ff3, 0x35737aa1, 0xd32075ab, 0xc89885f2, 0x3aa0358d,
    0xf26ad565, 0x40acf2a3, 0x303995a4, 0x1662079d, 0xb821f486, 0x92ebb2f7, 0x5d9cf961, 0x48c45af0,
    0x3f15444d, 0x52d5c772, 0x49b64e2e, 0xac2ddeb5, 0x3c89d6c1, 0xbb476570, 0x3ebec0d4, 0x01eaeffd,
    0x714a522f, 0x5e9867bc, 0xb2091e75, 0x704f350b, 0x18e80808, 0x4273fede, 0x93e0a225, 0x760e0987,
    0x9b21d31e, 0x7c7d8a24, 0x4b64fe12, 0xced5797e, 0x66f319cc, 0xcc5630d1, 0x8a39046d, 0x8c3ad44d,
    0xcde2140f, 0x8c26df83, 0xe124ece5, 0x07fc95ee, 0xdf316158, 0x80b603e2, 0xeb0e9098, 0x6624ad92,
    0x2569c413, 0xecf4f3ed, 0x29ebf258, 0x351d38da, 0x611fb621, 0x03e50d7f, 0x7f08a9da, 0x16ebee9c,
    0xb31df4be, 0x219a0f8c, 0xc0ebdb0a, 0x9d7c40ba, 0x35546d34, 0x8cf1a105, 0x47fc61f6, 0x7445507d,
    0x80be366c, 0x070ef3d9, 0x1cd8a069, 0x3368acfd, 0x710ffaac, 0x0061165b, 0x0449bf7d, 0xbd27bc56,
    0x85a70d26, 0x93520960, 0x73c03fc9, 0x993b2722, 0xea87f3d8, 0xcd79477f, 0xbab64a30, 0x8fca130c,
    0xb3599535, 0x71d60d3a, 0xba7b4d15, 0x10dfa40e, 0x3f0ad23b, 0x4edb3bca, 0x56af73d5, 0xea84b49d,
    0x1a368f9a, 0x20788ccb, 0xfe4af441, 0x13969fe0, 0x65028156, 0xc441c707, 0xb03f9215, 0x4924c4dd,
    0xedbf0488, 0x33b7713a, 0xa6af99f3, 0xeb2e4b94, 0x5b1dbea1, 0xbcadb991, 0x59fd0ad8, 0x6a8c04da,
    0xd15c7cf8, 0x9c8580d6, 0xcd275fe6, 0xe48227c8, 0x69ff9780, 0xbefe9baa, 0x1684bab2, 0x5c7d8f07,
    0x22fcb979, 0x2dafdca0, 0x59b06489, 0x385177cb, 0x19fe878a, 0xfeda9401, 0xdac61406, 0x9fc9d81a,
    0xc987c450, 0xcdbb4f75, 0xb40f19df, 0x08691dd8, 0xbb0fe4b7, 0x309fff1e, 0x1e6cac3b, 0x3bcc7a1a,
    0x1d0f1cd0, 0x46cfb605, 0x9f7dfd89, 0x6cd1f345, 0xbd2fb231, 0x9ec15883, 0x026a91ab, 0xc8d0c893,
    0xd89acbaf, 0x22138cca, 0xfec386e8, 0xe445f174, 0x1c7d4873, 0x822377fa, 0x363827e4, 0xe7ea3657,
    0x5cf8f732, 0x8c523d3f, 0xac426e71, 0x18fb136f, 0xc5e42710, 0x0e4732f5, 0x58432b65, 0xe9ad2d99,
    0x0a667dc6, 0xbad9d366, 0xc79cc759, 0x5420729c, 0x973b05ba, 0x3a438ced, 0xc2b6dacf, 0xed97babb,
    0x77091084, 0x75d823e2, 0x59e7adc5, 0x42cdf397, 0x91289e9f, 0x4b8fb8d5, 0x8dcc4f97, 0xba39c216,
    0x5628b9d2, 0x9d2f89ee, 0xa554c59f, 0x1f22b729, 0x65bde472, 0x99f707bf, 0xb5c2015d, 0x2364044e,
    0x17095155, 0x189bb1f5, 0x763213fd, 0x902a9a00, 0x24eefb59, 0x7d73db08, 0x0ea6c043, 0x8e01b03f,
    0x7a864464, 0x34a48d0c, 0x88499c30, 0x38a26de6, 0x4d0495ba, 0xaa6c6b1d, 0xec55a5b6, 0xe30e302e,
    0x4073a7bf, 0x7856e84e, 0x41a63697, 0xc783934b, 0xc86a6f07, 0x8fa493a9, 0x182eb018, 0x73d2462a,
    0x6f515b1f, 0x56878394, 0x157cf33b, 0xec122023, 0x142b4848, 0x9992d64b, 0x8a5cc35a, 0x679c7240,
    0x9a943a64, 0x7759f749, 0x28eee605, 0x1bceb3de, 0xae105086, 0x0c2be72b, 0xc67d41d8, 0xb34cd8f3,
    0x04da013c, 0x465f31c0, 0xdfa765b0, 0xa5807679, 0x2b965a30, 0x4fe7c385, 0x4cc0afef, 0x2d90cd27,
    0x7b29ea28, 0x11398a3e, 0xe89e3a83, 0xa91587d8, 0x21f5f56a, 0xb2afc366, 0xb3777711, 0x25fc58f9,
    0x63068db9, 0x0727e013, 0x1205c238, 0xff174b98, 0x5291b312, 0x2e0266de, 0xbc6d9bde, 0x6362afc2,
    0xf7265188, 0xcf256631, 0x62893dad, 0xcd6d9727, 0x376d9c1d, 0xc3b8ca03, 0x21bb2ead, 0x69895e24,
    0xc4de92c4, 0xd5fe1d4c, 0x674e85d9, 0x690615fb, 0x5992c969, 0x524ddbe3, 0x6087b4e3, 0x5986832c,
    0xf4d2d559, 0x764eb15c, 0xd1d4ae44, 0x1c7fd60f, 0x282ab324, 0x1312ef6f, 0xc302b96e, 0x81eaeed7,
    0xcb9a2b00, 0x03e52e21, 0xa4455e5b, 0x4cf79389, 0x08d14964, 0xfb07b809, 0x617283ca, 0x1ace5262,
    0xe60edfc3, 0xc9edb1c3, 0xdd59ee90, 0x72581e6c, 0xeb8cc35a, 0x3071278e, 0x55f604e1, 0x7e5c40be,
    0x42ceafd7, 0x633b41c3, 0x7260b1ce, 0x91831726, 0xa32ec1fa, 0x253bb207, 0xc1a1d38d, 0xbe11f108,
    0xb1275643, 0xf94e7fed, 0x77520ccc, 0xf99c6a61, 0x59fd1988, 0xdc7c5c9d, 0x74810fdc, 0x88fdbca3,
    0xe0d6de30, 0x94ace6f0, 0xaa292782, 0xa074aee0, 0x4b1deb2c, 0x25c80d09, 0x40cc477d, 0xcfb60dc5,
    0x45d2a534, 0xa0b59626, 0x797d4868, 0x25381b89, 0x993d3898, 0xa322e95e, 0x004aaae3, 0x68344039,
    0x4d87ac13, 0xa3bb4e70, 0x86e6c2b2, 0x66279d15, 0xf77ce13e, 0x7f39dcbd, 0x12c99d36, 0xce89aec5,
    0x2805fc25, 0x288c0527, 0x985653e3, 0xd571d786, 0x3842e0fa, 0xfcc97830, 0x3dcf3cc9, 0x1a557158,
    0x2e7b466d, 0x2136aad0, 0x7674ebda, 0x30ab96e0, 0xca2588aa, 0x39c11a3e, 0xb127bf76, 0x41abbf1d,
    0xa7c409ec, 0x28aa6b2b, 0x8bfd7d37, 0x4fc1d32d, 0x2ce4d2e0, 0xe926d60a, 0x35df4f47, 0x9edf67c1,
    0x731622d4, 0x98be6b6e, 0xdafad505, 0x2d27027f, 0x83d7202c, 0xc7323977, 0x3c0223f0, 0x473405f0,
    0x15ee36c0, 0xa4b48547, 0xbd1ab943, 0x0e1bfd93, 0x7bf0dd3f, 0x9d2efc8c, 0xcf5688ec, 0x83da1517,
    0x5974de25, 0x622516da, 0x6563575c, 0x6c111f72, 0x742a2234, 0xd93c95b3, 0x52ff51c8, 0xe07642b2,
    0x6d421c2a, 0x1a0e4d78, 0xded68064, 0x76c67fb0, 0x2b101f6f, 0x02914d27, 0x1a6004ad, 0x69d51c18,
    0xe19904b8, 0x61c9cd25, 0xb53529f9, 0x8af3b96d, 0xd462b8be, 0xd3396fb4, 0xf904d6cf, 0x8577666c,
    0xfda5d989, 0x7d8ccd3b, 0xb9ecd62f, 0xf252536e, 0x9789ee6f, 0x997c1ae9, 0xc3711292, 0xf9fbd012,
    0xb7eb8835, 0x43386a17, 0xbcd2e4d1, 0x07916bff, 0xbcf56723, 0x054a0552, 0xe581c559, 0xd2256909,
    0x344c0221, 0x31408c6f, 0xd8150716, 0x3958eebe, 0xc29e7032, 0x3dce8e48, 0x1101d3f9, 0xce47679c,
    0xcf237fe4, 0x38750263, 0xbeda4943, 0xa529b8e0, 0x1b0d4efa, 0xc6f13ffd, 0x8075cf97, 0xbfe8b280,
    0x2a03378c, 0x0a495d69, 0xd546aaf9, 0x622e2888, 0xf32a0efc, 0x85701fd7, 0xdfb9ca56, 0x8b393ef3,
    0x007e4227, 0x0e48c90a, 0xb02e53a2, 0x635fbd62, 0x8689edda, 0x2e6b3c79, 0x2d241671, 0xff4b7d35,
    0xee444e5f, 0x9f3da416, 0x683ad99e, 0x62d91201, 0xcda0f8b4, 0x8027471c, 0x043e4967, 0x6b394a9d,
    0xef11540b, 0xe4e9c05a, 0xfb6bb7b3, 0x1eea659b, 0xc2491689, 0x5a59ce82, 0xe447f929, 0xd1cf3bab,
    0xe2730879, 0xad365a40, 0xd43b9876, 0x710c1935, 0x89ebbd74, 0x31655c82, 0x10916acd, 0x8923a883,
    0x16838d72, 0xba66d758, 0x3759e6b3, 0x12551320, 0x0519e20c, 0xa2968697, 0xb8c46605, 0x82854a33,
    0xaeb58bb8, 0x298d598a, 0x8ece1c7e, 0xea03748a, 0x358b69b9, 0xd5321f95, 0x3ed7e23a, 0xe5bb88c2,
    0xf5d21fdb, 0x01ef0c1f, 0xf71e109b, 0xac8ed187, 0x369dc7cb, 0xae9ae8fc, 0x632b3494, 0x811b58fb,
    0x52df1eb0, 0xfacc044a, 0xbc8232bb, 0xb3bbfcd6, 0xeb411e7b, 0xaf1bb36f, 0x97b90c7d, 0xbf66cf97,
    0xe3b59b37, 0x372f3b43, 0xa401a18e, 0x3106cf2b, 0x8baef461, 0x8a12a7ae, 0x891826c4, 0xbc722237,
    0x7f7dd063, 0x0f14b847, 0x435fad42, 0x6edee06e, 0x6d76ae39, 0x4029dd22, 0x5fd0ba1c, 0x2af7ff05,
    0x35e1641d, 0x3c220ba7, 0xd7425339, 0x49fcc7c9, 0x5fa5abee, 0xc57bd15d, 0x226126c3, 0x8446155e,
    0x299688c7, 0x910764ce, 0x40d12dce, 0xe38356c5, 0x9076ec3d, 0xce77204c, 0x18ccb178, 0xe3933d20,
    0xf8e2dd30, 0xc7869f3f, 0x960accfe, 0x7a42e7e1, 0x2fb9100c, 0xe412a82b, 0xb59a57b4, 0xe26df7f2,
    0x33402fe1, 0x8d6620fe, 0x7be05865, 0xd4ecb4ec, 0x8ea1be41, 0x9b177582, 0xf12f1ff4, 0x225f0a40,
    0xb569c5ae, 0x885c9b7b, 0xa1434a8f, 0xdaad112d, 0xc54bc105, 0xb8ae8d79, 0x2051c725, 0x47cb812c,
    0x2edef990, 0x24e39580, 0xcc236f50, 0x05f1063f, 0x1b7c0f34, 0x66dc4157, 0x640dfda3, 0xf70252e7,
    0xce126d8d, 0x3a33962e, 0xa7c9c05f, 0x2093026e, 0x14c98065, 0xadcb9b02, 0xd126ae26, 0x78bbfa6b,
    0xa5fa43cf, 0xe7ceb702, 0xcad630e1, 0xedbd18ca, 0xf21c7528, 0xab26ecc1, 0x31f0f6e5, 0x96e6e379,
    0x43bbed1a, 0x8b3c525f, 0x65ba3e01, 0xde8871d1, 0x90305e50, 0x8310f690, 0x7f6e0358, 0x76a93d2d,
    0x6d354457, 0x991b1f82, 0x72307517, 0xb35fbeff, 0x931d3ea6, 0x55a9d744, 0xccb16fa1, 0x2e9ced38,
    0xbb40cf17, 0x1dd7387a, 0x0588a383, 0xcae01277, 0x5f08af7a, 0xa8b4030e, 0x694524f9, 0x37e54562,
    0x04fbec92, 0x096c5e0c, 0xbf0f4d27, 0xab500dda, 0x2340f387, 0xee6d7597, 0xac3f1d1f, 0xafd0fc42,
    0xaefd8e51, 0xcb3a311d, 0xba579dbf, 0x33d943d8, 0xa8f2222c, 0x172ba2d3, 0xbcb9e67a, 0x64701b6f,
    0x70d72567, 0x48dc9640, 0x6658d034, 0x0f15207b, 0x8529080a, 0x48544385, 0xe899337c, 0xde54eabe,
    0xcaa157eb, 0xf6be5cad, 0x49c0f045, 0xd12d073b, 0xd9dd26aa, 0x7c01ef8f, 0x4c22d2e5, 0xe799bff2,
    0x604be895, 0x75439e1c, 0x213d99f2, 0x5831905c, 0xa6e56362, 0x94d2f395, 0x4c45323b, 0x13ce212b,
    0xfa634563, 0x8d46feb3, 0x091d0bff, 0x4ea3f917, 0x21563c72, 0x8fb0a183, 0x82c82344, 0x5418dc9f,
    0xa35e5d52, 0x80c004b3, 0x543adcb5, 0xd63bb82f, 0xc7ceb358, 0x9c43bc42, 0xb632d3f5, 0xb80a1618,
    0x66fc0712, 0x679dad4c, 0xf08aaa85, 0x9bd5e0a0, 0x879813d0, 0xc10c7a04, 0xe794341f, 0x1f25fe75,
    0xed8a6c97, 0xdfc367cc, 0x1904f696, 0xd8a5d83d, 0x66348abe, 0xa72082e5, 0xe664779e, 0x3f8d55ea,
    0x3603e8c6, 0xe7cb22db, 0xc64c5ea7, 0xcc11a9f1, 0x10d5d4c8, 0xf2e30a99, 0xea24d8d0, 0xeb84c50a,
    0x430ff6e2, 0xf5686bcd, 0xa0665903, 0x087ed684, 0x5e08d703, 0xec593d1f, 0x000da750, 0xbc474ae7,
    0x03c3f008, 0x656a4375, 0xfef0d9e1, 0x838f4d6c, 0x0ae1d833, 0x84335b93, 0xdf1a1c93, 0x1c35019e,
    0x56140010, 0xca1b8191, 0xdf075ef8, 0x2af30769, 0xfb770894, 0x8bfab2a6, 0x5354ed72, 0x96422b34,
    0x0598c79f, 0x1546465b, 0xb328512c, 0x0b401eea, 0xa962efce, 0x1f3dc476, 0xad9583f3, 0xb0024144,
    0x72fd3897, 0x835f7656, 0xdb8d2a7b, 0x7580ea78, 0xecc70759, 0x625ed4d3, 0xb0871806, 0x5c95de08,
    0x64e25232, 0xac73b838, 0x54ae1f10, 0x776805e1, 0xe97478b4, 0x57c9de24, 0x438adf33, 0xa6fa4e27,
    0x57cb1f3e, 0xfa1ccc9e, 0x12b268b5, 0xd64719ac, 0xdf86563c, 0x46928258, 0x5c140f01, 0x98908e28,
    0x18864fcc, 0xad5e48b8, 0xaba4c74c, 0x703db8d4, 0x101b279f, 0xbaeded69, 0xff2fccb8, 0x7c065a64,
    0x4089ec79, 0xf99b7775, 0xc3807b1a, 0x5fcc9d4c, 0x9cb00037, 0x853f6b40, 0x48f3fb52, 0xe9626471,
    0x94d814a2, 0x4ef1fae6, 0x020cf13c, 0x0444fe9b, 0xdf072edb, 0xa129a3f4, 0x155fe4ff, 0x937ad0d2,
    0x2135d3ed, 0x792b511f, 0xe082cbc4, 0x9b572587, 0x8d5540ce, 0xf04ffb91, 0xd1f4620a, 0xd7d5f565,
    0xb78c7a05, 0x63c7794d, 0x32374e6c, 0x18ffec41, 0x0ffb19d8, 0xebc4bb6b, 0x95385b87, 0x943def49,
    0xfd56eb1b, 0xc17fced2, 0xed6d78ed, 0x1bdb5d02, 0xc6652f45, 0xa72c3822, 0xbec7960f, 0x3c21c776,
    0x7ebdc4fc, 0x1a7e20c9, 0x42ba2fea, 0xb3ce06ea, 0x32706b50, 0xd67e6273, 0xec191b71, 0x702eec87,
    0x681b0f6a, 0xa24a0c49, 0x4a6d1e6e, 0xbb9cd848, 0xf21504b0, 0xb1557af8, 0x70978016, 0xedbc9527,
    0x4dc8cd72, 0x5bd1c751, 0xee01b78d, 0x8b062a89, 0x4a3858f8, 0x4d7af4ee, 0xb4ae62dc, 0x0b5aa999,
    0x7e7cd697, 0x271edd3f, 0xdf53eb38, 0x444a77a9, 0x02c89514, 0x0a57c20d, 0xd3a59599, 0x3bf59eb9,
    0x527bf69c, 0x89145dc0, 0x1997e62d, 0x5679742e, 0xc3a04cdc, 0x45dc3736, 0xf9530784, 0x5c609710,
    0xd3c80cd7, 0xca0f5ad1, 0x8dfafe59, 0xd1b8ba85, 0xa20d0f01, 0x9812bb3b, 0x96c3c73d, 0x3483d766,
    0x1e471207, 0xc3f2984e, 0xacdc9b85, 0xcb80f82f, 0x423ad162, 0x22f860eb, 0x410329f7, 0x7707c508,
    0x1c702fa3, 0xebb2413f, 0xc3356cf0, 0x9fcb285a, 0x480f062f, 0x828f2427, 0xd669655f, 0x6572e82e,
    0x07af9b18, 0xa3555584, 0x156da69f, 0xd00cdbfe, 0x31d04a20, 0x0b17ac42, 0x11873eaf, 0x18101bc9,
    0xc56c49f6, 0x5c92300d, 0x096eb0d0, 0xa0c10a21, 0x0c2c4b23, 0x4c05f2c2, 0x10e534ef, 0x0e113f32,
    0xddb6a0e0, 0x94c69e37, 0x83a6bce8, 0x0291793e, 0xf2a9b05e, 0x1bbe4982, 0xada86f0d, 0x951cdd33,
    0xcb8e03d8, 0x4d25032c, 0xcb149854, 0x4a16153a, 0x485b8698, 0x626a4a89, 0xdc64980e, 0xa75f9e4a,
    0x888aab90, 0x197a1786, 0xf0904fc7, 0x21ce42a7, 0x8034c5df, 0x2b799d21, 0xabd30626, 0x01cf0238,
    0xc914eaa5, 0x6373b218, 0xde1e34b2, 0x604f79e3, 0x74cd244b, 0x8c3146cc, 0x2b959498, 0xf8a82252,
    0x445e24c3, 0xf624211a, 0xada23ab7, 0x574ee12d, 0x325d79bc, 0x222499f6, 0xc74201d6, 0xc810999e,
    0x40803e68, 0x6f3c2b3d, 0x3a214a55, 0x465e6c06, 0x2362e727, 0xad65817e, 0x31825b14, 0x8403a7dd,
    0x363eb3e8, 0xdd03857e, 0x7975023c, 0x3a4a4541, 0x96507d91, 0xc03a4ff6, 0xf2012f34, 0x34dd6c7a,
    0x6852faf3, 0xd5b60dd3, 0x7035f387, 0x8c0ed08e, 0x61755c84, 0x89c021d4, 0x9414cff4, 0x4cb89c71,
    0x4503b54b, 0xb20a8198, 0x808e0ed2, 0x5419abeb, 0x94fb0b0c, 0x3e52433a, 0x71bd3f30, 0xd5a448ee,
    0xb36906f9, 0xa3138c18, 0xe47216a5, 0x012cfd98, 0x035dc8f0, 0x477f3a52, 0x4a1fad26, 0xc1cca818,
    0xcba451e7, 0xc2931c26, 0x13927765, 0x131c5374, 0x32c2c35e, 0x4ab4f1f1, 0x3902ce43, 0x4510134d,
    0xdce95afd, 0xab9c2137, 0x27759d5a, 0x5cbb2fdf, 0xe6f6967b, 0x9c23f20e, 0xd1473bbc, 0xd209299d,
    0x0c997105, 0xb2d91f33, 0xe1fc4a81, 0x86379980, 0xe77c02cd, 0x4b8b0746, 0x786e67dc, 0xa98ebfed,
    0x71e4a2c4, 0xf0387d10, 0x4a7f7e72, 0x819716a8, 0x7b3f63b4, 0x43d302ec, 0x266a5096, 0xb40e93bd,
    0x7a637d0f, 0x5957cb3a, 0x8ba1703a, 0x4004cc24, 0x4c4536b8, 0x4cf99bae, 0x633c7df7, 0xae4ce465,
    0x105cba8b, 0xbe134f2d, 0x0bb942d7, 0x1ec7e2fb, 0x12d6c173, 0x64fefb95, 0xbd04db88, 0x512f8c81,
    0x1595d111, 0x186917ab, 0x53318b8a, 0xd471b34c, 0xbb954ec3, 0x421ac426, 0x5ff6fbcd, 0xd76faf3e,
    0xefe4d71a, 0xa8b86277, 0x36701b9b, 0x7637b025, 0xa0037d07, 0xceb4c230, 0x5c14a8cb, 0x9db03a6a,
    0x2e09d6c6, 0xe8211bae, 0x9bdc61a5, 0x224c43d6, 0xdfa65e1e, 0x812369e1, 0x9a3153fb, 0xe9030dee,
    0x050e142f, 0x345d96ab, 0xc0e8ea0c, 0x49666769, 0x748ebbc7, 0xf53a76a1, 0xc6e50a25, 0x7b96b3e1,
    0xeb0d38b7, 0xbcc4cdd6, 0xf805333a, 0xee02798c, 0x92011235, 0x3a920000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x0000000b, 0x151a2129, 0x2d313600,
];

const MLDSA_SEED: [u32; 8] = [
    0x0a004093, 0x27d15f67, 0x121d0737, 0xd5e4ce3f, 0x28fe43a2, 0xd4f06807, 0x858a7646, 0x9cf85c2d,
];

const KEY_ID: KeyId = KeyId::KeyId1;

fn test_gen_key_pair() {
    let mut trng = unsafe {
        Trng::new(
            CsrngReg::new(),
            EntropySrcReg::new(),
            SocIfcTrngReg::new(),
            &SocIfcReg::new(),
        )
        .unwrap()
    };
    let mut entropy_gen = || trng.generate4();

    // This needs to happen in the first test
    CfiCounter::reset(&mut entropy_gen);

    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    let mut hmac = unsafe { Hmac::new(HmacReg::new()) };
    let key_out_1 = KeyWriteArgs {
        id: KEY_ID,
        usage: KeyUsage::default().set_mldsa_key_gen_seed_en(),
    };

    hmac.hmac(
        &HmacKey::from(&Array4x12::default()),
        &HmacData::from(&[0]),
        &mut trng,
        HmacTag::Key(key_out_1),
        HmacMode::Hmac384,
    )
    .unwrap();

    let public_key = ml_dsa87
        .key_pair(&Mldsa87Seed::Key(KeyReadArgs::new(KEY_ID)), &mut trng, None)
        .unwrap();
    assert_eq!(public_key, Mldsa87PubKey::from(PUBKEY));
}

fn test_sign() {
    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    let mut trng = unsafe {
        Trng::new(
            CsrngReg::new(),
            EntropySrcReg::new(),
            SocIfcTrngReg::new(),
            &SocIfcReg::new(),
        )
        .unwrap()
    };

    let sign_rnd = Mldsa87SignRnd::default(); // Deterministic signing

    let signature = ml_dsa87
        .sign(
            &Mldsa87Seed::Key(KeyReadArgs::new(KEY_ID)),
            &Mldsa87PubKey::from(PUBKEY), // Reuse SEED
            &MESSAGE.into(),
            &sign_rnd,
            &mut trng,
        )
        .unwrap();

    assert_eq!(signature, Mldsa87Signature::from(SIGNATURE));
}

fn test_sign_caller_provided_private_key() {
    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    let mut trng = unsafe {
        Trng::new(
            CsrngReg::new(),
            EntropySrcReg::new(),
            SocIfcTrngReg::new(),
            &SocIfcReg::new(),
        )
        .unwrap()
    };

    let sign_rnd = Mldsa87SignRnd::default(); // Deterministic signing

    let signature = ml_dsa87
        .sign(
            &Mldsa87Seed::PrivKey(&Mldsa87PrivKey::from(MLDSA_PRIVKEY)),
            &Mldsa87PubKey::from(MLDSA_PUBKEY),
            &MLDSA_MSG.into(),
            &sign_rnd,
            &mut trng,
        )
        .unwrap();

    assert_eq!(signature, Mldsa87Signature::from(MLDSA_SIGN));
}

fn test_sign_caller_provided_private_key_var_msg() {
    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    let mut trng = unsafe {
        Trng::new(
            CsrngReg::new(),
            EntropySrcReg::new(),
            SocIfcTrngReg::new(),
            &SocIfcReg::new(),
        )
        .unwrap()
    };

    let sign_rnd = Mldsa87SignRnd::default(); // Deterministic signing

    let signature = ml_dsa87
        .sign_var(
            &Mldsa87Seed::PrivKey(&Mldsa87PrivKey::from(MLDSA_PRIVKEY)),
            &Mldsa87PubKey::from(MLDSA_PUBKEY),
            &MLDSA_MSG.into(),
            &sign_rnd,
            &mut trng,
        )
        .unwrap();

    assert_eq!(signature, Mldsa87Signature::from(MLDSA_SIGN));
}

fn test_keygen_caller_provided_seed() {
    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    let mut trng = unsafe {
        Trng::new(
            CsrngReg::new(),
            EntropySrcReg::new(),
            SocIfcTrngReg::new(),
            &SocIfcReg::new(),
        )
        .unwrap()
    };

    let sign_rnd = Mldsa87SignRnd::default(); // Deterministic signing

    let signature = ml_dsa87
        .sign(
            &Mldsa87Seed::Array4x8(&Array4x8::from(MLDSA_SEED)),
            &Mldsa87PubKey::from(MLDSA_PUBKEY),
            &MLDSA_MSG.into(),
            &sign_rnd,
            &mut trng,
        )
        .unwrap();

    assert_eq!(signature, Mldsa87Signature::from(MLDSA_SIGN));
}

fn test_verify() {
    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    assert_eq!(
        ml_dsa87
            .verify(
                &Mldsa87PubKey::from(PUBKEY),
                &MESSAGE.into(),
                &Mldsa87Signature::from(SIGNATURE)
            )
            .unwrap(),
        Mldsa87Result::Success
    );
}

fn test_verify_failure() {
    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    let msg = Mldsa87Msg::from([0xff; 64]);

    assert_eq!(
        ml_dsa87
            .verify(
                &Mldsa87PubKey::from(PUBKEY),
                &msg,
                &Mldsa87Signature::from(SIGNATURE)
            )
            .unwrap(),
        Mldsa87Result::SigVerifyFailed
    );
}

test_suite! {
    test_gen_key_pair,
    // test_sign,
    // test_sign_caller_provided_private_key,
    test_sign_caller_provided_private_key_var_msg,
    // test_keygen_caller_provided_seed,
    // test_verify,
    // test_verify_failure,
}
