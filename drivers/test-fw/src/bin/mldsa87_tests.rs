/*++

Licensed under the Apache-2.0 license.

File Name:

    ml_dsa87_tests.rs

Abstract:

    File contains test cases for ML_DSA87 API tests

--*/

#![no_std]
#![no_main]

use caliptra_cfi_lib::CfiCounter;
use caliptra_drivers::{
    Array4x8, Array4x12, Hmac, HmacData, HmacKey, HmacMode, HmacTag, KeyId, KeyReadArgs, KeyUsage,
    KeyWriteArgs, Mldsa87, Mldsa87Msg, Mldsa87PrivKey, Mldsa87PubKey, Mldsa87Result, Mldsa87Seed,
    Mldsa87SignRnd, Mldsa87Signature, Trng,
};
use caliptra_registers::csrng::CsrngReg;
use caliptra_registers::entropy_src::EntropySrcReg;
use caliptra_registers::hmac::HmacReg;
use caliptra_registers::mldsa::MldsaReg;
use caliptra_registers::soc_ifc::SocIfcReg;
use caliptra_registers::soc_ifc_trng::SocIfcTrngReg;
use caliptra_test_harness::test_suite;

const PUBKEY: [u32; 648] = [
    3835505740, 3690007112, 853915369, 3693662018, 211942217, 3990077002, 2138588545, 3148197939,
    1360552520, 1893999810, 2142558518, 3550487038, 1629582640, 4207496438, 1624023420, 2321076701,
    3307728476, 2489502174, 981334409, 1164785223, 332671519, 153489343, 3397652780, 3957245118,
    2351323958, 2986875746, 2812917730, 3922720212, 1244743471, 605031300, 4056029767, 4181389605,
    1477281975, 2005702823, 1887259589, 2362260311, 3144662306, 3178107212, 2646344715, 3976901390,
    945382933, 1883457695, 2932015503, 3458972163, 3537662277, 4085675767, 1687087098, 1946150878,
    3219123200, 634562974, 1377987728, 3417383429, 2508513319, 2747979415, 4157402002, 1787205210,
    4174312139, 2316372670, 124309646, 3154808130, 125070196, 1368510060, 3601317111, 2064452163,
    4079260541, 901630114, 3251517436, 869381668, 4177790917, 1607707881, 231960692, 673287986,
    2277284076, 505705949, 3088167856, 1684583314, 1208388560, 3525850503, 2030451626, 327646581,
    877386528, 2360574569, 843228669, 3898825448, 3303275125, 3538169167, 2867752098, 1181193899,
    1021152497, 4205788195, 346620700, 376410217, 3680000168, 327497578, 553074626, 2366078710,
    4155947128, 200091752, 949927105, 1498873058, 3230849477, 1507259046, 708031178, 2295433290,
    1249428000, 3381327710, 3875440368, 3648849260, 52591107, 949831489, 3652235435, 3987982322,
    1861972534, 1377671987, 3905205197, 1514206689, 14480875, 836243961, 2337991485, 2869081407,
    3380346755, 2877464420, 429496806, 411369132, 278994683, 3437145682, 2250043483, 4019811594,
    910627272, 309030717, 1424414312, 2869433891, 92229327, 1835649107, 3592527850, 1497599740,
    3572206638, 2555816180, 4269356224, 3667981423, 2734805828, 87954250, 3622675868, 3907571364,
    4013581018, 3186315659, 3535233543, 1038874152, 3043337822, 2993178926, 571187271, 3668353355,
    3022759514, 2338223191, 2821892937, 197592418, 2400579529, 1743992916, 361676534, 676289517,
    3649769049, 1658659424, 4196073367, 2929650806, 3590540143, 205950218, 1543556740, 710122142,
    2754933547, 2673169005, 355066970, 1249642637, 793188832, 3850641309, 2489675968, 694013155,
    868793614, 3747869115, 255274388, 2434080473, 2338399868, 4154725563, 75073083, 3445901847,
    3109344337, 1659086204, 3429188076, 205045175, 789340315, 2091221152, 2489780142, 2304628220,
    3021279696, 297879459, 2647148146, 1307315161, 3220826142, 611084572, 2801469214, 3455242732,
    527730487, 1354208284, 493764011, 4023355622, 196256640, 364425337, 1023920522, 2187596207,
    3147216541, 2729626387, 1015174589, 382810384, 1673935089, 347353025, 1236701819, 2756197421,
    872795364, 1367532144, 3961880874, 4127501940, 1349428569, 676751886, 191409789, 3089396477,
    854439707, 247534677, 3101099142, 4141912815, 3488031487, 2712407939, 2613920377, 2588794055,
    4193782955, 2140616878, 107002602, 996081534, 4033583273, 3224283625, 3536695041, 2721134619,
    1709018856, 4056597405, 3106835985, 1502638122, 1162691296, 749533484, 1069503121, 2944311770,
    1294350480, 1544869020, 1900612708, 4245802745, 826515054, 1976246210, 3865278506, 468549788,
    2480036965, 847939832, 775621323, 4202318293, 2912271353, 4226199943, 1991619492, 2265713453,
    1738264887, 465885017, 453717684, 3433749626, 987564801, 1387264614, 2732275350, 1833084776,
    113558274, 1520169825, 1363505843, 2062085954, 2721127956, 347915132, 3902409908, 106170807,
    2206516323, 444970924, 1794422744, 3862221232, 1811212352, 1880621946, 1698564412, 1069207036,
    2399087675, 3710933778, 70035203, 2155912438, 2762234532, 2617070659, 1847666318, 503168021,
    2640210218, 567806325, 2098618861, 4114845061, 3023222550, 3947243527, 3717067821, 3349425571,
    1713300375, 3628243695, 1308237842, 2556437298, 4206700420, 1541425853, 332776413, 15192838,
    4256417894, 367564395, 2888310364, 1593022648, 3590422118, 2857949937, 267186593, 1887197702,
    491476472, 657400618, 370093181, 426516777, 4285496730, 4054097414, 2247656359, 1847321496,
    3484326429, 3244821993, 3812591400, 666689402, 1020756656, 2974443398, 3128679780, 2058817366,
    4289993554, 1649332787, 2551616546, 1864020586, 3063732205, 594644720, 2407950835, 3914712536,
    689023260, 3263828286, 298305756, 2693676558, 3814824665, 949629957, 2287916001, 1676597360,
    83058381, 1421263811, 1901009266, 3193142678, 2208914420, 1752735183, 2499739657, 4000154409,
    3153353492, 1414269807, 2010658634, 2245036648, 4170633359, 3693436965, 2915221252, 587768780,
    3922410943, 472822372, 3322011645, 727329216, 1111132167, 174210383, 2708829166, 470130578,
    4294003929, 1727801621, 3150192052, 2593048451, 691062747, 2062118730, 708132712, 3662429152,
    1771840790, 446736485, 6033911, 1762021026, 1989207095, 2407511518, 1868415448, 1354217781,
    2311724406, 2553085627, 276962272, 3173482352, 1043422172, 2748275980, 2499152999, 2542950764,
    3210672876, 2193847090, 3828183800, 571655365, 3285724765, 3558499129, 864021632, 1519996612,
    2149617990, 1827942798, 1517069905, 2076842343, 3166683701, 4135819432, 401084494, 2770638344,
    2289113214, 4220797801, 1385054947, 115289159, 2593592910, 3865965959, 1333885663, 2184975304,
    262324467, 3815054819, 975975661, 3114300172, 2477558831, 3147705342, 3846009555, 904140561,
    1583014044, 2794581513, 1952489756, 1874603361, 3598252764, 3836182028, 1528604965, 1352378289,
    4280497114, 4214644634, 4072424665, 2560478308, 3918038819, 2678001497, 1030496550, 3569162027,
    1531689162, 2775288505, 1989555613, 834664648, 3315723406, 3965794212, 2166894517, 467318305,
    2184641744, 4229786236, 654746860, 2390171719, 3647950863, 2510404217, 3856068584, 2991052485,
    3653680925, 4115196215, 2090393593, 3968235621, 938042798, 1889214348, 1352070829, 2319552824,
    1759957236, 2703319348, 4175050854, 3627343110, 2716196312, 2610124474, 2695944232, 1365173423,
    2111724401, 2548134146, 3708290397, 2317081907, 21672697, 3582447266, 1348987372, 3509519336,
    3115628136, 3293173393, 3396884916, 594701625, 2157023884, 1552974849, 1088012654, 1708871923,
    1428317425, 4207803940, 1284116655, 4137934796, 1061258750, 3498196015, 448728840, 1094337579,
    1151201108, 2510273848, 2667653093, 83462197, 3252698350, 558253128, 1035779300, 914714474,
    2474593659, 1906940452, 1401817629, 3671748450, 1819155233, 826004266, 3591211124, 2451243598,
    385248232, 2943103549, 1294686679, 147885499, 1044143741, 2656085092, 2117138255, 3826769787,
    2325011303, 1261031236, 90882208, 1294319489, 4234088270, 1539621717, 2350806595, 2091240943,
    825105881, 1675247520, 913780312, 2768394429, 1866358946, 1660292783, 3532954947, 1016386981,
    2562041260, 3308974427, 3285102325, 1815931317, 399229492, 3184398188, 209126227, 271932684,
    1846873165, 1194829654, 259008652, 3864862867, 3673293568, 3245532430, 832013312, 2980595141,
    1242800537, 2596151996, 2544832325, 1262209648, 2536652551, 2485947692, 4050026344, 2241214987,
    811402885, 3564165870, 1305255012, 1735112176, 3386522285, 2815521371, 814254733, 2233978583,
    2864645280, 2856647917, 3517162201, 235922125, 793604155, 3703765138, 2010123689, 1856069358,
    1234370716, 463596139, 2036947345, 1707394308, 84492501, 3716413660, 1016495067, 3049347978,
    1524690701, 4071452228, 4249981944, 3122583637, 3369522021, 1649772653, 3056763155, 280473868,
    1199408136, 1720782365, 2200722455, 960586046, 3034452656, 2247171250, 1575628304, 3365044929,
    3168772664, 1972177563, 574185332, 544749540, 765311001, 3550069312, 2924697659, 1821128552,
    2792612345, 3015522820, 4042045268, 1763110250, 2019480958, 3376348025, 1309091499, 3999310909,
    2697821919, 3882803189, 2065268521, 497892775, 4204300988, 576939228, 499665412, 1452576809,
    830700972, 780887356, 3710155016, 610308312, 2155998756, 1587835863, 1094683625, 1430119721,
    3683267155, 2232510094, 1878731451, 4206578077, 1923495852, 2699413811, 3884983424, 2434813941,
];

const SIGNATURE: [u32; 1157] = [
    3483939, 521999120, 100663296, 0, 0, 0, 0, 245, 4108507062, 2624280656, 1176240631, 4104937540,
    415006791, 647579123, 4075611052, 2672503563, 133414018, 3855399609, 2339915564, 437639831,
    1816409894, 2848095759, 2263379491, 1379541929, 755746403, 4285752040, 1018246763, 3620734437,
    4288214564, 1980957844, 3951065191, 1480753947, 3853702608, 4041491009, 1974314193, 3987996886,
    3238492056, 1330710077, 2682909822, 3928158732, 1715373663, 2865511117, 1416642615, 3234986865,
    697051757, 3465367280, 2239264509, 2813950375, 1135272953, 3189904621, 3563680954, 3475151066,
    781662814, 2699199005, 4206680392, 3396798190, 824315944, 2523025982, 1120452894, 2610958712,
    1010475033, 808606328, 2026610856, 915564689, 1260693274, 2171381782, 1957534969, 2940154918,
    3814134795, 4107578092, 1930723949, 1065269541, 1524133744, 1620966274, 3730712086, 797253300,
    267939432, 1504891849, 570010104, 1809715011, 1508585873, 1287096652, 138916478, 2253161470,
    1319207366, 3410356452, 539065145, 4007355991, 3784936298, 1191764199, 3191390947, 3867555644,
    2065189397, 115850537, 2084212604, 1313717956, 813057830, 3181244187, 3067739191, 1014575551,
    3095998111, 1204633610, 2697045139, 1256573837, 3823517592, 877480771, 4108292905, 1729589925,
    1626534454, 515437163, 2866360694, 901452089, 3576513422, 847697724, 187961676, 1833648983,
    3856118506, 2781594665, 2963179353, 2680298018, 3712303720, 965154659, 3802966738, 1376719586,
    3474770615, 3042344814, 2014140808, 3582270987, 3324777469, 1505615840, 3194448302, 2716196171,
    3682624971, 703452001, 3815614308, 659274968, 2792936621, 956779727, 1259544566, 3652190074,
    1807211919, 3781084950, 843882164, 3047947693, 3011039985, 737393128, 132255088, 2343177356,
    2003484981, 2566836641, 3217006151, 1258893055, 2958184894, 850379771, 327404585, 1702757314,
    984312424, 45514538, 1695196082, 1665294266, 3626131503, 756017751, 3566507107, 2550418942,
    2988446447, 701857286, 2121241915, 2334736800, 1055934807, 265748924, 2951664827, 2003390109,
    3120026087, 161831000, 3694485875, 2180009426, 3673071894, 3216319070, 715518671, 1815738122,
    4116294332, 1707070789, 1647929153, 1046229896, 4245038121, 3180608262, 3474955444, 1207497517,
    1195805480, 2136893302, 4002402466, 4069700056, 3667767286, 4164828796, 1328396374, 307914491,
    2989035025, 1544353146, 1978581962, 2026911356, 2575814726, 523211335, 1501401920, 1670087037,
    1952883631, 3955758678, 971743979, 1614148907, 4049669260, 2387954201, 1359307907, 1140244752,
    2985614434, 2642517195, 3779989706, 3856343637, 1366504965, 3528029229, 4238806389, 1170838776,
    1706572567, 1154208587, 4241159766, 3521571709, 3333299255, 3499204452, 2146829409, 2647490724,
    490487324, 2749023514, 1957422725, 2548515566, 554290071, 3930370263, 468342854, 4040365485,
    1916333753, 693241742, 923559992, 2726167656, 1899972603, 2121274744, 962228659, 2251670377,
    2107225654, 2634182873, 3834573685, 2108775245, 2393396192, 3677993775, 3160661167, 2373004366,
    983123886, 2453497015, 1490428571, 3366809924, 122302355, 92433838, 2261585157, 2268967007,
    2851796981, 3069704281, 3518011170, 2872230314, 1068021479, 4211788231, 3886478663, 3883789033,
    745181774, 4022863824, 1581393837, 4099881813, 2024855284, 3272133842, 693656589, 3222808734,
    2340753177, 3188268385, 2440255132, 3738386632, 3872215554, 3325915355, 1701464017, 2673685193,
    3260392999, 3404119660, 3728460287, 1268291414, 1840969587, 3410148302, 2761729965, 1361626387,
    3938040093, 3189663269, 382236280, 980432740, 2801760673, 2175390733, 2783782142, 3241938427,
    2537281548, 125585924, 178124797, 1695713711, 118334326, 3391395466, 771825760, 2879481533,
    609275472, 4175493584, 2867964072, 229844131, 1502062456, 1753291212, 2463332422, 442435538,
    456361654, 996848018, 201416207, 109688446, 2420524234, 1016901208, 3880822677, 1733215341,
    1771278875, 1548096047, 855799376, 900429570, 3432749675, 3845503946, 1246597775, 3176984146,
    2779487400, 3595843796, 1508824013, 3344689081, 3066754071, 908637894, 1204147638, 3612391946,
    63637619, 1753235821, 643748983, 1937022120, 641227713, 1723780373, 1862487596, 900714888,
    4139884928, 4167068665, 2048003618, 582377870, 4030764678, 411333635, 3976288287, 2345748187,
    120698673, 2379480016, 565025403, 1185331536, 3734248691, 1131009255, 3544829457, 2751784962,
    3044072588, 2330475124, 1617724475, 923323036, 266523945, 1663089233, 329941353, 2530805366,
    4289020771, 711189711, 2773176806, 2829476405, 225651107, 2950084307, 3770234823, 1408566122,
    4174796499, 708035424, 55896065, 1026549964, 86876176, 571525747, 2578022306, 701157729,
    2444686102, 3032970791, 3529043050, 273460631, 629506790, 3537313071, 2912495144, 315493749,
    641560720, 213862464, 3748375523, 2408678230, 892653440, 2857225440, 4057435303, 4234040337,
    1350420771, 276399205, 1938734783, 2728408015, 2000394999, 2213158519, 1654107971, 3412905394,
    700311782, 2727788342, 2049935350, 2107325747, 4032381835, 1661054657, 1408724297, 1917878087,
    3572024719, 2825274734, 4025593357, 4104923669, 4193864972, 2544846724, 230141891, 3820244983,
    3585664818, 1531740762, 4147218475, 3349803884, 3865771690, 981182634, 495177940, 1060287394,
    1419059043, 2615003869, 3995533902, 1919538835, 1842233019, 2835445344, 745163061, 1799702147,
    1312210688, 1149696010, 2214401988, 1201270969, 2459311004, 2197298614, 1736363830, 1284055503,
    2812215644, 3650267915, 1221954155, 2908722048, 1898434850, 1978958825, 2092858461, 3701975177,
    3294747282, 3604303028, 3057753754, 2894190667, 189553007, 2262069855, 3368576068, 1791667036,
    3699882005, 672484092, 3610189956, 3039367577, 2118342693, 4292278019, 113381786, 258757295,
    2054239563, 3472635999, 1884817045, 2662874841, 752590224, 1803068175, 2283875682, 1748329994,
    2845653526, 1659049857, 2357570251, 800237862, 2481052470, 367444637, 3851080696, 3950199239,
    3483080897, 869848594, 1783502467, 443812027, 1971171371, 3539471347, 1335903334, 3867720991,
    3698869563, 1153693927, 2363740600, 1748764390, 3160149203, 2504352385, 3366568280, 694586818,
    2808576899, 2285741991, 957515591, 1467768796, 3104486384, 790628302, 1413636976, 2304316431,
    3611614642, 760796948, 1806919628, 475280102, 3209433007, 3401510953, 2822495175, 4185414410,
    1927358681, 4113297514, 3454889141, 2667229652, 1425489180, 2264869031, 2106190620, 1556596787,
    2199639048, 3585881527, 280132343, 803294801, 4090650850, 2515886307, 3031464834, 1987988890,
    3892166141, 519696257, 3396463856, 1117662300, 1913001368, 3779723848, 2126649939, 2532613616,
    312953324, 3361076328, 758285740, 1580950601, 2845688031, 3188249764, 3484953175, 1527879544,
    2906441699, 2659563578, 1253842791, 3740576111, 2485940873, 4001170087, 20466154, 2520182511,
    2696302147, 1666279631, 104375688, 3797570589, 3996336624, 1942086677, 4162613243, 1592896301,
    3320939793, 1959770394, 796445298, 4267307774, 1342876866, 732103231, 4187637441, 2613443555,
    1265900123, 496964673, 2364765295, 3311290611, 4029546362, 328242252, 3187010175, 1871500749,
    4235934897, 2114298059, 2525331042, 3121075721, 3642752298, 155602140, 1188869964, 311488138,
    1730942852, 1742785612, 1382176323, 319655915, 2323099779, 280011797, 999132211, 1641954815,
    459016450, 1036618376, 429857691, 3042710263, 3235308786, 3292724864, 2717606190, 2465409799,
    3833219663, 2590838480, 1326783762, 1336136212, 1060511750, 3473746084, 1018822781, 3210110655,
    2555412396, 2317268973, 3420666960, 104528580, 3005799115, 270135403, 2466801209, 53743101,
    1391510453, 3898714781, 4141241224, 2746567452, 1323198572, 987021013, 1296208133, 91888146,
    3582844289, 779394152, 59324756, 3089488499, 1052953106, 1666079714, 3817015816, 2661404601,
    2581028977, 1797941631, 783208245, 123595769, 1045470041, 4286479622, 4268336920, 3740450224,
    1073025324, 2615201268, 3551363719, 3116931556, 3553502281, 732692928, 79015140, 372099450,
    3912635577, 3864844689, 201284591, 1940867971, 3925027766, 1385443689, 3276481064, 504342196,
    2570215156, 3439398111, 2437322665, 4023899304, 3923992818, 2631444297, 1211103654, 1748967079,
    79677837, 6472570, 546523084, 2834121213, 342323508, 519591137, 3215723301, 4144428236,
    744952996, 3168001149, 3253051455, 4181776365, 552513934, 1020539612, 2247501579, 4096486988,
    365580360, 3175398371, 793070746, 2866723158, 542692116, 2621489897, 567911732, 219132416,
    430188660, 1574488078, 1422017461, 2551307203, 2335659730, 2527283304, 3173979068, 2174834098,
    3154287353, 4037908379, 3091510384, 3323023781, 2674607470, 3627989105, 4222417810, 834853594,
    1579570754, 2739695446, 1011875020, 2771871084, 15669276, 2267550271, 924800866, 1751880966,
    1438441283, 2031403467, 2800291764, 1043086414, 1874593120, 3893078853, 395320579, 2342234894,
    1918886391, 44663255, 1928829354, 3168705108, 1070052314, 932756030, 3178904745, 2661625486,
    2006640442, 1962615663, 3201112321, 2868925614, 2851498044, 2619449693, 2026589124, 1425043953,
    2301054257, 3763598920, 4100781958, 371740223, 2669123952, 863992094, 1739347394, 2977155718,
    2916679714, 250583732, 3218227922, 2540642823, 1674413283, 1179936624, 82357985, 1698019874,
    1662602624, 2921300640, 654389102, 4222399399, 257443340, 2855901585, 2615137047, 644788972,
    3138249204, 2138456463, 1769804186, 1346100230, 819726703, 4101756397, 3110950805, 131492342,
    987103970, 2985643437, 562839684, 2801264321, 2446395840, 1327994822, 2090667167, 2848856300,
    2291022998, 3914984892, 1222297168, 2093967305, 4223720066, 3567533073, 119952158, 3303137004,
    974234688, 580198689, 2252515257, 873990923, 297309932, 3892861670, 2481538783, 3307366365,
    3815119109, 404611701, 1478637237, 2259081438, 1179002670, 2484737104, 2642760080, 3908197898,
    1316679886, 3038398049, 2133877605, 392838971, 161778653, 3281309872, 4081079557, 3917857812,
    2989237592, 2402892048, 804108256, 2953269448, 1803308404, 1612927287, 1814201568, 482853606,
    2136544017, 3945067248, 962851746, 1670296455, 1571422899, 3118167642, 3272126861, 2396917635,
    1241376871, 492570214, 385323601, 2338479390, 2454828169, 4212096206, 3774292546, 2019209515,
    3221683391, 3911375765, 1041588220, 3627622624, 2449385147, 971902250, 637192748, 2063578726,
    3310932702, 745251349, 2022411029, 787080449, 46509173, 4063989301, 1894155381, 1579804366,
    1173240570, 2019350564, 3574676004, 3407918332, 533931826, 2265357816, 2075152638, 1697450436,
    1386665990, 503108984, 3686728296, 110154851, 1471911411, 3279282640, 3902295786, 638755044,
    870828992, 3997259781, 3236001065, 285503507, 3467613581, 4169315526, 3926758147, 3771833215,
    260854571, 4010701574, 2002284284, 3668948517, 212067558, 3043278569, 368491438, 3713406768,
    2246095050, 2026456225, 2838110818, 3788689614, 1620794981, 2819640617, 2641876507, 1252451229,
    2827662670, 1013940260, 1479072234, 1136633339, 4003637638, 2566413422, 982092614, 2080700612,
    2761767774, 750431029, 1732121548, 1162803477, 1414934932, 1385449608, 3389452599, 155994728,
    2941444120, 1371692319, 647339962, 3693251687, 1090034923, 965445045, 3713870878, 194232423,
    2356367899, 3382373329, 3739499331, 2224653945, 2832313203, 331210661, 2316858776, 407027904,
    2928960295, 258931087, 16694930, 3867038963, 3562570621, 690341941, 3952280579, 1280450006,
    574230857, 2634872307, 3688931437, 1679202816, 1041911733, 3998921061, 2682322625, 3291640815,
    3832354924, 2569294652, 2428891200, 2002190808, 3210197411, 109983240, 1509378744, 1909503852,
    3568929343, 430491982, 1359989452, 2563577680, 1283661532, 2317069527, 513834834, 2226612444,
    2633662920, 4239984271, 4206522427, 1311099223, 1377727423, 1551950428, 2714375733, 215865308,
    2582328150, 3342179909, 283537159, 3688763582, 1280451557, 2175708934, 3961410411, 4034335397,
    1111967636, 676544001, 3722407994, 1973259880, 3524111387, 2415779692, 1696710394, 633868414,
    3648171816, 2738850418, 2797429079, 1738914050, 1145938623, 483868765, 4220680623, 2458694892,
    338412749, 2803004468, 650329775, 2796438993, 2630422865, 1579852491, 627435154, 32019063,
    478922440, 706074587, 4250312290, 1180019718, 3229652978, 2348174337, 538519390, 4282947256,
    3644967745, 3599406024, 963376665, 28592788, 1326246399, 2924938164, 3526714680, 793712288,
    538368658, 503282861, 1517456850, 2362143653, 3839009043, 2766271180, 1157301247, 3263179676,
    1152411750, 3800295229, 2724560134, 3733853300, 1303167626, 2800180110, 3775908789, 4177248034,
    176866424, 817621391, 1652924103, 3940527432, 430414596, 3231901644, 2915740774, 252473166,
    2754119916, 2631826221, 1843934856, 587616052, 3323059488, 796429595, 306273045, 2710728275,
    488063220, 3475331455, 1246123424, 1296809196, 3997316062, 232434427, 3910175269, 736118015,
    2441150499, 2146973686, 2588544253, 2804903125, 305906418, 69865260, 154590866, 1593370389,
    3131700559, 1525127884, 3674049981, 175978676, 1920957070, 612285564, 1254440733, 184870849,
    769674129, 340138643, 3029240445, 2080193459, 936820557, 3910951228, 1835832931, 3508716227,
    180716371, 3477745385, 1620672917, 1323116139, 3590879332, 530259464, 3668820094, 3427616953,
    2745929424, 2557179765, 3807862668, 265123189, 3556935325, 3327614087, 3715049245, 293528550,
    1404942760, 1251895207, 523633966, 3975427038, 325994384, 168668510, 2925241224, 2878278597,
    1852576518, 1319168586, 3410879472, 4176103748, 2723141573, 1740816802, 2296546207, 831445790,
    2622172801, 2840969084, 358196726, 2995873183, 2983345700, 1117408773, 3165180915, 707023524,
    211100107, 3461747945, 2608006032, 1628301893, 2274284492, 2314321986, 1662004698, 1885857252,
    1208036899, 1492401750, 4177445910, 2522365168, 2594471163, 316688821, 941287310, 3642612050,
    695360364, 2537263092, 783523991, 1739629107, 2315845209, 2315311235, 719945459, 814407807,
    2495231737, 2248305350, 3228435827, 3985741157, 311482630, 1110330844, 1667991847, 1414688453,
    92869083,
];

const MESSAGE: [u8; 64] = [
    29, 204, 154, 221, 65, 56, 204, 167, 12, 130, 160, 47, 200, 7, 250, 159, 194, 82, 16, 98, 102,
    89, 177, 73, 39, 15, 105, 116, 233, 169, 31, 160, 5, 186, 46, 229, 44, 126, 198, 98, 20, 39,
    194, 203, 249, 170, 183, 196, 80, 111, 6, 194, 23, 17, 183, 73, 119, 95, 8, 123, 190, 17, 14,
    186,
];

const MLDSA_MSG: [u32; 16] = [
    0xc8f518d4, 0xf3aa1bd4, 0x6ed56c1c, 0x3c9e16fb, 0x800af504, 0xdb988435, 0x48c5f623, 0xee115f73,
    0xd4c62abc, 0x06d303b5, 0xd90d9a17, 0x5087290d, 0x16e60096, 0x44e2a5f2, 0xc41fed22, 0xe703fb78,
];

const MLDSA_PRIVKEY: [u32; 1224] = [
    0xa79ff050, 0xba5d1eb1, 0x8fa9f173, 0x0404ab6e, 0x0434e13d, 0x13f8112d, 0xc8d03393, 0xa0b2b8bb,
    0xbc884065, 0xa81a8fca, 0x5bc1dcaa, 0x0cd4dd46, 0xd7665ca7, 0xbc8526c3, 0xd059b91d, 0xcff6d854,
    0x0bc6da96, 0x2b338ee5, 0x61e3a9dd, 0x76c97fb4, 0x23aae598, 0x3a27cbf8, 0x7d72c6fc, 0x41aa7b44,
    0x38602445, 0x4372849e, 0x49bd364b, 0x3a5eae7f, 0x3b8a20b8, 0xdbf7193f, 0x9ce18639, 0xd2c8434d,
    0x957e9b8f, 0xdb5c9c23, 0xe7235ecf, 0x54c76287, 0xdaa9d035, 0x852688e2, 0xce20a85d, 0x32eb0f75,
    0x58abce91, 0x7ef0b2a5, 0x6ead9937, 0xe557940a, 0xc0a396c1, 0x771723d2, 0x0cc5768e, 0xf11a2792,
    0xc518a77c, 0xb1241218, 0xcfe93213, 0xe449ec01, 0x8e41ed5d, 0x1ec2f1f9, 0xac94f307, 0x6b8db6e2,
    0x2bc1c1af, 0x3372be23, 0xa918d3f2, 0xadab13dc, 0x367473ef, 0x7576aa2d, 0xf247a532, 0x66249618,
    0x9c44b0d0, 0x4c177f9e, 0xa942552b, 0xf480169c, 0x6567cb4a, 0xb3fa9a8a, 0x0e03047c, 0xc24474b5,
    0x91087933, 0x2f9fee75, 0x9c466c8c, 0xc660f32f, 0xd4e9bd25, 0x76c23f45, 0x5fb4156e, 0x4504510b,
    0x281b75a2, 0x2e52f3e8, 0x4c37dac8, 0xda8205c3, 0x00ad8f71, 0x161cd35c, 0xefde2593, 0xb03c28ed,
    0xeb3af7ca, 0xc72cb84f, 0x6c0513ea, 0xcf8ece2a, 0xbb772eec, 0x8549761a, 0x34f2969d, 0xa3ca1e2a,
    0x3f28d546, 0x7e6dd288, 0x620092aa, 0xa7f302a6, 0xe99cde0f, 0x85ec6b0a, 0xfa9f2694, 0x4d9c057c,
    0x2350090b, 0xf84bcc38, 0x064d8dc5, 0x4e9ff375, 0x58b701ca, 0x9db52ec1, 0xb7ac3dd6, 0xc4005f5b,
    0xd1e3a83a, 0x1ddbdb93, 0x54eb1934, 0x2a208d69, 0xa8fbbe6f, 0xbfdaafab, 0xa314e43a, 0x058bd636,
    0x5d00b489, 0x4474e2cf, 0x07fb7514, 0x7b35e7b6, 0x8162c317, 0x9d5ebb8f, 0x1c443e9b, 0x1daefb2b,
    0x0f38801a, 0x64974be9, 0xb8816f36, 0xee9f4a4e, 0x15af8c69, 0xfd05c354, 0x2103b8c5, 0xbe5a01cc,
    0x45e6d6f0, 0x9d26f78d, 0x281447e6, 0xf47f40cd, 0x62306faf, 0xa02ede4d, 0x9a79dd01, 0x534d903c,
    0x7115fdc6, 0x370a3699, 0x341c47e8, 0x1a98d040, 0xeb253678, 0xa7d63809, 0x150dbf56, 0x93eba171,
    0x023ad8a0, 0x01162575, 0xfd3c7977, 0x84bdc35f, 0xfd5ac6c6, 0x2c4e99b0, 0x5284e880, 0xd32600d3,
    0x71b6355f, 0x328c1f00, 0x776a6564, 0xadd6c0e7, 0xf634bb05, 0xd8d1c23f, 0x1c80d891, 0x7378707a,
    0xc9ce84a0, 0xb554d559, 0x5fcc691d, 0x511a9e44, 0x58e0e2ad, 0xd52925a4, 0x7b8cfc78, 0x6094d990,
    0x70a8b36a, 0xb9a6d452, 0xf2f41ee7, 0x6fe658ca, 0x626db02f, 0x11b74c23, 0xbcf669be, 0x4213ee59,
    0x30039328, 0x233993ee, 0x84ed6b9a, 0x3b9665b5, 0x2f842f60, 0x606d868a, 0x2c94ae51, 0x7da78df8,
    0x592b1e78, 0xb60cb4e6, 0xbd70c754, 0x90ffaf6f, 0x62f7c5f8, 0xf1e52213, 0xb877dcaa, 0xbddcce48,
    0x230c4033, 0xe50d726d, 0xecfdc898, 0x42708431, 0x183eec78, 0x3b57dab2, 0x0ede0272, 0xb2cef2e1,
    0xbe2b602d, 0x00dc5701, 0x8a0ec84d, 0x95e9c775, 0x813b71fd, 0xccbb9a2d, 0x7a3c91a8, 0x50578cf5,
    0x415032e5, 0xf28bc7fa, 0xf54ea1b9, 0xf1b36e1b, 0x80109033, 0x5b44e717, 0x2294228c, 0x4e50a1b9,
    0x9a5a9db6, 0xa4398b77, 0xc2c6d0ff, 0x88ba3735, 0x78514632, 0x4a25abee, 0x14e33f4c, 0x151ebcd8,
    0x3fe3e1e3, 0x83c25f64, 0xd89dcf22, 0x7f9fc8c2, 0x4a1f925b, 0x102113d1, 0xe278952d, 0xb55437c6,
    0x78c46ff3, 0x7b760601, 0xec79de1b, 0x4113b643, 0xfd040936, 0x967927c6, 0x21f93999, 0xcd30f713,
    0x1947709b, 0xdbfa80f9, 0x7fad629f, 0x3f740079, 0xae8701ab, 0xc1c14900, 0xe9e2d2e0, 0x0aebf19d,
    0xfdb249a9, 0x9c967b19, 0x2e360c01, 0x187beeca, 0x0386fb07, 0x9eb08f61, 0xc47b87fc, 0x899e3228,
    0x727365ec, 0x8ebe30c3, 0x1ef8d080, 0xf65e54e1, 0xd14c713e, 0x2959c000, 0xf3394eab, 0xad1ca40c,
    0x898fcecb, 0x40d3e13f, 0xb09f5e23, 0xe5f52a37, 0x8bddd0d7, 0x121bb6fe, 0x27a6bb74, 0xecff2e7c,
    0xc3889e98, 0xc0441be8, 0x9bec7dad, 0xff6f322c, 0x917fb331, 0x2821844a, 0x026a044d, 0xf310f8f0,
    0xa555ad7d, 0x4c8284da, 0x6b051dba, 0x15dc14fa, 0xe593a32b, 0x956ba179, 0x72f3ab02, 0xa915a4a5,
    0x9fb4b5f2, 0xd95ee9e4, 0x4bc28826, 0xee47f886, 0x3c964992, 0x077c9d54, 0xf2b51e8f, 0x56b3c8ae,
    0xe60742ab, 0x0b80cc58, 0x4920b72c, 0x83761552, 0x34ba4d54, 0xad695d62, 0x402ad29b, 0x975f19ed,
    0xf9a96265, 0x9e3cf823, 0x237fdbab, 0x072e685c, 0x21e1c7a2, 0xd5bd4466, 0x829c32ec, 0x37f429d4,
    0xaf510128, 0x1045023c, 0x98687787, 0xc4db5485, 0xa05f9e30, 0x5d029146, 0x6d242766, 0x6d77d867,
    0x8d95ed33, 0x9166fb5d, 0x5b0c14b9, 0xe0d0d69c, 0x2e677e2b, 0x00dad083, 0x04e9d33b, 0x72470c24,
    0x27076ed6, 0xfd33facc, 0x2f4942fb, 0xdc1917f1, 0x5b3fecfc, 0x1f1681dc, 0x53312be0, 0x22d0c60e,
    0xfbb09432, 0xfe06c908, 0xf682f707, 0xad201fe8, 0x5ff21da8, 0xd1e273b1, 0x12c5fcab, 0xe918fc38,
    0xbe1fd8a5, 0x96039f02, 0x47e1cf35, 0xcca31b91, 0x5642fe18, 0x1af50014, 0x8e33c205, 0x4984be44,
    0xb5da7ec0, 0x9120c405, 0xc9497ee7, 0x0e8e2fcc, 0x9793b14a, 0x944a2f75, 0x93e0a1f1, 0x9e2c2f51,
    0x06ba8997, 0x99a5b773, 0x59d340c8, 0x8cb2ff47, 0xb9215a73, 0x74e61389, 0x476b4d04, 0xd6dafd03,
    0xde542bf6, 0xea130e95, 0x4115387c, 0x057deede, 0x8eeb23d8, 0x044d7b10, 0xc5e76781, 0x568dfe7f,
    0xf55966c2, 0x223575aa, 0xf9d2abaa, 0x5a665850, 0xc42df890, 0x0b0a61ff, 0x765af798, 0xbc5e9869,
    0x341d2efc, 0xdfe00cfa, 0xbfec3fa0, 0xcaabd690, 0x4dd1553f, 0xa5c984ab, 0xc9a90057, 0x6975107c,
    0xd0e57100, 0xea9269ec, 0x344c888e, 0x7c06c8f9, 0xa679a993, 0x39cca744, 0x6c029a83, 0x17f094f4,
    0xd1674b32, 0x5a2836b1, 0xb8c09fc5, 0x6f4fd85c, 0x7b4dfa55, 0xac58e99d, 0x23813269, 0x444ad3dc,
    0xa2e1a22e, 0x7dedd211, 0x963bf3ee, 0xed0e00a8, 0xa1fcadca, 0x2e68f925, 0x72a8fa50, 0x1ca40162,
    0xda8ae227, 0x21e1f1a4, 0xc92c43a8, 0xf9c3a064, 0x69242abb, 0x93f5d944, 0x7d19fecc, 0xb13b4ef7,
    0x6957a260, 0x6bb6186f, 0x81cedb19, 0xb4f848fe, 0x18f2106d, 0x50e9c85e, 0x9f08ec55, 0x0e7dc483,
    0x378a6246, 0x9a68dbdf, 0x7601f9e6, 0x269db929, 0x2b1c7642, 0x2c86ac71, 0x5e3c75af, 0x4899e5a1,
    0x6f2e3149, 0x2b187d28, 0xde404637, 0xe0d72f80, 0xea1c780d, 0x6322024d, 0x9f5cc9ce, 0xc88b574a,
    0x7ad1054b, 0x924c949d, 0xeda8436a, 0xcc11dd4b, 0x79fe3a96, 0xe6f153a6, 0x10f94ad7, 0x4c16a8b5,
    0xbf76e989, 0xdbcbdfa9, 0x918aa1e2, 0xa209877f, 0x78ab5d63, 0xc914f989, 0x32414a20, 0x47594d35,
    0xb3001e60, 0x5e213515, 0x93067645, 0x9996ca51, 0x55362db5, 0x45405e78, 0x9837d366, 0x50e50557,
    0xd9f66b0f, 0x75d05293, 0x0ebbf786, 0x3c2962d5, 0xc84697db, 0x4aa287ea, 0x2d581145, 0x2c172ab2,
    0x8a3b7a42, 0xc71f4316, 0xac6e8976, 0x5d2e8c82, 0x3b868931, 0xcc6cfe26, 0x0baef8fa, 0x87191958,
    0x4883ad89, 0x3d2eb58e, 0x62659fc8, 0xd94e05a0, 0x53422627, 0x8b56654c, 0x930a8235, 0x5068bcec,
    0x5588b377, 0xbcf932c3, 0xcca01b86, 0x8d838a77, 0xc1252b66, 0xa9670368, 0xf55a677a, 0x2bd7a186,
    0xe0ad9510, 0x4988e7b5, 0xc846d466, 0x37a8d86a, 0xa1ad0b41, 0xdb9261dc, 0xc09977a9, 0xb1042274,
    0x516e9f9c, 0x900c8726, 0x40b6c6b0, 0x86eafb5f, 0x6928cb2c, 0xdcfd0141, 0x4c3f419f, 0x562f72f5,
    0x233bbdb8, 0x3c2543a4, 0x38262475, 0xe02cb9f8, 0xd9e53abd, 0xd3775e68, 0xe6d704b4, 0xd4d80922,
    0x9b3b1ad0, 0x47d6284a, 0xd69927e5, 0x383ae3ac, 0xe5d034e5, 0x22dcf450, 0xeeacbb45, 0x9c875bfe,
    0x90d0ef7f, 0x3d54f2f2, 0xdc6341e3, 0x439670aa, 0xa55c479f, 0x2069d8e5, 0x89455154, 0xff9de84b,
    0x562433c9, 0xad6f2df6, 0x9de3f40e, 0x13ddb51a, 0x36118782, 0x571ef697, 0x7ce71d40, 0xc0d27ab6,
    0xc9213f5a, 0x34d7af39, 0x2bd64732, 0x7b8cb852, 0x4cfa3003, 0xe02d8ec9, 0x79160070, 0x6663b6c3,
    0xbe82a4ec, 0x6706ad27, 0xb0f6d39d, 0x47cccef4, 0xf29ffbd1, 0xec17b5f7, 0xa98e8ae6, 0xe4522fed,
    0xdffc7280, 0x34857033, 0x791d04a4, 0x6c0618d1, 0xa3b5eab8, 0x299749df, 0xf48c635e, 0x2696482a,
    0x4488c08a, 0x19fb50f8, 0xd0494c8c, 0xf624b0c9, 0x1d644c6e, 0xc7fac94e, 0xd345da88, 0xab20a9c8,
    0x3b85b2dc, 0x37b87a36, 0xeb33fb36, 0xc83cd973, 0xecd30a03, 0x588a4fc0, 0xd52d1440, 0x7effa819,
    0x6ab2bbac, 0x02168cc4, 0xfb90a75d, 0x2e889d43, 0x40559803, 0x8a397687, 0x96539757, 0x4ab2e768,
    0x3656db5a, 0x37fff98e, 0x3fff07ac, 0x3ca7e09d, 0x30391fc6, 0xa4251d66, 0xa9b06608, 0x433a3dc4,
    0x6cdee068, 0x2a2b4a1b, 0x0f6fcde0, 0xe44a1707, 0xc8455056, 0xbc5a4312, 0x86e4dcca, 0xd2b45579,
    0xb8199849, 0x4c1ba061, 0x23ea92a3, 0x3cec83de, 0xb7ded1e9, 0xbc699055, 0xc07625c0, 0x73797932,
    0x764842aa, 0x3ac7c7de, 0xe4f5ac70, 0x88163f20, 0xd9baf251, 0x24c7bf98, 0x98c6cdc3, 0xb642b434,
    0x2e01e250, 0xb98242a7, 0x422ad6bc, 0x2da57957, 0x5bfda095, 0xe9b7a53c, 0x8ea71897, 0x4a12836f,
    0x0e2c659a, 0x2e2261bb, 0x4f4da295, 0x86aa057c, 0xf8c20233, 0x83bb2e84, 0xccfb7494, 0x24118a19,
    0x2d71b860, 0x6437c695, 0x2afa1db7, 0xbc64ee8f, 0xeb2a067d, 0x1c8bb5c2, 0xd8a485a3, 0x961d210e,
    0x33cc838f, 0x29aaebe9, 0x919c39e0, 0x55f1443e, 0x6a5bf10c, 0x04657355, 0x0d7044d8, 0x755dcbab,
    0xfdb5bf32, 0x9153b508, 0x1da5e67b, 0x4757ec65, 0x5b4e384e, 0xeb30c746, 0x45596e01, 0x42e7c93e,
    0xd53806fc, 0x6b33f67c, 0x083412cf, 0x2622d5c8, 0x4662e385, 0xcd667f5f, 0xc5643bc4, 0xce66d2f6,
    0xbc3672da, 0x6bef2821, 0x8da7964c, 0x387027a8, 0x1a266e1f, 0xcc2ba1a7, 0x54040dcd, 0xd12e12d2,
    0x39a759ec, 0x87629156, 0x0851daed, 0x22084c21, 0x186da822, 0x03933bc1, 0xbc427966, 0x49157143,
    0xb09169e7, 0x436ee950, 0xe7254517, 0xcb9d31e0, 0x26b2acbc, 0xca384c6a, 0x8b4a3e1b, 0x1ec00de8,
    0xc9c1410b, 0x079a6691, 0x7b6f4412, 0xe0308566, 0x2c0340cb, 0x7fddebdf, 0xe4bb0585, 0xf6695749,
    0x70371479, 0xbd769f26, 0x540d34be, 0xa059af88, 0xa01f50d1, 0x09040139, 0x3ff1a68e, 0x7665c106,
    0x3cea0590, 0x32791e9b, 0x3cc6d78d, 0x76321e2c, 0xf4b795fd, 0x7a3c53da, 0xffc94657, 0x8bc8c0bb,
    0x19c32f10, 0x334a496a, 0xd538cc79, 0x51ae75e5, 0xfccfa4ea, 0x4ae57ee9, 0x358a143e, 0x27ec8de0,
    0x417b82f4, 0x0b1dd951, 0xebdeb443, 0x8e59f55e, 0x989df46b, 0x3fe50700, 0xfd276311, 0x0f95c172,
    0xd0ed1e4f, 0xe49ab80b, 0x7a6bfe3e, 0x9ebf0b53, 0x4ece10ef, 0x972e94a0, 0x3c5edcbd, 0x829c4ff9,
    0x985d4bf1, 0x416d7ae3, 0xd6ca6d7f, 0xe9b831ed, 0x41e6a0bf, 0x22d9c806, 0xe7fb6421, 0xa5ee97a7,
    0xaf237033, 0x565fef5e, 0xd4ec55ef, 0xe0f5d8c5, 0x1cc8b2a1, 0x59ff78fe, 0xa9492f49, 0x20238ec5,
    0xcf803db2, 0x5b3cba5b, 0xc4898969, 0x36bc58b4, 0x3a60a5d3, 0x83a6a096, 0x7163f389, 0xc8d40286,
    0xd40608da, 0xf0520375, 0xc8ba7d0f, 0xea3a61f9, 0x533eca39, 0x1a57af1c, 0xc6a2f48a, 0x22db8186,
    0xfb6efd4f, 0x90cc09de, 0xfb140d6c, 0xf549a831, 0x8876a83b, 0x19cb19a3, 0x5807144a, 0x4b5e097f,
    0xb231e68f, 0x841e8936, 0x9ab92d31, 0xf84e243e, 0x2817864f, 0xb9486fbf, 0x2de7e899, 0x45765743,
    0x7b0d31eb, 0xdf00d32a, 0x07828cf8, 0x9fa05879, 0x0d2c8e04, 0xbc8791d5, 0x4fac09e8, 0xd5e69d19,
    0xcba879ed, 0x00f38f66, 0x6df92c53, 0xff55a17e, 0x074ff227, 0x3b30de40, 0x4a2793cc, 0xbbf683a7,
    0x3c37e65e, 0xbd047ba7, 0x26689e8b, 0x6c858d9e, 0x1a55af66, 0xd222bbd3, 0x33efedc3, 0xe76666a4,
    0x7146604e, 0x368109b4, 0x188e1814, 0x2e230044, 0x38524510, 0x810004d1, 0x2d966142, 0x34642109,
    0x2128c8a1, 0x29368b89, 0x30cc6202, 0xe060c2d4, 0x45b80a12, 0x384a1082, 0x6468b701, 0x01421130,
    0x94e04416, 0xc845260a, 0x06388a50, 0x34044939, 0x0b84400c, 0x62110045, 0x20804d49, 0x0b45b404,
    0x2a268424, 0xc3028e10, 0xd48d0223, 0x6828a429, 0x14401032, 0x0b08a288, 0x30392252, 0x28cb31c6,
    0x206a360a, 0x0230d466, 0x48dc8048, 0x40694662, 0x80c2a08a, 0x06504d09, 0x094a1290, 0x4cb85388,
    0x924b6dc9, 0x1a88a620, 0x0188cc69, 0xc8204642, 0xda8222a0, 0x51b88c8e, 0x40a40834, 0x51121523,
    0x40968181, 0xc8230c94, 0x81610221, 0x10309404, 0x34247186, 0xdb52281a, 0x44c70241, 0xa5194c39,
    0x2049c28c, 0x44189a4a, 0x18844d48, 0xe00d16d0, 0x70904148, 0x03207022, 0xa011a0da, 0x2da8030d,
    0x211a8225, 0x1c6cc421, 0x30824811, 0x22594228, 0x03652662, 0x8a086208, 0x00d32040, 0x0c11b712,
    0x71b6200c, 0x148b01b0, 0xd4008643, 0x5128e148, 0x10108020, 0x8c0906d8, 0x06084b09, 0x28d36c03,
    0x0968c901, 0x00402191, 0x44488c90, 0x440e34d2, 0x4da25c80, 0x82412e12, 0x090c9214, 0x3000a168,
    0x944b10c8, 0x09240620, 0x8d04c821, 0x80586c16, 0x9b444452, 0x8a471121, 0x84e08cc8, 0x198e3253,
    0x80870b60, 0x07026228, 0xc261301c, 0x6e06234a, 0x32434887, 0x0008a6a2, 0x4198420d, 0x26448214,
    0x1a6c9311, 0x8a304245, 0xa6615016, 0x0c8096d9, 0x64a00811, 0x80136d88, 0x58064914, 0x2486cb40,
    0x84c481b0, 0xdc42305a, 0x0113106a, 0x06124008, 0xd964984a, 0x65b8da89, 0xc2493138, 0x230c9681,
    0x46492322, 0x071b6210, 0x1168b688, 0x70028450, 0x825a2645, 0x0211321c, 0x4a424890, 0x38cc4044,
    0x419144d2, 0x9197206d, 0x20912502, 0x410dc664, 0x60c12405, 0x02834886, 0x0831b803, 0x41005024,
    0x24986108, 0x114800d9, 0x48004901, 0x908c0c46, 0x616d4860, 0x09c01141, 0x40cb1192, 0x90288082,
    0x0a231001, 0x86dc9184, 0x9951b4d4, 0x85b91340, 0x39210d80, 0x816c4221, 0x6e292029, 0xc89048c4,
    0x4845c2e2, 0x90c61b70, 0xb2c93240, 0x9091b2dc, 0x41b4044a, 0x00d10590, 0x5c414024, 0x42445190,
    0x410b0509, 0x0160a61b, 0x09945c70, 0xb86200b6, 0xd388c253, 0x50311260, 0x02993190, 0xc091b044,
    0x4502da41, 0x86c83024, 0x8480a844, 0x8135122e, 0x49116580, 0x928cc0c9, 0x06040491, 0x18935030,
    0x1b4cb702, 0x0c10d052, 0x245051b4, 0xd80616c3, 0x40c62080, 0x06888c28, 0x43204312, 0x6d301a46,
    0x24518c21, 0x24212864, 0x70a00424, 0xb85a4d82, 0x6320a649, 0x48028886, 0x12883000, 0x51422802,
    0x2db2a10e, 0x06015208, 0xd40dc20a, 0x6a490250, 0x485b6904, 0xa192371a, 0x29948260, 0xa8ca2a06,
    0x11323010, 0x69906305, 0x48204988, 0x4c2990db, 0x31c6c280, 0xa6018032, 0x19013452, 0x46282400,
    0xa0616836, 0xe33010d9, 0x00c01b62, 0x10c37182, 0x2031b480, 0x4d90a050, 0x38193100, 0xe1690489,
    0x51a80b60, 0xa5012834, 0x908e26d8, 0x0dc60060, 0x871c44a7, 0x02044600, 0x6046592c, 0x30612536,
    0x91098893, 0x0c90e450, 0x111c2604, 0xd891a713, 0x51008161, 0xc64a71a4, 0x588d8610, 0x11940904,
    0xc2428dc6, 0x81610659, 0x0e12994e, 0x40404a06, 0x618c971b, 0x8d86986e, 0x40c92812, 0x1c104292,
    0x05925451, 0x32640930, 0xdc51b863, 0x85872032, 0x464b0008, 0xda023854, 0x0d94d826, 0x470b85b0,
    0x51514404, 0x66469a52, 0x03235112, 0xd04e2410, 0x30485465, 0x80241198, 0x898cb8d4, 0x09161305,
    0x24db8006, 0x984116d1, 0x2a32dc89, 0x00926080, 0x1c2a3212, 0x9144e24d, 0x89224892, 0x8c089662,
    0x5222c809, 0x084920a0, 0xa14d0814, 0x2d840184, 0x182108b8, 0x5b70a640, 0x42345485, 0xa8e251c8,
    0xe288b64a, 0x8128996a, 0x26cb9102, 0x0a309890, 0x6116e38d, 0x160b0624, 0xd28d0862, 0x65a80b45,
    0x42d921a2, 0x814996dc, 0x4e092200, 0xc4506614, 0x8a40964b, 0x0634db21, 0x368c2434, 0xd34d8609,
    0x65a69225, 0xa40c2997, 0x10483298, 0x0986c250, 0x91104502, 0x0b01b259, 0x8d80a231, 0xb2848614,
    0xa24c284b, 0x24951345, 0xc7040648, 0x9829b2e2, 0x01905c80, 0x36cb8628, 0x9308465b, 0x12251444,
    0xa60c6018, 0x8c519653, 0x05068411, 0xb0218425, 0x1b8da4e2, 0x0114442d, 0xc6818a14, 0x6348b450,
    0x50a2994c, 0x04e24900, 0x5a094322, 0x0486c225, 0xb2647044, 0xcc4e1842, 0x24a08b91, 0x12588823,
    0x0189a29c, 0x4a152141, 0xc4832536, 0xe28da463, 0x11a65c25, 0x065a8e21, 0x0006185a, 0x11a52245,
    0x926211c0, 0x0168c0a4, 0x65c40466, 0x16996e30, 0x014d24e3, 0x0da69391, 0x25014089, 0x1a51869a,
    0x09321b11, 0xa0994128, 0x6229a209, 0x72388a41, 0x24d22086, 0x9870a723, 0x20a28246, 0x24ca40a9,
    0x130dc849, 0x2c28d088, 0x081c05c8, 0x5231a862, 0x0e060111, 0xa4d36840, 0x0c653090, 0x04b52151,
    0x00dc5020, 0x44082259, 0x86490391, 0xb10b1118, 0xc9512600, 0x8400ca50, 0x96994632, 0xcc8c2654,
    0xca2d7927, 0x39287f47, 0x9154b551, 0x1f3e3e37, 0xf5717be2, 0x80292427, 0x42af94df, 0xc8812fbb,
    0xc2c37f2d, 0xaffc9db5, 0x1eed7b7f, 0xc07cc9e6, 0xb85dd20d, 0x7df1838d, 0x44901d76, 0x280f35b3,
    0x587a8d8a, 0x71a3cb3a, 0xb85d2291, 0x46127141, 0x5f8ebdf2, 0x54d58aea, 0x5cb81c95, 0xc28ec76c,
    0x884a5a99, 0x616f610e, 0x6049245e, 0x2a4ffcd1, 0x2e723eb0, 0x8fe77f6c, 0xdad7c056, 0xc9f4a875,
];

const MLDSA_PUBKEY: [u32; 648] = [
    0x7aed27b5, 0xa562dd2f, 0x10f310cc, 0x99f6bf11, 0xec184836, 0x372625fd, 0xfb5c0b87, 0x06883dcd,
    0x5247bbf9, 0xef5c32ba, 0xf4764326, 0xbe01105c, 0x091fb624, 0x04255894, 0xbf8183be, 0x17f78397,
    0xfe8db74e, 0x14ff1b56, 0x846a7c3b, 0x0dace661, 0xef9ee21a, 0x9f0fe727, 0xd18f8904, 0xe5dbdfec,
    0x3fa93849, 0x44462fa5, 0x25d12e8a, 0xc56d1b20, 0x0330c59c, 0xcf27de40, 0x268a4c0f, 0x24048891,
    0x523f6039, 0x0dda85d5, 0x5d353f97, 0x5a6e6e94, 0x063926db, 0x54a8bfe3, 0x60e097cd, 0x6972eab5,
    0x3daccccb, 0x4255017f, 0xbc722547, 0x7790dc0d, 0xea3a4395, 0x6e7c8f52, 0xa9db3d2f, 0xdee33d4b,
    0x9b4a1f09, 0x4b0f3dd6, 0x57f31488, 0xfe001de2, 0xc828b5b4, 0x76d5b6f0, 0xeda04398, 0x551781e0,
    0xa3220e53, 0x7dde0d74, 0xcf391758, 0x25c1c281, 0x959d7d30, 0xe9924f10, 0xd9211ae0, 0x8b96cc04,
    0x3001cdf3, 0x7c5e416c, 0xe6b25413, 0xb57b4b3c, 0x00339027, 0x332c608a, 0xcc44e3cd, 0x1d37b809,
    0x295173f3, 0x5f3c6785, 0x7ef62145, 0x94381494, 0x772d448c, 0xbd62c3ad, 0xb67034d1, 0xa9df95e4,
    0x96aaf67f, 0x068a767c, 0xdd744d6b, 0x34c9722f, 0x3828bc5f, 0x21f6470f, 0x89c46247, 0xf95ae1dc,
    0xff58dd7c, 0x80ced308, 0x24c05432, 0x95f50e3d, 0x4ce59644, 0x21175006, 0xa3420db6, 0x7f0233dc,
    0x3c76b4da, 0x872e9986, 0xe2f0a111, 0xedd774c2, 0x7f72a687, 0x3d0b77f1, 0x5fa9cd1f, 0x158d4743,
    0xce4f4b84, 0x63dd6477, 0xdc3ada61, 0xe9df21e1, 0xf9874a59, 0x09a2a762, 0x2eaa04bc, 0x6b3660c1,
    0xdaedc89b, 0xcd5e509f, 0xfcdd9f82, 0x464633b9, 0x7e0abd8a, 0xb281f7c9, 0xf10cfcf9, 0xa18af897,
    0x0daadbdd, 0x22727509, 0x2be47f8e, 0xc18f6ee7, 0x264fc786, 0x9449cd10, 0xae7a6ffe, 0x7b162d3f,
    0xfba57f3e, 0x4fc52563, 0x3bb5019e, 0xbef12f1b, 0x2c41c523, 0xaf56cb15, 0xb5293cf9, 0x836b787c,
    0xe6360aa5, 0x42b93a52, 0xeb9c0862, 0x6bf01a0c, 0xdf1ce5cd, 0x5c32cd02, 0xd7dbd1d7, 0xd25939ea,
    0x360556dd, 0x0cd0fed8, 0x9676fe5a, 0x568ceb80, 0x42504e47, 0x7f27d0a2, 0xf67ad693, 0xe102a7fb,
    0x10f0b5df, 0x9bb5c6f1, 0xa77a5481, 0x9100a102, 0x36a4698f, 0xa20e94b8, 0xaf79e336, 0xaf26015c,
    0xb9194799, 0x64cf0fb2, 0xb929f730, 0x27ffc2f0, 0x7418ce1a, 0x32600f5c, 0xa03e7384, 0x35f3c2d0,
    0x3b141fa6, 0x89127435, 0x9fe4e0f6, 0x98e6db17, 0xb740600a, 0x2418d5cd, 0xeb26a33e, 0xadc862c1,
    0xc3aca9d5, 0x78763c6c, 0x067f2d48, 0xad776264, 0x37dd62ab, 0xf0f6dafc, 0x86c1996e, 0xffb84295,
    0x7cd1c218, 0x6cbb7aca, 0x6e5b97f0, 0xb11381b1, 0x3a84bbb7, 0x32a6f1a2, 0x08505d57, 0x00ef4032,
    0xd35f1a2a, 0xc99dff28, 0x6633f5d2, 0x14f64cda, 0x61902273, 0x8cdcd79d, 0x1d7aeeb8, 0x2a046439,
    0x76a3161e, 0xe7f6cf12, 0x6c1cf41f, 0x677069a2, 0xd710cc5d, 0x010a1f38, 0x283799b2, 0xcffc4003,
    0x8e1c7654, 0xb564d4f0, 0x5b10495a, 0x2725c0e2, 0xcd67cfdb, 0x1761bc70, 0x4c375533, 0x4db4a0da,
    0xa5e7f5af, 0x00bb9c2b, 0x253a2f58, 0x2abf62fe, 0x9613af54, 0xd8f2d657, 0xa5a35ecf, 0x836a5545,
    0xac764934, 0x7ed7bb71, 0x97b43a73, 0x1d68ed85, 0x5925ee49, 0x8140a3aa, 0x42a73de7, 0xea6071ca,
    0xcfee20c2, 0xa1ed121b, 0xe33e3e73, 0x485f0bf6, 0x5c60f008, 0x19eb2f26, 0xadee6104, 0xd9b8f02f,
    0xdb72dc72, 0xeb75bd1f, 0x5186f74d, 0x72084b4f, 0x5ed43791, 0xc247652e, 0x9c606ae2, 0x9f36d5a4,
    0x8fe991ac, 0x6cb7d838, 0x88241cb2, 0xd2062f26, 0xdd4209cd, 0xe9229b5e, 0xcaac558d, 0xad4c83f5,
    0x9baeebd6, 0x797c5620, 0xde72e799, 0x72ffa82e, 0xd89092af, 0x2e5ddd28, 0x890c1764, 0x919dca8f,
    0xcbcbf3a5, 0x525a33ca, 0x13c20bb2, 0x624692b9, 0x6e3d6142, 0x541d0d3c, 0x2676b443, 0x1835d901,
    0x2842e3b7, 0x8f60a792, 0x616720bc, 0xfbce6782, 0xe08135b3, 0x3a83ce2d, 0xb96e05c6, 0xbd240a79,
    0x69d4411d, 0x683bd53a, 0x398549fc, 0x1a560af0, 0x153a58ef, 0xea229311, 0x6004d303, 0xafd48f11,
    0x84b8b5f4, 0x186b7ec4, 0x91660f55, 0xec70520f, 0x9f70f784, 0xbf01ab56, 0x6aad1c86, 0xd2443ca8,
    0x7df71965, 0xa4b3f1c1, 0xa9b85b14, 0xa9d16a67, 0xfc2526fd, 0xcbfe975a, 0x40506029, 0x5a7e9126,
    0xbee8c3ef, 0xc6f845e9, 0x5df5ba5e, 0x48ad1f95, 0x24330843, 0x1ff7aba4, 0x15607310, 0x44219aa6,
    0x170fa53e, 0xda63015a, 0xa34d77df, 0x8097d3b9, 0x3dc9996e, 0x07417044, 0x704c543e, 0x779d6fb8,
    0xde7d8fa4, 0x8d0fcf50, 0x3deff2bb, 0x63c08b90, 0xbcaea490, 0x38cd2a0a, 0x1e70f33e, 0x6cc95a33,
    0xb18bd65f, 0x3ba2d010, 0x221c347b, 0xa18bcc1e, 0xb2c3daa0, 0x529586b0, 0xc334962b, 0xfaa03bb0,
    0xc6f25d70, 0x3c8d6a00, 0xa0327bf6, 0xd1e0c36d, 0x6b127553, 0xd8870aab, 0xbbd96838, 0x456171c3,
    0xe1cc60b5, 0xf3246c95, 0x796c603a, 0xbe89688f, 0xee4f6a5a, 0xb79daa2e, 0x8a3e09c2, 0xc097fe39,
    0x9ee26682, 0x65a25ec9, 0x75f66921, 0xdc5b3371, 0xf89ea388, 0x395f7508, 0xf44bf532, 0xc8a0ee7a,
    0xf5de37d9, 0x9ac3f456, 0xfd56b894, 0x7d200922, 0x99602b3e, 0xe70f8719, 0x8629b6b7, 0xdf867e81,
    0x5ce0e8d6, 0xffbd1390, 0x9487cb7e, 0x8c1b3a77, 0x5845205a, 0xdf1c6ded, 0x37ffeff7, 0x8e5d93e8,
    0x3320283f, 0xfb1fc5db, 0xe6623e59, 0xcc8b74ec, 0x2693a27a, 0x35cc9fe7, 0x80c71050, 0xac7857e5,
    0x2db21490, 0x9cde5207, 0xf6ed27af, 0x01be06e5, 0x35ec8bd2, 0x874a43c2, 0x4573aee6, 0x0f8feb96,
    0x6006712a, 0x8ac615ac, 0xdba47a7f, 0x16e41055, 0xcdea6cc0, 0xe16e58b5, 0x25ed0826, 0xea689725,
    0xaaafeefb, 0xe4665ae6, 0x1d5e7c6d, 0x69ad5c49, 0x878787b5, 0x0b53a88b, 0x48792512, 0xcb52b6be,
    0xc4625e73, 0x06fa3bcd, 0xa2332960, 0x94ac137c, 0x5161d88e, 0x5ea49a30, 0x15274338, 0x98966c24,
    0x1a1f1fd3, 0xecfa6986, 0x3686bd91, 0xe8d465f5, 0x4b9f0981, 0xdcd77dd7, 0x80efef4c, 0x41545043,
    0x80c17bc9, 0x0650e2c9, 0xc3d77f3e, 0x07b4bbd8, 0xd78815a6, 0x569f4063, 0xf2c45889, 0xb844f57b,
    0x64ed3680, 0xfec3a5e6, 0x0f878307, 0x74b2fb59, 0x649deef1, 0x05f476f8, 0xca906f96, 0x8b6a1895,
    0xc77adbe7, 0x8556d9e9, 0x28487bb5, 0xb261e1e1, 0x31daefa4, 0x920eed7b, 0x33124e92, 0x35ea2d57,
    0xb559c9b2, 0x112ac50c, 0xa833880c, 0xe5435b3c, 0x80937b82, 0x75919939, 0xa69a25e4, 0x722c1775,
    0x258e6c52, 0x336df5cc, 0xa9820ed7, 0xa990e502, 0x8571c29c, 0x6ae483ac, 0xdfebf770, 0xeb8e6c72,
    0xa101889e, 0x0d9dc4f2, 0x767a86ce, 0x9bdc7773, 0xc581a943, 0xdb193cd9, 0x26e11eb4, 0x5ba4354f,
    0x9abb844f, 0xf992f169, 0x75518e87, 0xa4536100, 0xa9b530ed, 0xd8801d35, 0xb2f5a791, 0x66ce618e,
    0xd987acd3, 0x001cc27a, 0x2b7c8b1a, 0x0fb4adcb, 0x778e4f3a, 0xa66bea09, 0x282c019d, 0x6bf86c62,
    0xc36e889b, 0x96bf39c2, 0xd723fd1e, 0x792b12c0, 0xfd3bedc5, 0x8a633339, 0xcfee23ef, 0x89c7ccf4,
    0x0e3f4611, 0xafebe6bf, 0x36dfcd30, 0xc2685426, 0x792cfb94, 0x783bc8f6, 0x2ad54e79, 0xff9d05a9,
    0x61c1df9a, 0xd92f8bed, 0x263a49e8, 0xc2f6f45e, 0x867c4392, 0xfb9e5011, 0xe3c46650, 0xce5b6c0f,
    0x008b15f0, 0xbe728595, 0x2492db17, 0x166c70ec, 0xb9750c84, 0x79a38052, 0x181b74ff, 0x832119ce,
    0xa2d5fcb1, 0x9363e405, 0x1f8267d1, 0xe6ff7b17, 0x9d037148, 0x87e3ab62, 0x22ac1965, 0x4cfda2f2,
    0x99921e1e, 0x416ecf2a, 0x638d6c6a, 0x5cabac6b, 0x55722d3a, 0xba54ac7d, 0x8f43bd56, 0x8b7e8e7f,
    0x0847d181, 0x00d42c7a, 0xc075d12e, 0xea96e836, 0x098fc053, 0xa124ea5f, 0xb1d7198e, 0xb80420bd,
    0xa7ad3e28, 0x5ac277d7, 0xf3266877, 0x869a55ed, 0x04201221, 0x0fa82b6f, 0x8b011452, 0x4e5a6b4c,
    0x19cc8bb5, 0x954bcbef, 0x1a52d67f, 0x54acac2c, 0x50e0be80, 0xae84cdba, 0xf12dddfd, 0x414ebcf5,
    0x9178fadb, 0x845b64e9, 0xc3f31058, 0x4a74d242, 0x902c0738, 0x3c6c9a2b, 0x1edb5549, 0x0bfda52d,
    0xa220aa74, 0x4e47a41e, 0xf62cd32c, 0xcda48197, 0x208a6b8e, 0x8ac194f4, 0x2eed6182, 0xfdbc18fe,
    0x87b88f56, 0xd7d6070d, 0xae807024, 0x7950562c, 0x40887e2d, 0xeff57bc2, 0xd1532a14, 0x40871f3f,
    0x4def66b2, 0x14491954, 0xce53d3c9, 0x728bf65f, 0x5e0255b8, 0xf6f444ff, 0x31ad13c3, 0xd05b1108,
    0x8a86b3da, 0xed838857, 0xad3a2cf8, 0x8635f2d7, 0x25b55356, 0x026a33df, 0x39f9f567, 0x983bd2b9,
    0x7afc3e14, 0x78be9c2f, 0x12e47d37, 0x3b2d5ba5, 0x348bc883, 0xc8553ef2, 0xdd04029b, 0x947cfd76,
    0x5f586b23, 0x956b4924, 0xd73fe263, 0x0c65698c, 0x32c02a23, 0x1c1ffac6, 0x775d3e80, 0xe67688da,
    0xd25de644, 0x35adbd33, 0xb59078a6, 0xc804c2de, 0x933a4251, 0xb5f988f7, 0xd83d50a8, 0xb18d5957,
    0xd0aad98f, 0x254bcd5a, 0x9d95f52c, 0x73b6dca3, 0xb9aae7b4, 0x8dd4624d, 0x53b5d7d7, 0xb34fef88,
    0x987ca072, 0x32cd2eaa, 0x1d683173, 0xf4d27aee, 0x336c5dac, 0x7b36869c, 0x5302681c, 0x5792bdba,
    0x884a5a99, 0x616f610e, 0x6049245e, 0x2a4ffcd1, 0x2e723eb0, 0x8fe77f6c, 0xdad7c056, 0xc9f4a875,
];

const MLDSA_SIGN: [u32; 1157] = [
    0x0036312d, 0x29211a15, 0x0b000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x0000923a,
    0x35120192, 0x8c7902ee, 0x3a3305f8, 0xd6cdc4bc, 0xb7380deb, 0xe1b3967b, 0x250ae5c6, 0xa1763af5,
    0xc7bb8e74, 0x69676649, 0x0ceae8c0, 0xab965d34, 0x2f140e05, 0xee0d03e9, 0xfb53319a, 0xe1692381,
    0x1e5ea6df, 0xd6434c22, 0xa561dc9b, 0xae1b21e8, 0xc6d6092e, 0x6a3ab09d, 0xcba8145c, 0x30c2b4ce,
    0x077d03a0, 0x25b03776, 0x9b1b7036, 0x7762b8a8, 0x1ad7e4ef, 0x3eaf6fd7, 0xcdfbf65f, 0x26c41a42,
    0xc34e95bb, 0x4cb371d4, 0x8a8b3153, 0xab176918, 0x11d19515, 0x818c2f51, 0x88db04bd, 0x95fbfe64,
    0x73c1d612, 0xfbe2c71e, 0xd742b90b, 0x2d4f13be, 0x8bba5c10, 0x65e44cae, 0xf77d3c63, 0xae9bf94c,
    0xb836454c, 0x24cc0440, 0x3a70a18b, 0x3acb5759, 0x0f7d637a, 0xbd930eb4, 0x96506a26, 0xec02d343,
    0xb4633f7b, 0xa8169781, 0x727e7f4a, 0x107d38f0, 0xc4a2e471, 0xedbf8ea9, 0xdc676e78, 0x46078b4b,
    0xcd027ce7, 0x80993786, 0x814afce1, 0x331fd9b2, 0x0571990c, 0x9d2909d2, 0xbc3b47d1, 0x0ef2239c,
    0x7b96f6e6, 0xdf2fbb5c, 0x5a9d7527, 0x37219cab, 0xfd5ae9dc, 0x4d131045, 0x43ce0239, 0xf1f1b44a,
    0x5ec3c232, 0x74531c13, 0x65779213, 0x261c93c2, 0xe751a4cb, 0x18a8ccc1, 0x26ad1f4a, 0x523a7f47,
    0xf0c85d03, 0x98fd2c01, 0xa51672e4, 0x188c13a3, 0xf90669b3, 0xee48a4d5, 0x303fbd71, 0x3a43523e,
    0x0c0bfb94, 0xebab1954, 0xd20e8e80, 0x98810ab2, 0x4bb50345, 0x719cb84c, 0xf4cf1494, 0xd421c089,
    0x845c7561, 0x8ed00e8c, 0x87f33570, 0xd30db6d5, 0xf3fa5268, 0x7a6cdd34, 0x342f01f2, 0xf64f3ac0,
    0x917d5096, 0x41454a3a, 0x3c027579, 0x7e8503dd, 0xe8b33e36, 0xdda70384, 0x145b8231, 0x7e8165ad,
    0x27e76223, 0x066c5e46, 0x554a213a, 0x3d2b3c6f, 0x683e8040, 0x9e9910c8, 0xd60142c7, 0xf6992422,
    0xbc795d32, 0x2de14e57, 0xb73aa2ad, 0x1a2124f6, 0xc3245e44, 0x5222a8f8, 0x9894952b, 0xcc46318c,
    0x4b24cd74, 0xe3794f60, 0xb2341ede, 0x18b27363, 0xa5ea14c9, 0x3802cf01, 0x2606d3ab, 0x219d792b,
    0xdfc53480, 0xa742ce21, 0xc74f90f0, 0x86177a19, 0x90ab8a88, 0x4a9e5fa7, 0x0e9864dc, 0x894a6a62,
    0x98865b48, 0x3a15164a, 0x549814cb, 0x2c03254d, 0xd8038ecb, 0x33dd1c95, 0x0d6fa8ad, 0x8249be1b,
    0x5eb0a9f2, 0x3e799102, 0xe8bca683, 0x379ec694, 0xe0a0b6dd, 0x323f110e, 0xef34e510, 0xc2f2054c,
    0x234b2c0c, 0x210ac1a0, 0xd0b06e09, 0x0d30925c, 0xf6496cc5, 0xc91b1018, 0xaf3e8711, 0x42ac170b,
    0x204ad031, 0xfedb0cd0, 0x9fa66d15, 0x845555a3, 0x189baf07, 0x2ee87265, 0x5f6569d6, 0x27248f82,
    0x2f060f48, 0x5a28cb9f, 0xf06c35c3, 0x3f41b2eb, 0xa32f701c, 0x08c50777, 0xf7290341, 0xeb60f822,
    0x62d13a42, 0x2ff880cb, 0x859bdcac, 0x4e98f2c3, 0x0712471e, 0x66d78334, 0x3dc7c396, 0x3bbb1298,
    0x010f0da2, 0x85bab8d1, 0x59fefa8d, 0xd15a0fca, 0xd70cc8d3, 0x1097605c, 0x840753f9, 0x3637dc45,
    0xdc4ca0c3, 0x2e747956, 0x2de69719, 0xc05d1489, 0x9cf67b52, 0xb99ef53b, 0x9995a5d3, 0x0dc2570a,
    0x1495c802, 0xa9774a44, 0x38eb53df, 0x3fdd1e27, 0x97d67c7e, 0x99a95a0b, 0xdc62aeb4, 0xeef47a4d,
    0xf858384a, 0x892a068b, 0x8db701ee, 0x51c7d15b, 0x72cdc84d, 0x2795bced, 0x16809770, 0xf87a55b1,
    0xb00415f2, 0x48d89cbb, 0x6e1e6d4a, 0x490c4aa2, 0x6a0f1b68, 0x87ec2e70, 0x711b19ec, 0x73627ed6,
    0x506b7032, 0xea06ceb3, 0xea2fba42, 0xc9207e1a, 0xfcc4bd7e, 0x76c7213c, 0x0f96c7be, 0x22382ca7,
    0x452f65c6, 0x025ddb1b, 0xed786ded, 0xd2ce7fc1, 0x1beb56fd, 0x49ef3d94, 0x875b3895, 0x6bbbc4eb,
    0xd819fb0f, 0x41ecff18, 0x6c4e3732, 0x4d79c763, 0x057a8cb7, 0x65f5d5d7, 0x0a62f4d1, 0x91fb4ff0,
    0xce40558d, 0x8725579b, 0xc4cb82e0, 0x1f512b79, 0xedd33521, 0xd2d07a93, 0xffe45f15, 0xf4a329a1,
    0xdb2e07df, 0x9bfe4404, 0x3cf10c02, 0xe6faf14e, 0xa214d894, 0x716462e9, 0x52fbf348, 0x406b3f85,
    0x3700b09c, 0x4c9dcc5f, 0x1a7b80c3, 0x75779bf9, 0x79ec8940, 0x645a067c, 0xb8cc2fff, 0x69ededba,
    0x9f271b10, 0xd4b83d70, 0x4cc7a4ab, 0xb8485ead, 0xcc4f8618, 0x288e9098, 0x010f145c, 0x58829246,
    0x3c5686df, 0xac1947d6, 0xb568b212, 0x9ecc1cfa, 0x3e1fcb57, 0x274efaa6, 0x33df8a43, 0x24dec957,
    0xb47874e9, 0xe1056877, 0x101fae54, 0x38b873ac, 0x3252e264, 0x08de955c, 0x061887b0, 0xd3d45e62,
    0x5907c7ec, 0x78ea8075, 0x7b2a8ddb, 0x56765f83, 0x9738fd72, 0x444102b0, 0xf38395ad, 0x76c43d1f,
    0xceef62a9, 0xea1e400b, 0x2c5128b3, 0x5b464615, 0x9fc79805, 0x342b4296, 0x72ed5453, 0xa6b2fa8b,
    0x940877fb, 0x6907f32a, 0xf85e07df, 0x91811bca, 0x10001456, 0x9e01351c, 0x931c1adf, 0x935b3384,
    0x33d8e10a, 0x6c4d8f83, 0xe1d9f0fe, 0x75436a65, 0x08f0c303, 0xe74a47bc, 0x50a70d00, 0x1f3d59ec,
    0x03d7085e, 0x84d67e08, 0x035966a0, 0xcd6b68f5, 0xe2f60f43, 0x0ac584eb, 0xd0d824ea, 0x990ae3f2,
    0xc8d4d510, 0xf1a911cc, 0xa75e4cc6, 0xdb22cbe7, 0xc6e80336, 0xea558d3f, 0x9e7764e6, 0xe58220a7,
    0xbe8a3466, 0x3dd8a5d8, 0x96f60419, 0xcc67c3df, 0x976c8aed, 0x75fe251f, 0x1f3494e7, 0x047a0cc1,
    0xd0139887, 0xa0e0d59b, 0x85aa8af0, 0x4cad9d67, 0x1207fc66, 0x18160ab8, 0xf5d332b6, 0x42bc439c,
    0x58b3cec7, 0x2fb83bd6, 0xb5dc3a54, 0xb304c080, 0x525d5ea3, 0x9fdc1854, 0x4423c882, 0x83a1b08f,
    0x723c5621, 0x17f9a34e, 0xff0b1d09, 0xb3fe468d, 0x634563fa, 0x2b21ce13, 0x3b32454c, 0x95f3d294,
    0x6263e5a6, 0x5c903158, 0xf2993d21, 0x1c9e4375, 0x95e84b60, 0xf2bf99e7, 0xe5d2224c, 0x8fef017c,
    0xaa26ddd9, 0x3b072dd1, 0x45f0c049, 0xad5cbef6, 0xeb57a1ca, 0xbeea54de, 0x7c3399e8, 0x85435448,
    0x0a082985, 0x7b20150f, 0x34d05866, 0x4096dc48, 0x6725d770, 0x6f1b7064, 0x7ae6b9bc, 0xd3a22b17,
    0x2c22f2a8, 0xd843d933, 0xbf9d57ba, 0x1d313acb, 0x518efdae, 0x42fcd0af, 0x1f1d3fac, 0x97756dee,
    0x87f34023, 0xda0d50ab, 0x274d0fbf, 0x0c5e6c09, 0x92ecfb04, 0x6245e537, 0xf9244569, 0x0e03b4a8,
    0x7aaf085f, 0x7712e0ca, 0x83a38805, 0x7a38d71d, 0x17cf40bb, 0x38ed9c2e, 0xa16fb1cc, 0x44d7a955,
    0xa63e1d93, 0xffbe5fb3, 0x17753072, 0x821f1b99, 0x5744356d, 0x2d3da976, 0x58036e7f, 0x90f61083,
    0x505e3090, 0xd17188de, 0x013eba65, 0x5f523c8b, 0x1aedbb43, 0x79e3e696, 0xe5f6f031, 0xc1ec26ab,
    0x28751cf2, 0xca18bded, 0xe130d6ca, 0x02b7cee7, 0xcf43faa5, 0x6bfabb78, 0x26ae26d1, 0x029bcbad,
    0x6580c914, 0x6e029320, 0x5fc0c9a7, 0x2e96333a, 0x8d6d12ce, 0xe75202f7, 0xa3fd0d64, 0x5741dc66,
    0x340f7c1b, 0x3f06f105, 0x506f23cc, 0x8095e324, 0x90f9de2e, 0x2c81cb47, 0x25c75120, 0x798daeb8,
    0x05c14bc5, 0x2d11adda, 0x8f4a43a1, 0x7b9b5c88, 0xaec569b5, 0x400a5f22, 0xf41f2ff1, 0x8275179b,
    0x41bea18e, 0xecb4ecd4, 0x6558e07b, 0xfe20668d, 0xe12f4033, 0xf2f76de2, 0xb4579ab5, 0x2ba812e4,
    0x0c10b92f, 0xe1e7427a, 0xfecc0a96, 0x3f9f86c7, 0x30dde2f8, 0x203d93e3, 0x78b1cc18, 0x4c2077ce,
    0x3dec7690, 0xc55683e3, 0xce2dd140, 0xce640791, 0xc7889629, 0x5e154684, 0xc3266122, 0x5dd17bc5,
    0xeeaba55f, 0xc9c7fc49, 0x395342d7, 0xa70b223c, 0x1d64e135, 0x05fff72a, 0x1cbad05f, 0x22dd2940,
    0x39ae766d, 0x6ee0de6e, 0x42ad5f43, 0x47b8140f, 0x63d07d7f, 0x372272bc, 0xc4261889, 0xaea7128a,
    0x61f4ae8b, 0x2bcf0631, 0x8ea101a4, 0x433b2f37, 0x379bb5e3, 0x97cf66bf, 0x7d0cb997, 0x6fb31baf,
    0x7b1e41eb, 0xd6fcbbb3, 0xbb3282bc, 0x4a04ccfa, 0xb01edf52, 0xfb581b81, 0x94342b63, 0xfce89aae,
    0xcbc79d36, 0x87d18eac, 0x9b101ef7, 0x1f0cef01, 0xdb1fd2f5, 0xc288bbe5, 0x3ae2d73e, 0x951f32d5,
    0xb9698b35, 0x8a7403ea, 0x7e1cce8e, 0x8a598d29, 0xb88bb5ae, 0x334a8582, 0x0566c4b8, 0x978696a2,
    0x0ce21905, 0x20135512, 0xb3e65937, 0x58d766ba, 0x728d8316, 0x83a82389, 0xcd6a9110, 0x825c6531,
    0x74bdeb89, 0x35190c71, 0x76983bd4, 0x405a36ad, 0x790873e2, 0xab3bcfd1, 0x29f947e4, 0x82ce595a,
    0x891649c2, 0x9b65ea1e, 0xb3b76bfb, 0x5ac0e9e4, 0x0b5411ef, 0x9d4a396b, 0x67493e04, 0x1c472780,
    0xb4f8a0cd, 0x0112d962, 0x9ed93a68, 0x16a43d9f, 0x5f4e44ee, 0x357d4bff, 0x7116242d, 0x793c6b2e,
    0xdaed8986, 0x62bd5f63, 0xa2532eb0, 0x0ac9480e, 0x27427e00, 0xf33e398b, 0x56cab9df, 0xd71f7085,
    0xfc0e2af3, 0x88282e62, 0xf9aa46d5, 0x695d490a, 0x8c37032a, 0x80b2e8bf, 0x97cf7580, 0xfd3ff1c6,
    0xfa4e0d1b, 0xe0b829a5, 0x4349dabe, 0x63027538, 0xe47f23cf, 0x9c6747ce, 0xf9d30111, 0x488ece3d,
    0x32709ec2, 0xbeee5839, 0x160715d8, 0x6f8c4031, 0x21024c34, 0x096925d2, 0x59c581e5, 0x52054a05,
    0x2367f5bc, 0xff6b9107, 0xd1e4d2bc, 0x176a3843, 0x3588ebb7, 0x12d0fbf9, 0x921271c3, 0xe91a7c99,
    0x6fee8997, 0x6e5352f2, 0x2fd6ecb9, 0x3bcd8c7d, 0x89d9a5fd, 0x6c667785, 0xcfd604f9, 0xb46f39d3,
    0xbeb862d4, 0x6db9f38a, 0xf92935b5, 0x25cdc961, 0xb80499e1, 0x181cd569, 0xad04601a, 0x274d9102,
    0x6f1f102b, 0xb07fc676, 0x6480d6de, 0x784d0e1a, 0x2a1c426d, 0xb24276e0, 0xc851ff52, 0xb3953cd9,
    0x34222a74, 0x721f116c, 0x5c576365, 0xda162562, 0x25de7459, 0x1715da83, 0xec8856cf, 0x8cfc2e9d,
    0x3fddf07b, 0x93fd1b0e, 0x43b91abd, 0x4785b4a4, 0xc036ee15, 0xf0053447, 0xf023023c, 0x773932c7,
    0x2c20d783, 0x7f02272d, 0x05d5fada, 0x6e6bbe98, 0xd4221673, 0xc167df9e, 0x474fdf35, 0x0ad626e9,
    0xe0d2e42c, 0x2dd3c14f, 0x377dfd8b, 0x2b6baa28, 0xec09c4a7, 0x1dbfab41, 0x76bf27b1, 0x3e1ac139,
    0xaa8825ca, 0xe096ab30, 0xdaeb7476, 0xd0aa3621, 0x6d467b2e, 0x5871551a, 0xc93ccf3d, 0x3078c9fc,
    0xfae04238, 0x86d771d5, 0xe3535698, 0x27058c28, 0x25fc0528, 0xc5ae89ce, 0x369dc912, 0xbddc397f,
    0x3ee17cf7, 0x159d2766, 0xb2c2e686, 0x704ebba3, 0x13ac874d, 0x39403468, 0xe3aa4a00, 0x5ee922a3,
    0x98383d99, 0x891b3825, 0x68487d79, 0x2696b5a0, 0x34a5d245, 0xc50db6cf, 0x7d47cc40, 0x090dc825,
    0x2ceb1d4b, 0xe0ae74a0, 0x822729aa, 0xf0e6ac94, 0x30ded6e0, 0xa3bcfd88, 0xdc0f8174, 0x9d5c7cdc,
    0x8819fd59, 0x616a9cf9, 0xcc0c5277, 0xed7f4ef9, 0x435627b1, 0x08f111be, 0x8dd3a1c1, 0x07b23b25,
    0xfac12ea3, 0x26178391, 0xceb16072, 0xc3413b63, 0xd7afce42, 0xbe405c7e, 0xe104f655, 0x8e277130,
    0x5ac38ceb, 0x6c1e5872, 0x90ee59dd, 0xc3b1edc9, 0xc3df0ee6, 0x6252ce1a, 0xca837261, 0x09b807fb,
    0x6449d108, 0x8993f74c, 0x5b5e45a4, 0x212ee503, 0x002b9acb, 0xd7eeea81, 0x6eb902c3, 0x6fef1213,
    0x24b32a28, 0x0fd67f1c, 0x44aed4d1, 0x5cb14e76, 0x59d5d2f4, 0x2c838659, 0xe3b48760, 0xe3db4d52,
    0x69c99259, 0xfb150669, 0xd9854e67, 0x4c1dfed5, 0xc492dec4, 0x245e8969, 0xad2ebb21, 0x03cab8c3,
    0x1d9c6d37, 0x27976dcd, 0xad3d8962, 0x316625cf, 0x885126f7, 0xc2af6263, 0xde9b6dbc, 0xde66022e,
    0x12b39152, 0x984b17ff, 0x38c20512, 0x13e02707, 0xb98d0663, 0xf958fc25, 0x117777b3, 0x66c3afb2,
    0x6af5f521, 0xd88715a9, 0x833a9ee8, 0x3e8a3911, 0x28ea297b, 0x27cd902d, 0xefafc04c, 0x85c3e74f,
    0x305a962b, 0x797680a5, 0xb065a7df, 0xc0315f46, 0x3c01da04, 0xf3d84cb3, 0xd8417dc6, 0x2be72b0c,
    0x865010ae, 0xdeb3ce1b, 0x05e6ee28, 0x49f75977, 0x643a949a, 0x40729c67, 0x5ac35c8a, 0x4bd69299,
    0x48482b14, 0x232012ec, 0x3bf37c15, 0x94838756, 0x1f5b516f, 0x2a46d273, 0x18b02e18, 0xa993a48f,
    0x076f6ac8, 0x4b9383c7, 0x9736a641, 0x4ee85678, 0xbfa77340, 0x2e300ee3, 0xb6a555ec, 0x1d6b6caa,
    0xba95044d, 0xe66da238, 0x309c4988, 0x0c8da434, 0x6444867a, 0x3fb0018e, 0x43c0a60e, 0x08db737d,
    0x59fbee24, 0x009a2a90, 0xfd133276, 0xf5b19b18, 0x55510917, 0x4e046423, 0x5d01c2b5, 0xbf07f799,
    0x72e4bd65, 0x29b7221f, 0x9fc554a5, 0xee892f9d, 0xd2b92856, 0x16c239ba, 0x974fcc8d, 0xd5b88f4b,
    0x9f9e2891, 0x97f3cd42, 0xc5ade759, 0xe223d875, 0x84100977, 0xbbba97ed, 0xcfdab6c2, 0xed8c433a,
    0xba053b97, 0x9c722054, 0x59c79cc7, 0x66d3d9ba, 0xc67d660a, 0x992dade9, 0x652b4358, 0xf532470e,
    0x1027e4c5, 0x6f13fb18, 0x716e42ac, 0x3f3d528c, 0x32f7f85c, 0x5736eae7, 0xe4273836, 0xfa772382,
    0x73487d1c, 0x74f145e4, 0xe886c3fe, 0xca8c1322, 0xafcb9ad8, 0x93c8d0c8, 0xab916a02, 0x8358c19e,
    0x31b22fbd, 0x45f3d16c, 0x89fd7d9f, 0x05b6cf46, 0xd01c0f1d, 0x1a7acc3b, 0x3bac6c1e, 0x1eff9f30,
    0xb7e40fbb, 0xd81d6908, 0xdf190fb4, 0x754fbbcd, 0x50c487c9, 0x1ad8c99f, 0x0614c6da, 0x0194dafe,
    0x8a87fe19, 0xcb775138, 0x8964b059, 0xa0dcaf2d, 0x79b9fc22, 0x078f7d5c, 0xb2ba8416, 0xaa9bfebe,
    0x8097ff69, 0xc82782e4, 0xe65f27cd, 0xd680859c, 0xf87c5cd1, 0xda048c6a, 0xd80afd59, 0x91b9adbc,
    0xa1be1d5b, 0x944b2eeb, 0xf399afa6, 0x3a71b733, 0x8804bfed, 0xddc42449, 0x15923fb0, 0x07c741c4,
    0x56810265, 0xe09f9613, 0x41f44afe, 0xcb8c7820, 0x9a8f361a, 0x9db484ea, 0xd573af56, 0xca3bdb4e,
    0x3bd20a3f, 0x0ea4df10, 0x154d7bba, 0x3a0dd671, 0x359559b3, 0x0c13ca8f, 0x304ab6ba, 0x7f4779cd,
    0xd8f387ea, 0x22273b99, 0xc93fc073, 0x60095293, 0x260da785, 0x56bc27bd, 0x7dbf4904, 0x5b166100,
    0xacfa0f71, 0xfdac6833, 0x69a0d81c, 0xd9f30e07, 0x6c36be80, 0x7d504574, 0xf661fc47, 0x05a1f18c,
    0x346d5435, 0xba407c9d, 0x0adbebc0, 0x8c0f9a21, 0xbef41db3, 0x9ceeeb16, 0xdaa9087f, 0x7f0de503,
    0x21b61f61, 0xda381d35, 0x58f2eb29, 0xedf3f4ec, 0x13c46925, 0x92ad2466, 0x98900eeb, 0xe203b680,
    0x586131df, 0xee95fc07, 0xe5ec24e1, 0x83df268c, 0x0f14e2cd, 0x4dd43a8c, 0x6d04398a, 0xd13056cc,
    0xcc19f366, 0x7e79d5ce, 0x12fe644b, 0x248a7d7c, 0x1ed3219b, 0x87090e76, 0x25a2e093, 0xdefe7342,
    0x0808e818, 0x0b354f70, 0x751e09b2, 0xbc67985e, 0x2f524a71, 0xfdefea01, 0xd4c0be3e, 0x706547bb,
    0xc1d6893c, 0xb5de2dac, 0x2e4eb649, 0x72c7d552, 0x4d44153f, 0xf05ac448, 0x61f99c5d, 0xf7b2eb92,
    0x86f421b8, 0x9d076216, 0xa4953930, 0xa3f2ac40, 0x65d56af2, 0x8d35a03a, 0xf28598c8, 0xab7520d3,
    0xa17a7335, 0xf33fb253, 0x90701ac0, 0x6caa6b62, 0xd7c7d22c, 0x34948c7f, 0x774573a9, 0x2f738920,
    0xd1adec4a, 0x8d66e134, 0x09d11d94, 0x2ca901a8, 0xc0cb9dfb, 0x01bda2c3, 0x2c130096, 0x1ce14740,
    0x3bee8e14, 0x7633b70d, 0xe183fb4d, 0x7b253ec7, 0x1d867c51, 0x54c30a9f, 0xf381c4f0, 0x6f5442a3,
    0x4e76a33f, 0xf54c64dd, 0x3d466a36, 0x9ac7669b, 0x057e350d, 0x51a3cacc, 0x5243f230, 0x9f0d8afa,
    0x0b2e0705, 0x1b59b489, 0x6fb9739a, 0x3acda9ff, 0xc255d659, 0x52c0ffda, 0x0bded84d, 0x084da8fe,
    0xb32731b3, 0xfcad050d, 0xf8ea31df, 0x4c7227f9, 0xb0c9f210, 0x44087082, 0x29efc8b4, 0x32c32bc9,
    0xd4a85a78, 0x5d86d91c, 0x03d016d5, 0xd43890df, 0xbf7eee9f, 0xce929349, 0x8eda7e2f, 0x495a7269,
    0x9312866a, 0x6296f2b1, 0xc71cb01d, 0x1b58d91e, 0x2f508508, 0xf5adc215, 0xbf89b19d, 0x46336c00,
    0x08f5e824, 0x5b59eb9e, 0xcd902419, 0x868f3d4f, 0x9a40157d, 0xed008716, 0x5a7b50dd, 0xa12b3588,
    0x03373f51, 0xc7642af3, 0xd61cb848, 0x5a28fce5, 0xd995c64d, 0x91a7d1b6, 0x3fa40626, 0x849e0052,
    0x158c239f, 0x0b517ded, 0xf5649ba8, 0xf7d707b3, 0x55e8d0e9, 0xb7370bb6, 0xf4dcf7a6, 0x06e84617,
    0x53707c64, 0x5ab6f9c6, 0xa884538c, 0x95f29cf1, 0x8629b12e, 0x832761c7, 0x0931b4ac, 0xe7199d4a,
    0x4e8a4163, 0x18139ae7, 0x4e0b9934, 0x3fc49ace, 0xddd1280c, 0xa92cdf3f, 0xe2312b0d, 0x81dc7251,
    0xe5f2714c, 0x376fae23, 0x47eb3a41, 0xebff724e, 0x3b74d769, 0x7053b0fb, 0xa79044f6, 0x1eb96ddb,
    0xa26ed730, 0x3b577027, 0x60080154, 0x911406a1, 0x5e9d0b50, 0x52d3eaa3, 0xaaa59155, 0xd0ec569d,
    0x01c11b28, 0xf5a4926a, 0x791fb02a, 0xb06bfd28, 0xa45dbd6c, 0x31bdb345, 0x9c3994a9, 0x54dd20b6,
    0x83f77540, 0xd7e53766, 0x784cb5fc, 0x41be7973, 0xf8a8b10b,
];

const MLDSA_SEED: [u32; 8] = [
    0x2d5cf89c, 0x46768a85, 0x0768f0d4, 0xa243fe28, 0x3fcee4d5, 0x37071d12, 0x675fd127, 0x9340000a,
];

const KEY_ID: KeyId = KeyId::KeyId1;

fn test_gen_key_pair() {
    let mut trng = unsafe {
        Trng::new(
            CsrngReg::new(),
            EntropySrcReg::new(),
            SocIfcTrngReg::new(),
            &SocIfcReg::new(),
        )
        .unwrap()
    };
    let mut entropy_gen = || trng.generate4();

    // This needs to happen in the first test
    CfiCounter::reset(&mut entropy_gen);

    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    let mut hmac = unsafe { Hmac::new(HmacReg::new()) };
    let key_out_1 = KeyWriteArgs {
        id: KEY_ID,
        usage: KeyUsage::default().set_mldsa_key_gen_seed_en(),
    };

    hmac.hmac(
        &HmacKey::from(&Array4x12::default()),
        &HmacData::from(&[0]),
        &mut trng,
        HmacTag::Key(key_out_1),
        HmacMode::Hmac384,
    )
    .unwrap();

    let public_key = ml_dsa87
        .key_pair(&Mldsa87Seed::Key(KeyReadArgs::new(KEY_ID)), &mut trng, None)
        .unwrap();
    assert_eq!(public_key, Mldsa87PubKey::from(PUBKEY));
}

fn test_sign() {
    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    let mut trng = unsafe {
        Trng::new(
            CsrngReg::new(),
            EntropySrcReg::new(),
            SocIfcTrngReg::new(),
            &SocIfcReg::new(),
        )
        .unwrap()
    };

    let sign_rnd = Mldsa87SignRnd::default(); // Deterministic signing

    let signature = ml_dsa87
        .sign(
            &Mldsa87Seed::Key(KeyReadArgs::new(KEY_ID)),
            &Mldsa87PubKey::from(PUBKEY), // Reuse SEED
            &MESSAGE.into(),
            &sign_rnd,
            &mut trng,
        )
        .unwrap();

    assert_eq!(signature, Mldsa87Signature::from(SIGNATURE));
}

fn test_sign_caller_provided_private_key() {
    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    let mut trng = unsafe {
        Trng::new(
            CsrngReg::new(),
            EntropySrcReg::new(),
            SocIfcTrngReg::new(),
            &SocIfcReg::new(),
        )
        .unwrap()
    };

    let sign_rnd = Mldsa87SignRnd::default(); // Deterministic signing

    let signature = ml_dsa87
        .sign(
            &Mldsa87Seed::PrivKey(&Mldsa87PrivKey::from(MLDSA_PRIVKEY)),
            &Mldsa87PubKey::from(MLDSA_PUBKEY),
            &MLDSA_MSG.into(),
            &sign_rnd,
            &mut trng,
        )
        .unwrap();

    assert_eq!(signature, Mldsa87Signature::from(MLDSA_SIGN));
}

fn test_keygen_caller_provided_seed() {
    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    let mut trng = unsafe {
        Trng::new(
            CsrngReg::new(),
            EntropySrcReg::new(),
            SocIfcTrngReg::new(),
            &SocIfcReg::new(),
        )
        .unwrap()
    };

    let sign_rnd = Mldsa87SignRnd::default(); // Deterministic signing

    let signature = ml_dsa87
        .sign(
            &Mldsa87Seed::Array4x8(&Array4x8::from(MLDSA_SEED)),
            &Mldsa87PubKey::from(MLDSA_PUBKEY),
            &MLDSA_MSG.into(),
            &sign_rnd,
            &mut trng,
        )
        .unwrap();

    assert_eq!(signature, Mldsa87Signature::from(MLDSA_SIGN));
}

fn test_verify() {
    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    assert_eq!(
        ml_dsa87
            .verify(
                &Mldsa87PubKey::from(PUBKEY),
                &MESSAGE.into(),
                &Mldsa87Signature::from(SIGNATURE)
            )
            .unwrap(),
        Mldsa87Result::Success
    );
}

fn test_verify_failure() {
    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    let msg = Mldsa87Msg::from([0xff; 64]);

    assert_eq!(
        ml_dsa87
            .verify(
                &Mldsa87PubKey::from(PUBKEY),
                &msg,
                &Mldsa87Signature::from(SIGNATURE)
            )
            .unwrap(),
        Mldsa87Result::SigVerifyFailed
    );
}

test_suite! {
    test_gen_key_pair,
    test_sign,
    test_sign_caller_provided_private_key,
    test_keygen_caller_provided_seed,
    test_verify,
    test_verify_failure,
}
