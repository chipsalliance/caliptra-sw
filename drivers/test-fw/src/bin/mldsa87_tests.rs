/*++

Licensed under the Apache-2.0 license.

File Name:

    ml_dsa87_tests.rs

Abstract:

    File contains test cases for ML_DSA87 API tests

--*/

#![no_std]
#![no_main]

use caliptra_cfi_lib::CfiCounter;
use caliptra_drivers::{
    Array4x12, Hmac, HmacData, HmacKey, HmacMode, HmacTag, KeyId, KeyReadArgs, KeyUsage,
    KeyWriteArgs, Mldsa87, Mldsa87Msg, Mldsa87PubKey, Mldsa87Result, Mldsa87SignRnd,
    Mldsa87Signature, Trng,
};
use caliptra_registers::csrng::CsrngReg;
use caliptra_registers::entropy_src::EntropySrcReg;
use caliptra_registers::hmac::HmacReg;
use caliptra_registers::mldsa::MldsaReg;
use caliptra_registers::soc_ifc::SocIfcReg;
use caliptra_registers::soc_ifc_trng::SocIfcTrngReg;
use caliptra_test_harness::test_suite;

const PUBKEY: [u8; 2592] = [
    224, 217, 202, 251, 63, 165, 133, 179, 239, 212, 52, 79, 220, 130, 145, 6, 113, 142, 173, 45,
    182, 254, 61, 182, 184, 58, 92, 63, 249, 128, 206, 26, 190, 171, 238, 150, 191, 142, 113, 52,
    52, 4, 216, 39, 10, 179, 202, 168, 193, 157, 99, 194, 144, 71, 194, 210, 188, 54, 54, 18, 234,
    209, 162, 120, 98, 208, 155, 103, 75, 21, 123, 79, 226, 17, 74, 247, 21, 96, 140, 112, 133,
    195, 33, 117, 46, 29, 156, 31, 66, 124, 106, 81, 49, 108, 49, 236, 219, 49, 166, 221, 165, 186,
    101, 149, 232, 121, 72, 103, 226, 59, 208, 128, 255, 189, 172, 199, 73, 140, 43, 116, 240, 77,
    134, 249, 38, 178, 23, 38, 254, 237, 56, 41, 236, 19, 47, 135, 221, 49, 86, 232, 151, 102, 135,
    126, 24, 79, 178, 195, 168, 33, 117, 36, 12, 8, 111, 161, 59, 178, 50, 48, 46, 219, 101, 76,
    112, 248, 43, 220, 244, 87, 251, 224, 40, 160, 145, 202, 134, 84, 147, 223, 106, 99, 156, 108,
    252, 217, 172, 190, 209, 176, 175, 82, 187, 78, 119, 86, 62, 217, 149, 102, 246, 82, 146, 7,
    222, 132, 170, 49, 101, 140, 181, 154, 124, 209, 242, 238, 232, 6, 132, 112, 199, 41, 54, 243,
    182, 200, 233, 194, 4, 174, 161, 236, 27, 229, 91, 236, 246, 245, 218, 246, 82, 88, 86, 163,
    162, 54, 214, 43, 252, 164, 119, 81, 1, 169, 237, 236, 187, 89, 108, 76, 40, 79, 191, 70, 230,
    70, 122, 187, 192, 225, 31, 249, 42, 208, 213, 121, 210, 231, 200, 165, 67, 198, 109, 98, 197,
    211, 122, 62, 42, 23, 232, 211, 18, 221, 199, 25, 86, 119, 164, 173, 184, 209, 166, 216, 70,
    51, 38, 86, 133, 226, 175, 101, 167, 66, 45, 153, 147, 252, 227, 215, 192, 191, 121, 207, 66,
    122, 237, 126, 25, 48, 245, 84, 15, 154, 221, 40, 155, 170, 185, 11, 3, 34, 134, 52, 6, 46, 54,
    249, 83, 72, 89, 215, 189, 55, 253, 40, 164, 189, 138, 41, 60, 224, 52, 200, 191, 16, 125, 55,
    14, 102, 59, 74, 237, 169, 83, 208, 177, 222, 149, 121, 226, 254, 157, 56, 63, 251, 140, 220,
    233, 32, 238, 242, 131, 126, 23, 106, 80, 169, 153, 167, 67, 72, 202, 171, 11, 19, 86, 130, 19,
    112, 34, 1, 35, 58, 2, 58, 86, 141, 178, 34, 223, 39, 236, 57, 227, 69, 194, 229, 209, 7, 14,
    63, 244, 235, 147, 32, 51, 99, 229, 102, 95, 89, 218, 104, 93, 152, 19, 245, 60, 214, 134, 123,
    4, 134, 69, 255, 31, 12, 49, 171, 97, 249, 171, 130, 69, 227, 157, 155, 45, 182, 200, 1, 101,
    187, 84, 44, 127, 150, 95, 106, 15, 234, 102, 20, 218, 48, 24, 192, 246, 67, 112, 67, 55, 243,
    145, 202, 30, 238, 0, 102, 30, 218, 192, 16, 74, 155, 183, 70, 116, 46, 100, 36, 159, 226, 232,
    30, 12, 99, 101, 162, 113, 145, 223, 144, 200, 219, 20, 164, 119, 175, 85, 84, 89, 30, 180, 7,
    113, 214, 227, 106, 77, 194, 51, 7, 161, 235, 95, 70, 106, 57, 248, 32, 18, 154, 74, 6, 64,
    217, 71, 183, 205, 235, 201, 178, 20, 47, 187, 231, 69, 20, 15, 123, 56, 254, 199, 45, 207,
    135, 33, 67, 2, 237, 169, 152, 67, 252, 44, 153, 177, 199, 70, 232, 89, 10, 111, 218, 225, 171,
    155, 42, 132, 71, 53, 45, 198, 202, 247, 34, 206, 22, 42, 223, 111, 46, 152, 158, 159, 67, 98,
    174, 71, 207, 12, 131, 78, 221, 45, 233, 116, 139, 245, 154, 118, 208, 0, 98, 111, 122, 3, 68,
    36, 163, 104, 55, 149, 230, 77, 200, 52, 235, 121, 55, 172, 115, 102, 245, 142, 206, 20, 83,
    242, 57, 154, 97, 99, 68, 155, 250, 180, 91, 170, 71, 177, 143, 115, 192, 238, 91, 133, 91, 80,
    164, 72, 173, 121, 68, 139, 121, 219, 32, 111, 165, 121, 92, 48, 134, 183, 71, 243, 190, 239,
    24, 195, 44, 231, 255, 88, 52, 52, 37, 55, 104, 103, 74, 216, 168, 248, 90, 89, 66, 54, 29,
    134, 65, 228, 220, 46, 34, 168, 85, 83, 236, 239, 231, 126, 173, 232, 222, 98, 116, 158, 207,
    98, 243, 211, 197, 168, 189, 204, 245, 73, 158, 193, 227, 88, 184, 184, 191, 56, 72, 156, 252,
    193, 185, 99, 79, 211, 189, 208, 17, 237, 35, 93, 215, 226, 73, 8, 28, 67, 137, 35, 72, 19, 52,
    206, 48, 27, 82, 205, 152, 75, 218, 100, 74, 135, 139, 158, 181, 167, 146, 122, 92, 159, 61,
    218, 250, 253, 95, 206, 143, 235, 147, 86, 205, 16, 137, 8, 163, 189, 109, 66, 100, 153, 62,
    135, 112, 244, 15, 35, 251, 91, 71, 203, 185, 100, 102, 135, 97, 234, 222, 248, 221, 0, 80, 25,
    64, 109, 253, 33, 92, 205, 97, 55, 193, 247, 227, 63, 177, 203, 128, 134, 9, 75, 126, 250, 107,
    123, 167, 146, 172, 16, 87, 47, 145, 179, 58, 11, 225, 114, 149, 249, 121, 232, 2, 14, 18, 59,
    219, 116, 248, 165, 73, 163, 28, 210, 58, 250, 232, 167, 147, 78, 244, 224, 201, 76, 73, 70,
    218, 204, 205, 233, 94, 123, 173, 103, 13, 42, 130, 169, 195, 156, 59, 180, 185, 66, 246, 150,
    149, 91, 23, 133, 255, 217, 18, 145, 123, 195, 100, 106, 25, 1, 64, 242, 207, 109, 140, 209,
    23, 31, 17, 211, 140, 169, 140, 212, 178, 224, 116, 121, 12, 221, 4, 225, 53, 28, 127, 53, 177,
    35, 46, 213, 193, 197, 50, 34, 113, 212, 65, 73, 16, 7, 137, 89, 114, 49, 0, 82, 216, 147, 164,
    79, 13, 144, 242, 102, 205, 46, 231, 233, 217, 120, 134, 78, 213, 194, 244, 148, 13, 13, 242,
    202, 109, 171, 231, 61, 94, 100, 107, 70, 210, 143, 35, 172, 186, 120, 190, 190, 187, 171, 242,
    181, 12, 22, 39, 183, 125, 218, 142, 186, 110, 138, 163, 19, 141, 16, 143, 162, 214, 238, 209,
    29, 33, 91, 29, 152, 235, 212, 118, 132, 139, 230, 26, 148, 19, 101, 202, 227, 231, 59, 189,
    164, 3, 86, 140, 125, 223, 70, 134, 153, 217, 50, 48, 161, 84, 148, 46, 180, 189, 53, 213, 83,
    181, 249, 208, 106, 247, 189, 9, 114, 91, 74, 219, 134, 15, 57, 125, 228, 89, 97, 139, 70, 159,
    145, 182, 89, 63, 70, 196, 251, 247, 244, 166, 60, 20, 253, 133, 78, 218, 125, 66, 241, 8, 49,
    222, 146, 200, 201, 217, 214, 90, 206, 209, 42, 151, 31, 68, 191, 165, 113, 183, 173, 112, 3,
    115, 193, 243, 85, 132, 152, 77, 211, 138, 243, 58, 131, 51, 49, 35, 109, 171, 105, 194, 134,
    6, 154, 97, 155, 98, 145, 53, 244, 175, 11, 79, 207, 108, 50, 192, 205, 48, 12, 208, 77, 78,
    47, 243, 188, 177, 196, 50, 223, 188, 207, 249, 153, 44, 42, 180, 159, 66, 147, 252, 148, 56,
    127, 140, 67, 32, 168, 124, 194, 19, 106, 56, 46, 51, 51, 202, 191, 34, 208, 214, 169, 23, 93,
    165, 26, 232, 199, 89, 111, 48, 72, 185, 251, 82, 215, 49, 204, 159, 151, 170, 64, 183, 120,
    248, 46, 110, 223, 199, 135, 236, 215, 90, 82, 185, 81, 90, 17, 143, 104, 153, 123, 27, 107,
    178, 47, 126, 19, 184, 199, 172, 138, 135, 3, 225, 240, 109, 78, 185, 141, 215, 141, 85, 191,
    105, 228, 86, 161, 113, 138, 38, 76, 111, 178, 148, 60, 72, 185, 191, 83, 52, 142, 212, 145,
    19, 64, 124, 27, 115, 167, 30, 2, 25, 109, 148, 64, 184, 158, 123, 145, 117, 68, 81, 95, 165,
    248, 27, 6, 39, 133, 139, 154, 161, 7, 50, 18, 93, 135, 239, 231, 29, 54, 117, 93, 251, 173,
    90, 27, 38, 238, 98, 243, 210, 187, 30, 41, 110, 10, 154, 219, 191, 128, 253, 231, 24, 44, 248,
    101, 99, 45, 225, 60, 107, 8, 231, 146, 145, 163, 120, 82, 146, 120, 165, 89, 56, 24, 15, 233,
    21, 236, 238, 145, 147, 168, 187, 28, 209, 111, 99, 92, 103, 236, 12, 157, 197, 31, 174, 126,
    53, 67, 190, 115, 243, 40, 253, 64, 186, 8, 222, 145, 172, 196, 35, 37, 27, 26, 139, 214, 131,
    159, 225, 229, 206, 170, 151, 184, 22, 98, 134, 128, 205, 80, 184, 40, 108, 164, 76, 145, 23,
    180, 61, 221, 182, 115, 187, 9, 207, 143, 46, 169, 242, 128, 36, 176, 223, 237, 15, 87, 109,
    52, 69, 96, 27, 217, 190, 109, 144, 101, 167, 196, 92, 122, 117, 70, 57, 78, 101, 239, 129,
    102, 238, 113, 137, 190, 172, 100, 221, 91, 68, 245, 230, 246, 97, 98, 6, 224, 152, 152, 46,
    154, 38, 36, 45, 215, 1, 77, 222, 83, 55, 197, 62, 52, 172, 202, 83, 209, 181, 37, 5, 176, 109,
    65, 137, 183, 20, 237, 168, 209, 19, 140, 46, 224, 183, 19, 239, 237, 163, 191, 221, 130, 98,
    208, 151, 159, 59, 75, 201, 42, 182, 198, 171, 28, 63, 1, 167, 8, 212, 104, 62, 120, 199, 216,
    220, 198, 160, 25, 127, 73, 84, 119, 186, 31, 195, 11, 29, 110, 116, 232, 239, 148, 243, 76,
    212, 166, 105, 1, 138, 28, 189, 98, 130, 118, 171, 20, 82, 238, 246, 132, 51, 147, 210, 220,
    249, 7, 72, 205, 164, 179, 217, 85, 175, 222, 85, 210, 230, 89, 151, 39, 69, 210, 124, 243,
    225, 171, 56, 204, 247, 29, 112, 149, 59, 214, 178, 11, 14, 151, 132, 43, 192, 48, 152, 62, 57,
    209, 104, 117, 74, 6, 126, 67, 63, 147, 94, 160, 64, 20, 4, 31, 216, 129, 180, 197, 190, 25,
    46, 146, 116, 56, 120, 124, 226, 144, 82, 23, 197, 101, 132, 119, 106, 164, 191, 201, 196, 167,
    212, 141, 15, 22, 151, 43, 169, 101, 152, 202, 190, 141, 171, 173, 82, 215, 113, 1, 253, 8, 15,
    30, 49, 46, 60, 42, 122, 175, 230, 11, 108, 6, 160, 64, 201, 72, 247, 214, 211, 170, 29, 182,
    32, 247, 63, 80, 133, 130, 118, 249, 9, 137, 185, 243, 44, 191, 121, 16, 8, 184, 231, 54, 92,
    178, 41, 223, 0, 48, 232, 12, 253, 191, 104, 39, 235, 122, 7, 189, 77, 50, 207, 189, 76, 13,
    172, 138, 15, 83, 121, 37, 163, 110, 42, 155, 211, 41, 238, 24, 190, 240, 197, 42, 35, 65, 218,
    56, 185, 114, 174, 86, 213, 117, 250, 182, 55, 44, 85, 109, 42, 124, 59, 101, 174, 210, 166,
    81, 170, 179, 105, 236, 142, 166, 8, 243, 13, 57, 209, 162, 64, 188, 142, 144, 237, 171, 157,
    219, 245, 2, 93, 228, 112, 226, 202, 143, 211, 14, 107, 194, 244, 150, 49, 122, 78, 111, 78,
    18, 234, 225, 106, 60, 178, 42, 72, 85, 19, 157, 54, 201, 211, 54, 61, 77, 93, 31, 158, 218,
    124, 199, 141, 30, 112, 84, 245, 135, 176, 219, 26, 215, 240, 97, 196, 21, 1, 55, 141, 19, 153,
    80, 147, 195, 103, 211, 21, 91, 132, 8, 11, 157, 73, 209, 45, 67, 177, 124, 219, 233, 119, 84,
    196, 52, 141, 155, 225, 249, 39, 70, 235, 206, 89, 238, 171, 136, 142, 106, 155, 63, 127, 240,
    1, 33, 121, 147, 222, 100, 8, 140, 82, 115, 77, 143, 5, 222, 244, 79, 71, 167, 55, 194, 12, 27,
    155, 15, 102, 90, 231, 77, 199, 136, 10, 87, 133, 166, 118, 211, 239, 161, 132, 149, 57, 120,
    196, 121, 131, 243, 139, 78, 213, 41, 235, 175, 16, 179, 225, 225, 73, 7, 238, 105, 184, 250,
    74, 190, 228, 21, 188, 14, 120, 163, 20, 34, 9, 195, 194, 233, 149, 98, 35, 179, 116, 164, 79,
    212, 251, 219, 133, 125, 83, 94, 194, 144, 9, 113, 78, 193, 184, 36, 80, 115, 242, 168, 86,
    212, 225, 119, 62, 173, 237, 42, 247, 42, 125, 90, 140, 5, 87, 168, 209, 221, 1, 92, 183, 209,
    73, 56, 167, 177, 18, 45, 44, 85, 204, 59, 121, 101, 206, 230, 25, 186, 95, 199, 161, 141, 235,
    152, 156, 47, 99, 26, 223, 2, 168, 92, 198, 126, 132, 255, 26, 88, 168, 30, 75, 59, 157, 84,
    12, 77, 127, 166, 106, 226, 49, 149, 82, 13, 95, 188, 171, 244, 191, 58, 255, 165, 251, 128,
    143, 190, 18, 149, 141, 129, 186, 70, 195, 0, 123, 19, 45, 42, 108, 162, 246, 90, 112, 82, 163,
    163, 173, 59, 101, 201, 241, 243, 182, 135, 6, 168, 78, 168, 66, 15, 191, 37, 10, 150, 19, 72,
    188, 88, 173, 163, 164, 182, 219, 154, 120, 238, 173, 19, 242, 176, 199, 16, 4, 48, 149, 124,
    95, 77, 234, 75, 115, 106, 144, 34, 184, 68, 119, 151, 122, 10, 91, 69, 51, 34, 236, 157, 221,
    209, 5, 94, 137, 74, 80, 35, 54, 14, 48, 202, 231, 16, 99, 227, 214, 155, 51, 129, 173, 10,
    128, 235, 62, 59, 98, 84, 198, 22, 203, 126, 109, 123, 95, 13, 173, 169, 7, 150, 2, 240, 240,
    183, 39, 212, 153, 149, 175, 17, 28, 160, 199, 53, 224, 0, 205, 179, 144, 16, 243, 226, 183,
    176, 155, 75, 209, 180, 161, 12, 80, 42, 101, 222, 188, 108, 207, 117, 105, 10, 96, 240, 166,
    89, 160, 101, 27, 137, 43, 5, 156, 160, 168, 32, 58, 89, 81, 82, 11, 62, 75, 254, 34, 174, 79,
    113, 83, 30, 172, 103, 59, 197, 145, 61, 231, 49, 184, 188, 211, 185, 13, 194, 168, 99, 92,
    113, 36, 143, 100, 155, 128, 13, 85, 81, 240, 183, 156, 232, 49, 164, 157, 141, 113, 102, 148,
    170, 34, 252, 128, 245, 48, 245, 218, 95, 234, 253, 71, 124, 174, 233, 191, 135, 127, 72, 133,
    86, 134, 118, 102, 126, 214, 70, 20, 149, 167, 187, 236, 97, 0, 95, 63, 160, 103, 123, 61, 100,
    191, 203, 217, 187, 173, 243, 72, 251, 56, 252, 88, 136, 180, 59, 155, 181, 106, 1, 114, 101,
    159, 229, 30, 74, 201, 195, 202, 6, 188, 101, 133, 242, 105, 98, 119, 135, 215, 61, 160, 31,
    157, 130, 229, 90, 64, 4, 202, 246, 90, 143, 191, 31, 127, 77, 49, 203, 250, 207, 123, 68, 95,
    200, 107, 47, 184, 21, 178, 228, 227, 26, 6, 163, 184, 159, 106, 11, 23, 83, 201, 99, 206, 57,
    54, 188, 58, 36, 137, 146, 181, 21, 79, 104, 139, 82, 105, 77, 147, 82, 12, 144, 20, 192, 93,
    59, 235, 68, 235, 111, 126, 188, 222, 59, 181, 30, 62, 204, 66, 139, 95, 105, 74, 217, 25, 211,
    91, 207, 158, 75, 140, 141, 206, 67, 77, 20, 113, 45, 191, 155, 255, 184, 53, 205, 68, 94, 202,
    108, 53, 1, 24, 245, 194, 7, 0, 24, 49, 15, 124, 96, 12, 156, 211, 72, 68, 196, 143, 242, 95,
    171, 47, 82, 94, 45, 43, 50, 238, 91, 212, 161, 249, 205, 242, 147, 109, 50, 208,
];

const SIGNATURE: [u8; 4628] = [
    168, 148, 210, 211, 222, 17, 152, 141, 6, 8, 63, 104, 100, 134, 147, 151, 42, 28, 10, 203, 2,
    96, 62, 253, 222, 230, 203, 224, 182, 214, 28, 125, 62, 13, 150, 153, 183, 47, 165, 242, 64,
    226, 70, 164, 229, 219, 61, 139, 231, 163, 172, 163, 156, 209, 220, 93, 238, 185, 251, 11, 130,
    158, 187, 14, 173, 81, 219, 63, 166, 119, 130, 58, 101, 187, 102, 1, 184, 182, 99, 126, 73,
    226, 202, 197, 104, 151, 109, 91, 69, 120, 139, 167, 127, 32, 32, 149, 176, 17, 111, 232, 133,
    232, 6, 34, 95, 96, 166, 88, 174, 16, 204, 233, 65, 51, 115, 61, 36, 238, 46, 131, 29, 92, 183,
    243, 58, 203, 46, 113, 98, 204, 160, 163, 178, 240, 192, 166, 106, 30, 207, 122, 106, 251, 151,
    96, 5, 97, 99, 66, 32, 235, 172, 85, 138, 102, 50, 10, 227, 19, 22, 242, 32, 145, 169, 44, 70,
    15, 107, 228, 233, 162, 245, 83, 168, 17, 49, 121, 250, 171, 52, 160, 158, 195, 23, 83, 227,
    12, 146, 210, 219, 141, 12, 5, 189, 120, 97, 53, 149, 94, 196, 78, 246, 212, 33, 77, 103, 212,
    102, 171, 221, 31, 112, 219, 35, 95, 212, 54, 129, 251, 242, 106, 69, 165, 98, 201, 212, 23,
    80, 162, 215, 213, 234, 208, 241, 186, 105, 30, 222, 82, 35, 69, 212, 94, 121, 250, 71, 211,
    28, 205, 53, 120, 42, 44, 219, 141, 137, 4, 147, 203, 215, 250, 99, 191, 209, 193, 188, 161,
    105, 136, 17, 164, 146, 116, 235, 105, 20, 51, 182, 105, 112, 7, 228, 88, 244, 94, 87, 174, 11,
    249, 156, 105, 73, 73, 143, 72, 35, 133, 98, 120, 95, 45, 194, 37, 45, 79, 181, 252, 108, 52,
    110, 132, 166, 50, 68, 197, 6, 228, 169, 125, 69, 190, 181, 196, 57, 57, 106, 197, 22, 95, 53,
    67, 218, 146, 234, 198, 115, 148, 112, 207, 72, 188, 181, 34, 50, 240, 63, 228, 44, 94, 124,
    205, 80, 189, 100, 243, 96, 148, 241, 132, 171, 55, 62, 99, 95, 186, 254, 113, 79, 227, 236,
    73, 82, 42, 97, 55, 154, 55, 8, 70, 235, 157, 27, 12, 161, 234, 6, 168, 78, 49, 214, 162, 154,
    52, 194, 198, 78, 226, 77, 128, 73, 151, 191, 29, 54, 109, 76, 116, 81, 19, 225, 188, 62, 125,
    43, 65, 48, 21, 19, 47, 93, 76, 29, 79, 63, 169, 194, 182, 158, 229, 234, 75, 239, 138, 203,
    150, 86, 8, 241, 113, 169, 223, 51, 119, 214, 160, 154, 30, 200, 241, 133, 2, 226, 50, 118,
    126, 97, 136, 1, 170, 185, 51, 77, 254, 6, 128, 214, 64, 57, 31, 217, 84, 57, 126, 145, 181,
    46, 111, 208, 243, 56, 205, 128, 14, 177, 58, 37, 110, 209, 92, 230, 244, 182, 140, 167, 240,
    146, 103, 87, 151, 106, 203, 121, 162, 17, 220, 111, 163, 85, 135, 66, 94, 154, 220, 2, 86,
    209, 71, 88, 160, 15, 228, 165, 157, 219, 195, 94, 14, 210, 197, 141, 157, 227, 37, 200, 245,
    54, 179, 39, 184, 243, 147, 74, 191, 73, 248, 94, 164, 18, 188, 221, 108, 132, 99, 212, 233,
    76, 151, 98, 32, 150, 237, 102, 24, 3, 219, 136, 195, 183, 221, 160, 121, 200, 31, 21, 129, 79,
    137, 229, 1, 248, 84, 30, 235, 251, 169, 77, 144, 232, 139, 30, 236, 226, 114, 226, 158, 242,
    163, 70, 178, 220, 47, 115, 251, 192, 136, 25, 73, 210, 24, 172, 253, 122, 233, 107, 4, 21,
    126, 22, 201, 80, 96, 105, 188, 189, 49, 215, 92, 114, 130, 53, 139, 116, 119, 108, 48, 50,
    222, 92, 13, 105, 232, 241, 199, 93, 38, 20, 97, 91, 32, 105, 107, 6, 99, 193, 180, 28, 38,
    114, 14, 72, 108, 49, 0, 61, 180, 95, 173, 143, 8, 241, 97, 25, 46, 145, 231, 63, 115, 48, 47,
    133, 128, 39, 189, 57, 111, 111, 194, 88, 172, 38, 217, 49, 252, 192, 169, 238, 162, 148, 191,
    120, 89, 141, 213, 40, 246, 111, 58, 194, 52, 83, 96, 252, 238, 237, 43, 252, 150, 37, 185,
    118, 118, 191, 134, 144, 105, 225, 237, 44, 248, 76, 37, 72, 38, 89, 58, 73, 209, 226, 92, 214,
    132, 147, 7, 202, 193, 90, 239, 95, 172, 254, 92, 125, 104, 163, 22, 49, 60, 74, 77, 161, 246,
    188, 126, 46, 29, 141, 138, 245, 67, 182, 16, 245, 59, 84, 120, 45, 84, 29, 80, 181, 244, 133,
    203, 17, 23, 130, 106, 249, 248, 154, 33, 254, 72, 214, 99, 227, 167, 234, 253, 202, 30, 227,
    95, 215, 1, 238, 42, 23, 154, 153, 119, 26, 19, 28, 18, 247, 227, 66, 56, 101, 237, 119, 31,
    30, 159, 24, 93, 50, 238, 184, 128, 87, 3, 92, 110, 10, 251, 31, 123, 93, 20, 230, 250, 84, 71,
    29, 203, 139, 55, 240, 57, 218, 217, 32, 146, 199, 254, 215, 71, 14, 230, 203, 162, 126, 84,
    238, 245, 185, 208, 232, 137, 197, 220, 152, 240, 55, 138, 231, 93, 208, 201, 241, 104, 144,
    209, 216, 182, 19, 167, 5, 218, 144, 193, 22, 86, 167, 132, 65, 230, 44, 152, 175, 18, 159,
    122, 248, 217, 205, 163, 118, 80, 179, 121, 122, 157, 43, 26, 230, 157, 211, 167, 96, 169, 154,
    28, 229, 15, 222, 249, 240, 58, 214, 150, 5, 207, 249, 153, 237, 191, 110, 103, 212, 100, 220,
    3, 157, 236, 27, 53, 39, 79, 224, 31, 135, 249, 110, 193, 239, 47, 60, 58, 196, 215, 125, 212,
    23, 196, 250, 62, 91, 249, 3, 110, 26, 223, 5, 220, 1, 158, 158, 175, 114, 146, 68, 48, 64, 15,
    59, 2, 17, 37, 21, 89, 178, 139, 81, 251, 67, 164, 154, 38, 217, 46, 205, 121, 127, 209, 104,
    177, 35, 149, 240, 76, 43, 1, 30, 127, 36, 227, 20, 134, 52, 188, 23, 6, 239, 202, 66, 189, 51,
    5, 248, 201, 38, 24, 11, 246, 196, 70, 18, 31, 189, 229, 75, 217, 212, 34, 121, 38, 239, 156,
    166, 139, 142, 37, 121, 231, 75, 20, 45, 159, 26, 66, 199, 39, 155, 176, 211, 175, 38, 136,
    193, 227, 201, 248, 132, 185, 130, 244, 210, 173, 217, 66, 248, 203, 65, 152, 2, 17, 16, 69,
    96, 97, 21, 134, 37, 237, 41, 101, 232, 114, 17, 158, 142, 143, 162, 117, 54, 120, 74, 112, 28,
    116, 108, 188, 251, 131, 50, 30, 52, 232, 226, 33, 136, 147, 177, 217, 145, 120, 174, 139, 119,
    187, 99, 3, 248, 47, 148, 65, 12, 163, 163, 68, 167, 69, 150, 220, 253, 46, 179, 96, 124, 40,
    52, 44, 155, 108, 128, 113, 233, 222, 208, 223, 2, 172, 65, 110, 245, 230, 124, 187, 93, 158,
    130, 94, 51, 241, 3, 195, 140, 180, 166, 30, 171, 217, 43, 38, 124, 254, 155, 253, 60, 188,
    114, 193, 145, 40, 93, 152, 84, 201, 151, 170, 191, 155, 61, 53, 196, 193, 144, 68, 217, 5,
    198, 235, 92, 246, 26, 59, 126, 116, 39, 0, 165, 146, 43, 219, 151, 63, 246, 168, 98, 90, 154,
    7, 218, 235, 105, 156, 190, 113, 56, 51, 50, 1, 72, 145, 151, 175, 39, 9, 37, 176, 220, 218,
    115, 59, 78, 10, 196, 66, 38, 109, 234, 68, 19, 176, 60, 137, 227, 125, 15, 221, 165, 45, 210,
    198, 177, 37, 127, 1, 211, 181, 111, 53, 115, 221, 207, 102, 171, 83, 206, 155, 8, 142, 109,
    152, 158, 254, 75, 240, 151, 62, 85, 53, 248, 237, 179, 181, 148, 160, 150, 71, 118, 165, 244,
    160, 163, 11, 37, 84, 28, 116, 183, 199, 112, 49, 68, 165, 23, 105, 116, 113, 230, 144, 173,
    95, 114, 71, 54, 162, 80, 148, 71, 138, 93, 85, 113, 93, 92, 111, 25, 202, 91, 156, 148, 41,
    49, 215, 35, 125, 13, 76, 92, 64, 143, 218, 149, 27, 194, 164, 91, 144, 95, 236, 84, 122, 5,
    32, 240, 150, 214, 209, 204, 241, 150, 255, 184, 69, 244, 190, 173, 119, 214, 42, 235, 193,
    185, 86, 40, 18, 73, 248, 48, 140, 31, 102, 178, 67, 108, 156, 88, 97, 230, 42, 244, 67, 49,
    127, 126, 40, 124, 214, 99, 204, 50, 252, 229, 241, 115, 96, 232, 204, 129, 253, 101, 157, 81,
    166, 194, 228, 81, 165, 52, 35, 192, 96, 7, 208, 29, 69, 246, 30, 129, 23, 224, 131, 229, 200,
    123, 235, 57, 239, 172, 54, 253, 19, 12, 111, 94, 149, 134, 125, 17, 98, 88, 123, 240, 230,
    101, 237, 28, 216, 34, 241, 142, 66, 18, 189, 18, 10, 98, 103, 119, 165, 78, 6, 193, 133, 28,
    7, 216, 74, 205, 182, 35, 129, 55, 242, 28, 225, 66, 78, 16, 85, 199, 117, 36, 117, 198, 149,
    233, 95, 244, 128, 79, 213, 158, 16, 217, 34, 90, 110, 222, 215, 242, 53, 94, 158, 131, 129,
    200, 206, 48, 29, 221, 21, 33, 197, 205, 58, 65, 97, 24, 205, 53, 30, 185, 233, 249, 172, 121,
    197, 59, 60, 136, 89, 97, 100, 70, 128, 184, 221, 108, 90, 240, 180, 112, 61, 33, 39, 227, 221,
    78, 63, 120, 250, 106, 155, 178, 211, 162, 210, 56, 0, 219, 9, 201, 246, 102, 136, 182, 151,
    171, 187, 226, 136, 248, 143, 128, 128, 190, 53, 223, 149, 96, 211, 108, 102, 212, 190, 108,
    37, 170, 101, 108, 203, 213, 232, 155, 251, 14, 17, 217, 116, 39, 109, 42, 193, 118, 144, 15,
    159, 26, 183, 64, 165, 7, 82, 154, 126, 61, 156, 144, 53, 167, 179, 84, 173, 241, 255, 2, 164,
    49, 106, 254, 240, 153, 185, 246, 187, 245, 174, 228, 242, 240, 180, 236, 202, 238, 58, 47, 37,
    124, 36, 215, 118, 184, 56, 250, 198, 22, 71, 128, 233, 214, 217, 9, 59, 188, 131, 120, 188, 0,
    71, 196, 246, 106, 150, 155, 28, 64, 28, 210, 234, 138, 108, 70, 190, 198, 116, 203, 44, 85,
    125, 2, 162, 57, 194, 177, 225, 62, 23, 48, 201, 250, 111, 53, 2, 214, 55, 36, 119, 249, 138,
    172, 79, 49, 225, 232, 167, 69, 165, 93, 69, 240, 253, 72, 27, 122, 77, 133, 150, 14, 0, 38,
    122, 108, 74, 190, 241, 112, 119, 33, 136, 234, 87, 238, 68, 104, 215, 19, 99, 248, 131, 210,
    52, 57, 53, 186, 224, 43, 60, 182, 234, 172, 215, 41, 184, 229, 49, 255, 203, 50, 243, 182,
    179, 123, 135, 93, 42, 191, 178, 113, 107, 25, 223, 71, 239, 150, 120, 127, 225, 63, 7, 9, 235,
    114, 85, 101, 159, 44, 36, 211, 81, 130, 212, 221, 34, 161, 198, 209, 236, 52, 138, 64, 187,
    232, 28, 61, 219, 224, 159, 93, 161, 174, 202, 76, 39, 119, 188, 147, 209, 104, 168, 10, 137,
    133, 224, 18, 10, 38, 9, 26, 64, 29, 15, 70, 79, 156, 104, 239, 105, 234, 54, 23, 69, 208, 107,
    173, 178, 130, 58, 209, 49, 215, 106, 103, 131, 122, 172, 247, 139, 62, 31, 200, 245, 174, 238,
    54, 53, 94, 98, 229, 156, 162, 4, 101, 102, 178, 159, 195, 148, 230, 227, 102, 89, 254, 93,
    247, 90, 206, 35, 253, 108, 41, 174, 102, 101, 58, 103, 210, 70, 64, 55, 204, 4, 229, 223, 44,
    255, 81, 254, 163, 207, 78, 169, 3, 12, 11, 62, 248, 95, 122, 159, 187, 107, 13, 155, 236, 189,
    80, 173, 72, 200, 104, 132, 191, 153, 31, 117, 197, 198, 61, 59, 178, 102, 193, 50, 198, 136,
    135, 24, 64, 57, 54, 176, 6, 21, 109, 151, 14, 240, 33, 129, 112, 112, 217, 2, 200, 90, 201,
    146, 235, 51, 178, 69, 233, 221, 25, 192, 37, 128, 184, 72, 51, 233, 32, 228, 112, 42, 31, 162,
    211, 197, 186, 12, 87, 177, 175, 195, 135, 35, 191, 50, 110, 92, 58, 120, 219, 49, 137, 129,
    209, 252, 45, 218, 109, 149, 215, 75, 0, 179, 142, 183, 135, 229, 85, 224, 144, 225, 164, 216,
    37, 209, 9, 215, 106, 235, 29, 84, 119, 71, 190, 155, 17, 103, 200, 98, 53, 249, 250, 174, 215,
    239, 8, 5, 44, 147, 185, 223, 166, 34, 202, 22, 153, 155, 95, 43, 96, 250, 244, 234, 196, 23,
    161, 95, 80, 191, 222, 174, 104, 27, 145, 166, 230, 212, 95, 85, 90, 233, 238, 36, 170, 134,
    197, 5, 242, 208, 121, 113, 93, 227, 72, 65, 231, 224, 127, 61, 71, 246, 33, 70, 67, 185, 162,
    0, 3, 242, 208, 241, 87, 31, 185, 102, 215, 164, 98, 1, 196, 82, 230, 211, 255, 239, 83, 199,
    185, 188, 172, 95, 150, 39, 117, 180, 29, 43, 133, 54, 21, 9, 97, 17, 3, 88, 122, 171, 147,
    190, 121, 129, 232, 47, 217, 110, 199, 111, 92, 136, 232, 244, 202, 61, 134, 75, 72, 214, 162,
    163, 208, 167, 58, 211, 221, 225, 49, 149, 223, 251, 53, 51, 96, 100, 12, 136, 161, 121, 162,
    158, 199, 238, 223, 146, 166, 82, 211, 130, 202, 202, 31, 215, 202, 189, 135, 196, 168, 166,
    98, 102, 223, 96, 237, 95, 243, 121, 60, 117, 225, 103, 148, 229, 210, 100, 78, 105, 189, 249,
    33, 12, 116, 69, 239, 84, 72, 87, 255, 105, 188, 99, 131, 78, 96, 18, 188, 44, 212, 9, 33, 30,
    85, 16, 217, 194, 244, 238, 167, 235, 61, 240, 161, 169, 199, 120, 178, 151, 13, 78, 155, 160,
    50, 251, 204, 60, 62, 207, 233, 102, 254, 41, 195, 89, 85, 65, 88, 0, 78, 202, 237, 224, 135,
    113, 190, 102, 154, 252, 168, 70, 187, 92, 132, 100, 221, 14, 165, 243, 175, 69, 196, 165, 18,
    74, 13, 211, 202, 232, 222, 8, 89, 238, 253, 95, 30, 53, 229, 69, 157, 48, 232, 165, 117, 34,
    140, 182, 46, 133, 133, 183, 27, 207, 181, 38, 244, 28, 22, 179, 75, 212, 101, 199, 21, 162,
    49, 185, 125, 80, 25, 247, 17, 166, 26, 253, 250, 51, 51, 237, 27, 111, 79, 111, 80, 196, 132,
    205, 79, 143, 171, 155, 166, 244, 207, 144, 159, 185, 128, 136, 114, 128, 186, 70, 115, 28, 54,
    228, 194, 110, 212, 0, 51, 177, 86, 165, 216, 145, 255, 31, 35, 242, 193, 19, 149, 239, 61,
    136, 84, 107, 160, 113, 95, 60, 101, 164, 116, 45, 110, 189, 166, 252, 79, 132, 193, 1, 94,
    102, 17, 213, 239, 173, 81, 191, 108, 255, 47, 169, 79, 144, 208, 74, 193, 106, 205, 212, 152,
    62, 69, 139, 23, 11, 3, 112, 193, 160, 187, 239, 224, 80, 110, 1, 112, 11, 39, 159, 98, 250,
    135, 1, 3, 143, 13, 251, 234, 68, 201, 165, 158, 3, 93, 194, 187, 194, 138, 165, 195, 37, 230,
    143, 104, 77, 48, 166, 44, 231, 6, 161, 214, 87, 66, 104, 27, 61, 85, 14, 127, 156, 184, 86,
    249, 217, 203, 19, 43, 29, 122, 222, 133, 169, 17, 3, 188, 244, 175, 209, 37, 249, 15, 89, 132,
    50, 149, 107, 26, 73, 60, 70, 30, 244, 86, 141, 125, 163, 10, 23, 107, 230, 226, 166, 82, 227,
    76, 149, 18, 152, 59, 209, 32, 25, 227, 101, 166, 74, 230, 243, 151, 148, 74, 16, 81, 237, 201,
    81, 242, 153, 181, 158, 248, 126, 162, 13, 91, 42, 18, 152, 122, 189, 214, 193, 216, 68, 159,
    226, 238, 177, 239, 163, 122, 4, 5, 5, 82, 98, 236, 181, 30, 124, 107, 63, 89, 172, 211, 191,
    53, 1, 51, 236, 230, 10, 192, 222, 87, 208, 232, 36, 7, 1, 184, 120, 236, 122, 228, 12, 250,
    164, 94, 93, 1, 31, 132, 166, 229, 168, 188, 56, 54, 172, 131, 11, 255, 143, 243, 147, 94, 87,
    36, 1, 158, 39, 90, 232, 15, 6, 15, 116, 68, 190, 34, 197, 88, 194, 177, 77, 73, 37, 172, 242,
    124, 194, 44, 222, 57, 154, 155, 193, 84, 202, 237, 219, 188, 35, 34, 151, 188, 106, 10, 195,
    213, 193, 102, 191, 174, 147, 0, 145, 206, 142, 89, 194, 86, 119, 110, 58, 121, 167, 183, 149,
    218, 80, 192, 167, 95, 191, 46, 163, 190, 213, 20, 39, 255, 74, 127, 103, 163, 136, 88, 68,
    232, 50, 169, 66, 51, 31, 215, 25, 28, 118, 132, 83, 176, 93, 91, 218, 123, 188, 123, 205, 228,
    115, 251, 242, 65, 84, 191, 125, 199, 218, 199, 22, 60, 112, 168, 146, 4, 218, 170, 58, 72, 3,
    91, 125, 243, 133, 77, 214, 176, 255, 43, 251, 197, 54, 151, 210, 218, 238, 28, 253, 186, 136,
    132, 170, 250, 11, 111, 241, 178, 236, 189, 118, 3, 159, 218, 150, 185, 172, 162, 171, 200,
    225, 55, 43, 173, 44, 119, 244, 77, 210, 87, 222, 63, 65, 105, 233, 235, 130, 220, 241, 89,
    199, 68, 123, 84, 139, 130, 234, 51, 30, 46, 16, 102, 172, 246, 197, 214, 121, 31, 14, 252,
    251, 54, 192, 157, 43, 196, 127, 39, 8, 245, 51, 253, 69, 217, 116, 58, 240, 246, 184, 139,
    155, 153, 223, 158, 124, 74, 179, 112, 166, 234, 225, 88, 128, 174, 203, 1, 56, 6, 160, 64,
    168, 38, 165, 223, 228, 137, 225, 160, 227, 228, 137, 69, 79, 243, 218, 139, 122, 64, 188, 10,
    107, 98, 191, 221, 36, 19, 232, 200, 27, 17, 94, 213, 252, 137, 137, 46, 97, 200, 7, 193, 169,
    4, 188, 179, 239, 129, 131, 113, 57, 118, 144, 106, 177, 70, 220, 115, 182, 225, 214, 83, 84,
    181, 175, 151, 107, 114, 129, 75, 103, 135, 62, 208, 65, 231, 176, 193, 2, 100, 112, 122, 14,
    99, 75, 136, 122, 122, 57, 208, 105, 170, 150, 161, 142, 246, 252, 71, 10, 29, 15, 41, 99, 9,
    3, 118, 58, 68, 23, 59, 151, 208, 190, 40, 26, 84, 149, 0, 63, 176, 211, 84, 115, 235, 159,
    183, 218, 11, 54, 96, 207, 147, 216, 48, 4, 99, 33, 36, 172, 92, 90, 194, 247, 233, 213, 130,
    225, 247, 124, 75, 111, 27, 159, 248, 38, 84, 52, 161, 32, 148, 18, 131, 86, 18, 117, 51, 202,
    161, 129, 215, 147, 103, 211, 187, 34, 230, 229, 53, 37, 93, 185, 201, 106, 202, 179, 167, 212,
    207, 105, 70, 200, 191, 152, 249, 230, 200, 141, 125, 199, 110, 244, 217, 103, 18, 36, 170,
    125, 167, 2, 92, 224, 20, 75, 35, 234, 26, 251, 186, 212, 81, 18, 181, 9, 98, 233, 176, 28, 67,
    64, 202, 242, 79, 15, 36, 248, 111, 244, 98, 2, 231, 122, 149, 226, 4, 216, 139, 211, 9, 161,
    79, 207, 249, 134, 52, 176, 247, 92, 39, 189, 6, 10, 179, 46, 99, 84, 6, 75, 248, 83, 244, 129,
    103, 122, 240, 154, 13, 143, 123, 52, 137, 8, 121, 51, 85, 8, 6, 60, 5, 201, 31, 40, 113, 63,
    201, 222, 47, 218, 243, 149, 58, 140, 27, 128, 131, 186, 190, 93, 173, 183, 237, 254, 130, 200,
    214, 124, 1, 51, 193, 61, 237, 240, 239, 243, 232, 63, 17, 101, 212, 191, 134, 88, 103, 11,
    213, 37, 64, 233, 121, 218, 143, 108, 207, 243, 82, 222, 230, 179, 193, 198, 105, 40, 250, 164,
    132, 45, 38, 206, 74, 226, 59, 45, 171, 36, 49, 112, 186, 2, 62, 82, 205, 121, 145, 195, 229,
    154, 179, 208, 95, 238, 2, 33, 173, 18, 57, 127, 63, 201, 13, 27, 25, 142, 199, 162, 5, 100, 8,
    155, 193, 12, 61, 134, 219, 192, 41, 135, 150, 176, 240, 121, 142, 145, 11, 91, 220, 160, 75,
    113, 39, 68, 141, 177, 99, 139, 72, 66, 51, 50, 7, 79, 72, 91, 31, 82, 109, 106, 66, 2, 232,
    134, 254, 161, 139, 140, 175, 96, 195, 221, 101, 53, 176, 16, 211, 36, 170, 7, 218, 156, 200,
    157, 82, 181, 162, 234, 190, 79, 200, 189, 180, 73, 228, 128, 49, 166, 81, 19, 222, 137, 128,
    102, 160, 45, 82, 56, 51, 139, 6, 159, 57, 105, 35, 222, 94, 166, 158, 128, 57, 188, 154, 221,
    117, 168, 203, 200, 226, 100, 141, 11, 75, 122, 142, 120, 152, 194, 20, 111, 199, 11, 200, 76,
    216, 203, 59, 117, 164, 125, 151, 150, 4, 208, 232, 85, 56, 103, 23, 162, 61, 180, 79, 176,
    143, 137, 175, 240, 184, 251, 175, 221, 78, 185, 128, 60, 5, 171, 79, 204, 184, 66, 95, 121,
    118, 38, 219, 181, 190, 196, 65, 61, 230, 200, 119, 196, 81, 232, 91, 194, 221, 85, 159, 121,
    45, 151, 123, 5, 13, 44, 161, 56, 112, 105, 110, 194, 44, 228, 255, 231, 209, 67, 199, 165,
    172, 69, 27, 100, 87, 105, 9, 255, 54, 177, 211, 31, 224, 223, 123, 182, 191, 231, 246, 191,
    81, 2, 165, 238, 45, 42, 103, 206, 137, 162, 210, 251, 51, 84, 113, 127, 98, 133, 155, 151, 82,
    125, 245, 97, 20, 212, 114, 119, 26, 122, 100, 208, 168, 198, 148, 60, 218, 58, 81, 184, 69,
    70, 17, 193, 242, 76, 166, 193, 107, 210, 21, 132, 46, 243, 254, 223, 66, 76, 9, 155, 167, 226,
    6, 185, 141, 247, 57, 95, 227, 18, 31, 34, 64, 77, 119, 0, 24, 218, 185, 206, 140, 138, 47, 35,
    219, 85, 251, 55, 180, 97, 216, 24, 153, 205, 143, 240, 241, 50, 40, 237, 94, 113, 88, 148, 23,
    17, 213, 127, 251, 178, 149, 195, 232, 99, 149, 145, 127, 104, 168, 109, 54, 39, 4, 118, 167,
    98, 146, 184, 27, 24, 28, 184, 182, 82, 248, 0, 55, 31, 37, 24, 243, 239, 146, 140, 240, 102,
    174, 130, 95, 162, 139, 23, 78, 146, 162, 208, 11, 143, 34, 209, 209, 152, 210, 176, 106, 73,
    7, 15, 62, 167, 79, 146, 182, 153, 115, 125, 222, 207, 165, 132, 104, 189, 133, 128, 73, 217,
    27, 128, 135, 48, 78, 86, 209, 184, 119, 21, 32, 140, 255, 240, 55, 66, 200, 87, 89, 152, 126,
    237, 20, 83, 169, 252, 111, 10, 170, 236, 232, 111, 237, 246, 246, 70, 184, 194, 93, 226, 217,
    132, 49, 150, 54, 38, 169, 40, 53, 131, 190, 5, 51, 235, 176, 10, 131, 150, 172, 173, 213, 245,
    153, 80, 38, 95, 215, 69, 204, 212, 152, 55, 48, 96, 105, 251, 185, 41, 71, 108, 105, 177, 2,
    57, 242, 226, 101, 90, 172, 11, 120, 232, 159, 16, 141, 225, 41, 231, 135, 49, 101, 131, 102,
    223, 245, 42, 39, 50, 188, 117, 244, 225, 182, 99, 55, 108, 235, 254, 126, 92, 86, 228, 154,
    223, 138, 25, 194, 224, 137, 169, 162, 83, 72, 220, 203, 207, 179, 168, 83, 164, 191, 87, 138,
    173, 90, 200, 66, 21, 81, 115, 246, 32, 187, 152, 231, 190, 33, 62, 21, 198, 1, 5, 134, 215,
    50, 244, 66, 157, 177, 194, 98, 118, 103, 65, 238, 254, 133, 66, 242, 110, 21, 35, 149, 138,
    253, 109, 161, 90, 248, 50, 78, 52, 113, 109, 238, 83, 50, 177, 177, 241, 157, 7, 8, 141, 182,
    177, 241, 62, 213, 152, 128, 213, 236, 173, 99, 100, 37, 218, 72, 22, 39, 115, 140, 243, 14,
    48, 74, 27, 62, 59, 75, 9, 139, 23, 227, 77, 96, 122, 44, 45, 72, 108, 162, 186, 25, 41, 228,
    95, 49, 195, 248, 26, 47, 218, 60, 209, 195, 34, 101, 90, 21, 157, 10, 90, 223, 64, 76, 255,
    46, 26, 29, 37, 21, 132, 120, 56, 85, 240, 245, 42, 85, 201, 19, 199, 215, 221, 219, 193, 95,
    246, 84, 223, 224, 75, 5, 245, 224, 25, 164, 171, 217, 216, 9, 150, 241, 151, 15, 213, 40, 18,
    233, 76, 154, 93, 100, 254, 138, 217, 251, 53, 10, 74, 51, 131, 44, 180, 247, 121, 221, 61,
    228, 8, 13, 96, 195, 148, 171, 72, 83, 218, 216, 4, 19, 45, 5, 199, 167, 206, 213, 26, 63, 151,
    140, 247, 170, 246, 148, 72, 237, 152, 67, 140, 153, 250, 169, 232, 66, 46, 89, 190, 246, 48,
    145, 236, 108, 66, 181, 218, 249, 63, 99, 35, 146, 10, 125, 180, 186, 161, 198, 213, 167, 90,
    57, 95, 29, 75, 117, 214, 116, 176, 237, 191, 0, 70, 185, 134, 153, 127, 93, 225, 90, 97, 238,
    247, 204, 237, 219, 28, 66, 213, 173, 120, 198, 91, 139, 80, 14, 144, 27, 79, 213, 9, 240, 81,
    47, 220, 170, 59, 90, 145, 84, 98, 247, 188, 53, 181, 173, 181, 38, 80, 115, 155, 243, 243,
    119, 180, 149, 227, 133, 137, 60, 189, 166, 157, 147, 74, 182, 49, 150, 173, 106, 205, 130,
    140, 134, 227, 192, 162, 2, 79, 137, 70, 192, 213, 55, 213, 137, 99, 48, 229, 252, 198, 16,
    222, 66, 48, 50, 202, 225, 7, 132, 90, 120, 122, 15, 166, 153, 169, 71, 40, 48, 109, 202, 255,
    36, 199, 247, 42, 23, 167, 157, 165, 185, 127, 144, 58, 160, 65, 85, 128, 166, 24, 20, 79, 93,
    244, 178, 83, 91, 14, 148, 120, 245, 79, 76, 208, 242, 23, 104, 211, 141, 160, 122, 223, 185,
    95, 74, 177, 120, 62, 251, 71, 93, 144, 192, 44, 208, 160, 184, 171, 222, 91, 170, 186, 41,
    125, 157, 129, 183, 254, 164, 117, 197, 10, 13, 57, 38, 203, 210, 135, 225, 175, 53, 139, 231,
    76, 109, 107, 74, 198, 158, 58, 235, 61, 20, 35, 118, 163, 219, 127, 222, 97, 0, 216, 34, 228,
    182, 197, 125, 55, 13, 169, 134, 153, 195, 128, 157, 195, 177, 25, 192, 229, 58, 160, 249, 100,
    166, 144, 77, 239, 136, 126, 105, 239, 244, 180, 25, 82, 210, 133, 185, 9, 35, 165, 20, 67,
    100, 130, 188, 179, 105, 12, 77, 132, 40, 246, 76, 73, 253, 83, 80, 152, 224, 19, 73, 166, 227,
    90, 83, 72, 16, 203, 57, 236, 99, 20, 91, 222, 4, 230, 183, 80, 66, 65, 202, 4, 99, 21, 98, 43,
    50, 50, 97, 247, 12, 238, 235, 223, 208, 152, 119, 198, 98, 43, 103, 139, 161, 60, 233, 56,
    129, 92, 1, 164, 177, 44, 124, 89, 38, 96, 130, 62, 160, 83, 17, 113, 127, 146, 177, 216, 73,
    201, 250, 111, 67, 102, 102, 112, 32, 116, 62, 112, 252, 124, 210, 31, 44, 137, 215, 83, 3, 87,
    2, 31, 245, 204, 134, 147, 17, 180, 215, 94, 25, 182, 47, 220, 76, 255, 104, 79, 130, 23, 213,
    81, 81, 232, 32, 99, 65, 93, 157, 190, 196, 197, 203, 225, 44, 82, 89, 98, 110, 117, 164, 209,
    232, 12, 54, 64, 113, 135, 136, 142, 180, 188, 206, 225, 37, 39, 41, 201, 214, 21, 27, 49, 77,
    113, 166, 194, 231, 2, 55, 89, 128, 129, 206, 221, 249, 17, 26, 27, 55, 65, 85, 95, 164, 188,
    214, 225, 236, 249, 35, 39, 115, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 17, 28, 33, 41, 49, 62, 65,
    0,
];

fn test_gen_key_pair() {
    let mut trng = unsafe {
        Trng::new(
            CsrngReg::new(),
            EntropySrcReg::new(),
            SocIfcTrngReg::new(),
            &SocIfcReg::new(),
        )
        .unwrap()
    };
    let mut entropy_gen = || trng.generate().map(|a| a.0);

    // This needs to happen in the first test
    CfiCounter::reset(&mut entropy_gen);

    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    let mut hmac = unsafe { Hmac::new(HmacReg::new()) };
    let key_out_1 = KeyWriteArgs {
        id: KeyId::KeyId0,
        usage: KeyUsage::default().set_ecc_key_gen_seed_en(),
    };

    hmac.hmac(
        &HmacKey::from(&Array4x12::default()),
        &HmacData::from(&[0]),
        &mut trng,
        HmacTag::Key(key_out_1),
        HmacMode::Hmac384,
    )
    .unwrap();

    let seed = KeyReadArgs::new(KeyId::KeyId0);
    let public_key = ml_dsa87.key_pair(&seed, &mut trng).unwrap();
    assert_eq!(public_key, Mldsa87PubKey::from(PUBKEY));
}

fn test_sign() {
    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    let mut trng = unsafe {
        Trng::new(
            CsrngReg::new(),
            EntropySrcReg::new(),
            SocIfcTrngReg::new(),
            &SocIfcReg::new(),
        )
        .unwrap()
    };

    let msg = Mldsa87Msg::default();
    let sign_rnd = Mldsa87SignRnd::default(); // Deterministic signing
    let seed = KeyReadArgs::new(KeyId::KeyId0); // Reuse SEED

    let signature = ml_dsa87
        .sign(
            &seed,
            &Mldsa87PubKey::from(PUBKEY),
            &msg,
            &sign_rnd,
            &mut trng,
        )
        .unwrap();

    assert_eq!(signature, Mldsa87Signature::from(SIGNATURE));
}

fn test_verify() {
    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    let msg = Mldsa87Msg::default();

    assert_eq!(
        ml_dsa87
            .verify(
                &Mldsa87PubKey::from(PUBKEY),
                &msg,
                &Mldsa87Signature::from(SIGNATURE)
            )
            .unwrap(),
        Mldsa87Result::Success
    );
}

fn test_verify_failure() {
    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    let msg = Mldsa87Msg::from([0xff; 64]);

    assert_eq!(
        ml_dsa87
            .verify(
                &Mldsa87PubKey::from(PUBKEY),
                &msg,
                &Mldsa87Signature::from(SIGNATURE)
            )
            .unwrap(),
        Mldsa87Result::SigVerifyFailed
    );
}

test_suite! {
    test_gen_key_pair,
    test_sign,
    test_verify,
    test_verify_failure,
}
