/*++

Licensed under the Apache-2.0 license.

File Name:

    ml_dsa87_tests.rs

Abstract:

    File contains test cases for ML_DSA87 API tests

--*/

#![no_std]
#![no_main]

use caliptra_cfi_lib::CfiCounter;
use caliptra_drivers::{
    Array4x12, Hmac, HmacData, HmacKey, HmacMode, HmacTag, KeyId, KeyReadArgs, KeyUsage,
    KeyWriteArgs, Mldsa87, Mldsa87Msg, Mldsa87PubKey, Mldsa87Result, Mldsa87SignRnd,
    Mldsa87Signature, Trng,
};
use caliptra_registers::csrng::CsrngReg;
use caliptra_registers::entropy_src::EntropySrcReg;
use caliptra_registers::hmac::HmacReg;
use caliptra_registers::mldsa::MldsaReg;
use caliptra_registers::soc_ifc::SocIfcReg;
use caliptra_registers::soc_ifc_trng::SocIfcTrngReg;
use caliptra_test_harness::test_suite;

const PUBKEY: [u8; 2592] = [
    165, 132, 202, 11, 135, 211, 244, 157, 187, 119, 155, 48, 66, 122, 25, 245, 231, 248, 6, 89,
    130, 60, 39, 10, 120, 107, 84, 127, 49, 143, 236, 26, 242, 136, 211, 121, 18, 165, 113, 115,
    174, 171, 24, 229, 105, 13, 220, 55, 136, 43, 226, 62, 37, 86, 7, 194, 118, 36, 50, 204, 253,
    239, 31, 119, 122, 30, 25, 47, 123, 43, 184, 186, 201, 66, 204, 205, 253, 207, 208, 97, 42,
    181, 139, 234, 192, 109, 7, 172, 251, 246, 242, 221, 59, 80, 211, 83, 117, 92, 232, 247, 125,
    67, 6, 48, 34, 100, 150, 166, 51, 125, 54, 27, 234, 243, 230, 245, 42, 201, 50, 223, 2, 115,
    31, 127, 184, 161, 127, 201, 9, 172, 201, 218, 172, 73, 248, 5, 48, 169, 98, 135, 117, 60, 139,
    242, 21, 154, 210, 224, 13, 159, 244, 148, 147, 222, 66, 134, 173, 223, 117, 238, 87, 229, 237,
    178, 102, 47, 89, 138, 128, 141, 36, 19, 107, 110, 148, 180, 230, 158, 29, 155, 117, 79, 29,
    146, 54, 6, 143, 10, 201, 31, 48, 61, 162, 136, 84, 190, 193, 95, 50, 66, 94, 171, 169, 156,
    70, 28, 255, 197, 154, 83, 1, 220, 66, 153, 57, 234, 166, 223, 62, 56, 97, 33, 109, 85, 31, 51,
    123, 254, 169, 66, 119, 93, 248, 181, 40, 198, 27, 20, 6, 173, 146, 85, 29, 78, 147, 7, 113,
    219, 199, 105, 212, 54, 115, 202, 149, 82, 47, 76, 233, 72, 13, 133, 43, 165, 128, 40, 167, 40,
    199, 237, 209, 205, 204, 196, 165, 237, 237, 251, 162, 202, 135, 86, 103, 162, 147, 76, 128,
    83, 180, 97, 126, 213, 53, 48, 197, 157, 217, 159, 128, 210, 199, 252, 42, 38, 7, 174, 121,
    239, 214, 78, 31, 107, 93, 1, 57, 185, 187, 12, 8, 132, 221, 192, 127, 250, 32, 242, 12, 79,
    117, 128, 147, 217, 10, 20, 82, 151, 243, 193, 146, 252, 25, 188, 140, 136, 44, 241, 20, 141,
    232, 255, 56, 29, 156, 246, 149, 74, 202, 27, 219, 17, 55, 77, 67, 24, 146, 3, 202, 30, 27,
    154, 21, 75, 73, 138, 159, 109, 65, 239, 218, 82, 112, 230, 19, 198, 199, 17, 146, 25, 16, 83,
    19, 6, 99, 155, 157, 11, 205, 50, 44, 100, 109, 200, 147, 231, 206, 86, 44, 228, 48, 150, 195,
    39, 78, 37, 84, 207, 126, 20, 64, 120, 81, 38, 145, 233, 17, 145, 183, 247, 171, 238, 201, 253,
    112, 1, 139, 95, 108, 252, 196, 18, 77, 105, 19, 207, 252, 140, 255, 135, 150, 198, 73, 52,
    148, 164, 41, 63, 206, 42, 202, 147, 26, 50, 154, 175, 117, 115, 172, 107, 113, 68, 144, 84,
    161, 81, 81, 238, 176, 55, 27, 211, 43, 169, 233, 255, 155, 227, 50, 47, 39, 162, 211, 127, 32,
    104, 72, 158, 156, 162, 34, 45, 109, 43, 142, 28, 55, 163, 228, 125, 156, 227, 101, 105, 143,
    244, 240, 238, 109, 3, 226, 205, 52, 173, 36, 57, 229, 223, 197, 193, 82, 107, 224, 87, 168,
    205, 31, 183, 52, 37, 3, 176, 11, 49, 213, 122, 32, 90, 32, 122, 50, 34, 97, 10, 219, 181, 184,
    157, 171, 174, 34, 163, 136, 183, 94, 65, 65, 45, 21, 22, 139, 82, 165, 43, 74, 220, 230, 10,
    70, 52, 176, 254, 191, 228, 223, 37, 98, 25, 172, 129, 233, 248, 236, 21, 235, 78, 90, 148, 23,
    206, 226, 196, 68, 109, 130, 64, 8, 219, 235, 101, 42, 149, 207, 22, 78, 2, 36, 75, 223, 167,
    220, 101, 101, 65, 179, 131, 11, 37, 139, 171, 104, 173, 253, 42, 15, 192, 178, 34, 0, 217,
    157, 171, 101, 219, 158, 29, 156, 231, 134, 59, 76, 129, 207, 14, 125, 10, 188, 215, 223, 114,
    24, 250, 38, 235, 143, 158, 89, 90, 156, 110, 204, 181, 228, 153, 252, 230, 113, 109, 38, 210,
    167, 194, 199, 223, 18, 68, 238, 173, 173, 26, 176, 234, 56, 30, 253, 60, 26, 171, 118, 18, 21,
    211, 105, 149, 234, 84, 180, 36, 226, 33, 31, 4, 77, 97, 230, 57, 168, 131, 67, 43, 38, 48, 47,
    109, 188, 92, 157, 243, 54, 145, 206, 217, 246, 150, 179, 159, 120, 106, 88, 23, 68, 25, 203,
    6, 52, 95, 72, 135, 189, 87, 95, 6, 104, 161, 129, 81, 231, 133, 63, 179, 44, 108, 50, 129, 68,
    158, 54, 121, 33, 37, 7, 184, 180, 99, 107, 136, 5, 14, 25, 200, 107, 65, 205, 140, 156, 125,
    14, 166, 196, 33, 71, 86, 24, 114, 0, 183, 108, 44, 111, 166, 155, 240, 56, 40, 29, 170, 164,
    235, 198, 90, 89, 227, 197, 252, 232, 14, 187, 98, 29, 136, 167, 210, 8, 129, 193, 241, 16,
    239, 202, 141, 212, 97, 127, 71, 6, 188, 24, 126, 146, 21, 135, 49, 216, 239, 125, 227, 114,
    61, 233, 223, 111, 111, 184, 106, 239, 50, 40, 42, 212, 6, 255, 124, 69, 18, 75, 184, 19, 195,
    148, 239, 31, 139, 161, 26, 50, 11, 202, 138, 34, 63, 38, 58, 104, 229, 214, 163, 12, 48, 198,
    172, 154, 222, 4, 107, 17, 34, 136, 32, 131, 118, 208, 88, 159, 235, 206, 8, 162, 130, 107, 13,
    129, 252, 133, 216, 148, 87, 67, 160, 124, 107, 184, 144, 134, 202, 47, 165, 66, 199, 154, 245,
    122, 240, 104, 0, 147, 214, 83, 112, 60, 208, 202, 112, 30, 143, 61, 81, 0, 124, 253, 51, 100,
    198, 83, 71, 167, 94, 76, 186, 62, 177, 179, 61, 50, 129, 3, 148, 175, 166, 180, 75, 102, 20,
    72, 225, 47, 41, 75, 33, 226, 72, 240, 91, 142, 233, 174, 24, 159, 98, 188, 103, 64, 196, 44,
    51, 39, 45, 62, 213, 245, 9, 5, 158, 213, 97, 132, 231, 134, 8, 42, 0, 65, 89, 135, 190, 244,
    89, 143, 179, 2, 243, 18, 146, 166, 132, 109, 159, 155, 39, 28, 189, 122, 132, 137, 37, 13,
    215, 25, 212, 152, 84, 76, 190, 233, 117, 203, 35, 91, 254, 188, 198, 51, 242, 196, 170, 73,
    58, 177, 210, 15, 110, 175, 188, 176, 65, 92, 217, 78, 44, 229, 89, 134, 141, 8, 152, 119, 135,
    251, 111, 233, 7, 59, 18, 197, 145, 194, 29, 31, 245, 117, 71, 119, 12, 116, 207, 209, 197, 70,
    237, 23, 141, 205, 173, 92, 160, 123, 79, 105, 42, 203, 255, 30, 102, 144, 21, 79, 254, 108,
    26, 191, 155, 146, 152, 118, 157, 189, 228, 10, 56, 26, 105, 117, 123, 117, 231, 23, 137, 179,
    65, 108, 51, 224, 112, 103, 82, 120, 192, 88, 21, 29, 34, 177, 45, 114, 33, 110, 35, 37, 203,
    128, 153, 6, 6, 2, 118, 230, 215, 136, 33, 153, 138, 212, 30, 81, 230, 125, 229, 243, 38, 214,
    109, 147, 131, 244, 189, 253, 128, 216, 126, 148, 207, 41, 200, 209, 154, 12, 239, 101, 226,
    69, 248, 116, 37, 7, 184, 227, 133, 217, 116, 83, 7, 113, 31, 0, 206, 97, 95, 194, 252, 65,
    241, 175, 65, 61, 208, 40, 220, 51, 54, 173, 242, 239, 82, 239, 61, 238, 37, 163, 185, 120,
    152, 216, 156, 56, 184, 219, 103, 102, 15, 192, 192, 207, 39, 22, 28, 77, 42, 225, 7, 70, 219,
    33, 200, 58, 187, 120, 140, 78, 2, 174, 231, 133, 237, 247, 138, 81, 48, 108, 134, 11, 102,
    122, 43, 9, 80, 196, 229, 185, 97, 212, 110, 213, 237, 255, 205, 134, 228, 31, 31, 68, 71, 65,
    5, 239, 65, 223, 197, 100, 221, 213, 15, 65, 202, 39, 110, 229, 216, 199, 0, 46, 54, 81, 218,
    141, 8, 190, 166, 210, 243, 76, 197, 222, 6, 237, 55, 219, 66, 133, 215, 185, 108, 64, 3, 138,
    136, 46, 178, 22, 13, 132, 62, 240, 162, 91, 253, 26, 102, 44, 188, 81, 93, 20, 57, 229, 243,
    92, 115, 167, 158, 69, 238, 38, 253, 33, 56, 15, 136, 39, 104, 11, 88, 161, 248, 26, 97, 133,
    102, 202, 21, 228, 18, 230, 145, 221, 239, 251, 215, 149, 188, 13, 19, 106, 112, 233, 67, 12,
    163, 83, 66, 136, 115, 149, 58, 73, 116, 110, 19, 89, 193, 218, 118, 129, 168, 223, 83, 109,
    226, 32, 187, 134, 172, 179, 137, 95, 106, 102, 145, 87, 108, 46, 74, 71, 58, 165, 63, 104, 51,
    92, 149, 72, 155, 186, 190, 76, 208, 33, 103, 8, 205, 45, 231, 132, 249, 176, 106, 168, 241,
    202, 241, 174, 97, 52, 47, 164, 99, 48, 12, 136, 152, 61, 202, 42, 219, 204, 75, 109, 204, 115,
    95, 129, 52, 255, 166, 145, 12, 149, 206, 145, 213, 157, 103, 95, 146, 188, 77, 1, 184, 74, 70,
    133, 162, 254, 22, 14, 231, 160, 110, 42, 93, 134, 92, 92, 135, 198, 98, 176, 56, 143, 84, 54,
    89, 96, 158, 71, 151, 246, 142, 169, 169, 83, 207, 93, 145, 221, 209, 184, 210, 6, 170, 232,
    174, 109, 34, 141, 10, 69, 207, 81, 33, 46, 80, 111, 229, 20, 237, 165, 86, 128, 4, 162, 34,
    223, 38, 87, 175, 200, 208, 160, 28, 59, 181, 53, 157, 174, 128, 3, 60, 80, 113, 83, 167, 119,
    221, 12, 193, 185, 32, 20, 178, 203, 253, 221, 226, 83, 113, 108, 79, 21, 148, 85, 58, 247, 90,
    50, 99, 86, 96, 81, 162, 213, 87, 14, 51, 223, 128, 118, 117, 196, 141, 77, 245, 89, 211, 192,
    45, 153, 30, 116, 191, 9, 85, 139, 86, 2, 17, 22, 80, 53, 51, 235, 248, 162, 63, 20, 231, 54,
    171, 36, 177, 175, 179, 238, 57, 20, 148, 139, 233, 90, 149, 187, 67, 182, 197, 122, 65, 102,
    228, 178, 67, 74, 216, 132, 24, 102, 200, 170, 72, 222, 164, 45, 60, 122, 49, 41, 90, 34, 150,
    24, 221, 26, 254, 125, 176, 203, 108, 216, 241, 170, 116, 206, 96, 133, 138, 23, 97, 65, 140,
    221, 201, 220, 241, 152, 50, 70, 150, 96, 184, 51, 152, 17, 68, 35, 25, 71, 222, 194, 51, 20,
    65, 158, 236, 76, 184, 207, 72, 107, 81, 250, 214, 79, 38, 12, 12, 109, 143, 144, 122, 148, 63,
    90, 116, 60, 12, 144, 192, 44, 110, 85, 60, 250, 181, 81, 111, 155, 226, 37, 64, 187, 26, 162,
    200, 73, 119, 129, 51, 22, 122, 202, 193, 113, 75, 214, 86, 164, 42, 52, 87, 152, 105, 133,
    118, 74, 245, 9, 168, 147, 16, 66, 224, 17, 165, 216, 19, 59, 96, 142, 152, 163, 189, 227, 200,
    230, 75, 158, 183, 10, 67, 60, 134, 4, 6, 41, 62, 102, 95, 27, 99, 151, 59, 100, 65, 15, 123,
    12, 14, 107, 60, 197, 23, 153, 70, 72, 78, 17, 90, 137, 20, 50, 23, 123, 30, 175, 154, 92, 14,
    76, 159, 117, 254, 229, 211, 12, 228, 218, 139, 123, 246, 213, 51, 129, 121, 121, 73, 141, 128,
    207, 208, 26, 71, 49, 196, 226, 164, 154, 62, 38, 86, 28, 185, 168, 170, 216, 204, 178, 28,
    229, 136, 70, 100, 128, 221, 223, 27, 56, 191, 171, 107, 103, 96, 50, 85, 207, 72, 189, 120,
    118, 44, 22, 210, 245, 59, 200, 8, 71, 222, 141, 162, 48, 111, 86, 21, 142, 68, 100, 217, 221,
    59, 67, 199, 49, 214, 251, 74, 200, 237, 224, 13, 58, 29, 71, 41, 81, 170, 11, 41, 162, 116,
    217, 67, 73, 42, 79, 165, 219, 148, 4, 46, 246, 40, 43, 102, 16, 118, 91, 148, 205, 182, 86,
    241, 22, 175, 168, 245, 82, 127, 142, 192, 250, 145, 168, 159, 24, 168, 227, 39, 197, 157, 251,
    217, 128, 237, 213, 192, 221, 37, 121, 111, 66, 187, 240, 143, 130, 36, 54, 175, 214, 159, 197,
    209, 138, 243, 43, 241, 245, 69, 20, 221, 3, 4, 57, 41, 59, 48, 88, 126, 211, 131, 139, 149,
    58, 25, 39, 70, 90, 232, 21, 249, 50, 164, 4, 183, 244, 204, 220, 94, 43, 187, 238, 7, 74, 95,
    16, 141, 117, 193, 29, 193, 41, 8, 96, 65, 71, 4, 178, 152, 125, 171, 122, 42, 218, 96, 40,
    180, 139, 37, 97, 127, 12, 251, 225, 113, 134, 71, 57, 28, 206, 207, 53, 35, 49, 177, 141, 67,
    103, 10, 226, 196, 248, 13, 177, 160, 183, 116, 139, 171, 1, 38, 26, 35, 254, 67, 10, 56, 248,
    162, 96, 145, 89, 34, 76, 44, 2, 90, 113, 96, 172, 82, 49, 122, 180, 188, 43, 10, 121, 213,
    110, 209, 174, 187, 201, 229, 134, 247, 246, 227, 48, 23, 201, 113, 23, 202, 245, 61, 229, 52,
    208, 88, 231, 186, 144, 150, 86, 221, 58, 44, 157, 100, 95, 116, 119, 61, 62, 74, 19, 84, 132,
    184, 211, 17, 254, 66, 244, 245, 103, 230, 244, 248, 195, 13, 52, 12, 107, 45, 237, 103, 242,
    92, 99, 190, 198, 90, 195, 252, 32, 5, 91, 73, 7, 67, 215, 159, 94, 83, 134, 75, 1, 181, 113,
    148, 230, 90, 77, 67, 97, 3, 90, 232, 40, 30, 121, 174, 180, 106, 73, 146, 139, 176, 208, 37,
    82, 158, 131, 23, 50, 244, 159, 104, 139, 51, 242, 33, 228, 123, 180, 169, 115, 162, 245, 109,
    47, 218, 78, 201, 61, 204, 51, 72, 57, 79, 188, 40, 132, 74, 78, 215, 255, 144, 18, 203, 255,
    156, 201, 132, 51, 127, 71, 241, 69, 49, 67, 99, 16, 33, 207, 17, 197, 196, 78, 141, 76, 94,
    194, 21, 141, 63, 32, 56, 176, 179, 79, 158, 136, 206, 23, 251, 0, 19, 177, 89, 247, 206, 51,
    216, 80, 197, 90, 215, 253, 187, 177, 221, 225, 67, 198, 250, 100, 128, 149, 79, 35, 219, 53,
    223, 245, 105, 109, 141, 114, 53, 129, 181, 13, 4, 152, 84, 97, 129, 38, 162, 89, 61, 135, 222,
    234, 168, 191, 25, 191, 194, 147, 68, 134, 239, 55, 234, 201, 25, 166, 10, 18, 103, 191, 58,
    204, 56, 81, 226, 86, 58, 145, 205, 72, 183, 234, 204, 143, 27, 204, 54, 65, 17, 86, 229, 79,
    182, 214, 222, 185, 138, 72, 41, 254, 89, 133, 139, 159, 74, 189, 213, 67, 72, 22, 33, 152,
    118, 59, 251, 219, 42, 189, 167, 54, 133, 213, 221, 100, 18, 112, 31, 198, 251, 21, 158, 110,
    107, 175, 233, 251, 185, 178, 102, 251, 207, 119, 99, 137, 53, 172, 65, 194, 66, 9, 28, 30, 60,
    202, 59, 132, 195, 84, 108, 250, 64, 205, 196, 38, 65, 14, 125, 178, 131, 255, 252, 44, 28, 61,
    196, 157, 44, 101, 2, 214, 158, 193, 202, 119, 68, 76, 197, 150, 207, 243, 254, 198, 123, 1,
    217, 189, 152, 147, 194, 131, 56, 130, 57, 14, 66, 126, 215, 37, 72, 175, 77, 103, 77, 103,
    123, 135, 144, 160, 141, 204, 83, 203, 227, 105, 220, 160, 129, 51, 28, 18, 88, 224, 240, 27,
    12, 39, 7, 115, 129, 48, 16, 131, 173, 186, 57, 96, 239, 236, 229, 137, 195, 109, 234, 99, 196,
    224, 251, 232, 169, 99, 190, 58, 193,
];

const SIGNATURE: [u8; 4628] = [
    182, 221, 233, 196, 204, 137, 114, 242, 69, 160, 248, 234, 25, 72, 173, 96, 124, 133, 148, 53,
    161, 41, 92, 26, 35, 87, 232, 100, 174, 121, 176, 20, 19, 14, 80, 190, 130, 57, 25, 146, 246,
    235, 168, 3, 96, 205, 188, 193, 68, 164, 105, 172, 97, 94, 181, 47, 103, 28, 66, 206, 37, 86,
    8, 94, 132, 112, 66, 151, 146, 70, 129, 32, 118, 91, 11, 3, 216, 241, 88, 109, 36, 38, 142,
    197, 234, 91, 46, 35, 81, 116, 8, 92, 188, 113, 249, 92, 164, 47, 186, 74, 100, 163, 14, 27,
    215, 117, 135, 158, 143, 180, 231, 221, 156, 160, 133, 254, 214, 46, 79, 186, 46, 194, 76, 222,
    36, 101, 170, 177, 156, 92, 229, 120, 116, 125, 17, 195, 102, 160, 225, 144, 187, 21, 110, 17,
    188, 50, 24, 2, 241, 216, 88, 115, 170, 32, 114, 196, 95, 229, 148, 198, 0, 84, 121, 225, 241,
    129, 114, 152, 241, 130, 22, 243, 220, 154, 64, 203, 66, 214, 209, 251, 17, 171, 241, 116, 99,
    49, 24, 207, 67, 183, 242, 1, 219, 57, 204, 33, 57, 200, 161, 158, 84, 43, 24, 36, 82, 245,
    187, 151, 185, 71, 167, 229, 193, 41, 23, 233, 78, 136, 89, 28, 44, 80, 111, 119, 139, 249,
    197, 178, 139, 3, 30, 39, 233, 30, 66, 3, 175, 26, 114, 92, 60, 83, 39, 197, 155, 161, 215,
    118, 132, 210, 155, 51, 74, 247, 2, 156, 0, 252, 216, 123, 106, 221, 15, 167, 154, 163, 232,
    167, 106, 153, 66, 29, 210, 115, 142, 231, 22, 230, 229, 54, 183, 212, 118, 179, 51, 176, 65,
    88, 77, 177, 226, 104, 159, 235, 23, 48, 1, 219, 212, 91, 160, 225, 241, 224, 164, 36, 6, 72,
    125, 102, 220, 126, 50, 46, 49, 82, 212, 175, 23, 106, 18, 209, 37, 75, 73, 250, 138, 66, 100,
    224, 189, 146, 147, 58, 156, 250, 22, 169, 140, 105, 206, 3, 182, 61, 23, 2, 201, 28, 228, 21,
    171, 21, 161, 139, 41, 142, 0, 29, 86, 129, 83, 154, 159, 74, 73, 225, 2, 23, 35, 179, 107,
    235, 19, 92, 103, 213, 38, 60, 200, 89, 73, 223, 232, 179, 83, 25, 88, 195, 109, 51, 150, 154,
    114, 123, 14, 217, 86, 182, 46, 158, 36, 93, 161, 0, 158, 74, 121, 190, 225, 159, 115, 190, 8,
    164, 212, 23, 42, 135, 52, 45, 249, 11, 6, 2, 71, 78, 81, 39, 187, 68, 247, 197, 0, 189, 133,
    223, 22, 117, 177, 165, 24, 114, 115, 223, 1, 92, 9, 136, 51, 168, 181, 129, 158, 125, 69, 189,
    143, 45, 64, 17, 207, 207, 39, 124, 86, 229, 227, 212, 129, 135, 84, 240, 204, 17, 204, 15,
    209, 30, 201, 217, 177, 205, 12, 114, 65, 6, 33, 247, 196, 104, 70, 4, 99, 234, 99, 179, 140,
    154, 174, 189, 85, 125, 186, 133, 60, 21, 121, 180, 76, 28, 99, 111, 7, 109, 121, 128, 183,
    192, 114, 174, 121, 55, 4, 234, 80, 61, 116, 237, 66, 116, 161, 73, 119, 34, 22, 17, 220, 151,
    91, 50, 46, 103, 157, 55, 43, 80, 231, 143, 210, 41, 127, 201, 81, 34, 139, 107, 78, 202, 2,
    99, 46, 152, 123, 119, 229, 87, 27, 233, 49, 0, 149, 163, 251, 59, 239, 102, 148, 205, 138, 76,
    166, 244, 234, 231, 50, 5, 76, 183, 63, 55, 6, 225, 204, 13, 186, 45, 149, 64, 142, 29, 88, 24,
    199, 218, 211, 3, 144, 41, 157, 128, 120, 21, 55, 89, 22, 87, 116, 27, 62, 220, 122, 168, 143,
    162, 177, 98, 206, 240, 187, 158, 145, 223, 160, 226, 212, 30, 61, 231, 71, 147, 160, 233, 47,
    19, 125, 5, 252, 99, 195, 35, 160, 192, 96, 211, 244, 208, 132, 132, 45, 129, 125, 197, 103,
    236, 242, 176, 241, 61, 139, 94, 150, 163, 88, 213, 190, 100, 237, 203, 144, 198, 170, 158, 84,
    143, 225, 10, 150, 186, 109, 102, 214, 19, 242, 76, 194, 235, 66, 94, 85, 227, 227, 125, 106,
    24, 37, 178, 158, 106, 115, 154, 112, 168, 113, 74, 206, 59, 104, 141, 249, 144, 22, 76, 229,
    138, 53, 187, 254, 144, 118, 215, 150, 180, 129, 23, 81, 150, 75, 41, 237, 227, 212, 77, 196,
    168, 173, 50, 101, 196, 97, 63, 209, 12, 107, 135, 198, 203, 220, 246, 159, 215, 133, 236, 78,
    237, 238, 169, 19, 79, 143, 2, 41, 61, 240, 174, 48, 203, 10, 107, 158, 155, 149, 110, 168,
    102, 27, 129, 102, 146, 124, 234, 0, 215, 88, 59, 178, 37, 219, 106, 164, 90, 176, 252, 222,
    34, 212, 40, 245, 236, 4, 111, 146, 209, 100, 110, 1, 230, 63, 56, 131, 211, 201, 12, 219, 198,
    208, 28, 149, 186, 16, 133, 180, 99, 231, 231, 46, 113, 231, 48, 0, 216, 163, 102, 146, 67, 49,
    73, 173, 89, 246, 90, 116, 61, 52, 12, 154, 52, 79, 110, 59, 56, 119, 58, 92, 114, 68, 200,
    243, 149, 172, 145, 88, 210, 23, 98, 129, 71, 156, 254, 19, 156, 118, 133, 232, 237, 230, 41,
    103, 101, 9, 132, 175, 102, 112, 101, 203, 165, 4, 240, 109, 106, 210, 190, 106, 130, 122, 142,
    93, 117, 29, 158, 230, 138, 198, 72, 200, 171, 93, 25, 49, 210, 106, 222, 53, 20, 32, 13, 92,
    209, 58, 32, 157, 49, 167, 54, 38, 200, 198, 62, 227, 18, 111, 51, 9, 171, 184, 92, 50, 152,
    192, 37, 129, 99, 69, 83, 231, 82, 131, 226, 114, 161, 156, 206, 117, 108, 235, 186, 41, 7, 90,
    193, 38, 238, 153, 39, 88, 68, 79, 97, 87, 152, 6, 133, 123, 53, 108, 230, 112, 232, 161, 96,
    110, 188, 175, 79, 118, 188, 154, 135, 23, 124, 160, 93, 96, 13, 114, 51, 17, 145, 66, 217,
    178, 39, 55, 158, 226, 224, 250, 203, 36, 8, 179, 243, 55, 249, 131, 145, 154, 67, 67, 55, 71,
    252, 131, 27, 252, 164, 8, 134, 37, 250, 251, 131, 196, 103, 37, 56, 72, 243, 250, 194, 124,
    202, 255, 52, 214, 115, 14, 232, 214, 112, 48, 185, 174, 220, 246, 79, 224, 174, 50, 54, 217,
    197, 66, 22, 27, 164, 239, 180, 167, 125, 78, 149, 159, 232, 55, 51, 163, 180, 6, 171, 170,
    189, 246, 141, 81, 190, 168, 94, 96, 74, 221, 211, 193, 182, 54, 135, 82, 109, 226, 150, 105,
    252, 94, 97, 93, 115, 251, 139, 172, 53, 72, 0, 166, 114, 129, 108, 50, 220, 181, 247, 41, 104,
    98, 116, 233, 45, 231, 220, 48, 70, 178, 19, 2, 244, 138, 52, 33, 93, 67, 167, 154, 80, 12,
    188, 106, 105, 226, 94, 49, 103, 251, 236, 7, 70, 88, 51, 8, 33, 181, 235, 130, 117, 242, 105,
    12, 43, 17, 83, 72, 254, 176, 255, 207, 252, 186, 155, 68, 57, 17, 15, 78, 236, 241, 205, 154,
    1, 73, 184, 123, 74, 57, 116, 101, 246, 101, 253, 250, 112, 84, 224, 177, 226, 198, 155, 58,
    165, 161, 12, 148, 151, 228, 88, 144, 10, 60, 191, 246, 246, 237, 10, 93, 83, 229, 245, 132,
    62, 184, 205, 158, 101, 42, 232, 135, 23, 35, 141, 36, 15, 168, 169, 60, 203, 231, 72, 106,
    140, 179, 52, 74, 58, 169, 9, 112, 189, 113, 230, 85, 108, 190, 36, 218, 155, 170, 119, 65,
    136, 82, 196, 221, 193, 147, 228, 240, 227, 133, 14, 230, 23, 142, 184, 124, 100, 14, 91, 220,
    14, 74, 207, 57, 137, 63, 229, 71, 18, 161, 11, 217, 18, 15, 162, 103, 159, 137, 31, 177, 195,
    103, 175, 126, 58, 255, 24, 144, 76, 99, 174, 149, 155, 226, 208, 132, 214, 198, 9, 126, 227,
    106, 115, 222, 61, 115, 19, 180, 27, 92, 49, 164, 196, 7, 129, 78, 147, 199, 40, 162, 73, 150,
    179, 191, 77, 18, 54, 147, 9, 25, 94, 19, 207, 85, 163, 98, 75, 233, 235, 233, 167, 42, 100,
    50, 143, 203, 195, 29, 237, 50, 154, 210, 198, 61, 159, 132, 124, 194, 90, 160, 63, 177, 86,
    117, 159, 132, 179, 14, 19, 137, 74, 77, 12, 54, 215, 83, 237, 233, 65, 171, 81, 173, 146, 226,
    202, 234, 144, 167, 134, 53, 163, 200, 194, 22, 180, 234, 65, 107, 136, 191, 135, 82, 180, 70,
    82, 61, 130, 205, 226, 12, 247, 199, 45, 184, 10, 157, 47, 190, 118, 132, 176, 67, 233, 102,
    100, 226, 243, 36, 100, 209, 173, 196, 192, 26, 31, 88, 46, 218, 163, 157, 28, 0, 193, 6, 31,
    120, 89, 249, 48, 203, 103, 188, 61, 231, 195, 93, 234, 199, 192, 101, 228, 23, 106, 67, 122,
    231, 31, 11, 82, 193, 152, 143, 31, 207, 216, 152, 143, 120, 211, 184, 186, 62, 57, 231, 120,
    14, 25, 220, 123, 25, 94, 245, 152, 169, 225, 246, 3, 131, 75, 25, 136, 128, 76, 161, 10, 112,
    104, 56, 93, 79, 98, 246, 193, 8, 203, 74, 156, 178, 58, 100, 223, 155, 46, 102, 52, 82, 129,
    123, 154, 116, 204, 242, 48, 65, 114, 214, 189, 211, 39, 206, 244, 215, 83, 193, 18, 91, 86,
    22, 245, 123, 69, 134, 143, 40, 53, 156, 105, 163, 66, 237, 15, 210, 163, 66, 47, 247, 33, 198,
    30, 231, 188, 10, 253, 179, 8, 219, 158, 212, 6, 214, 120, 139, 131, 182, 62, 136, 45, 253,
    225, 206, 37, 123, 173, 113, 48, 34, 84, 44, 16, 250, 185, 70, 242, 49, 19, 13, 221, 251, 2,
    70, 58, 97, 150, 45, 239, 252, 197, 144, 47, 171, 138, 194, 84, 194, 177, 178, 184, 4, 249, 78,
    214, 14, 17, 133, 210, 61, 81, 250, 153, 219, 133, 63, 108, 246, 232, 14, 204, 226, 92, 157,
    134, 167, 159, 8, 40, 210, 112, 142, 125, 213, 82, 78, 107, 45, 162, 43, 111, 134, 148, 142,
    119, 31, 227, 93, 213, 87, 218, 112, 93, 176, 43, 184, 196, 6, 67, 60, 160, 103, 145, 43, 118,
    38, 27, 167, 158, 179, 251, 6, 58, 128, 49, 177, 135, 252, 225, 191, 67, 24, 234, 233, 118,
    112, 108, 57, 165, 150, 75, 48, 192, 251, 6, 101, 59, 214, 171, 23, 3, 133, 213, 183, 233, 219,
    122, 45, 88, 61, 10, 202, 106, 233, 100, 53, 106, 1, 130, 101, 83, 234, 28, 136, 136, 114, 118,
    250, 114, 80, 118, 59, 67, 253, 150, 246, 56, 29, 85, 236, 117, 32, 253, 189, 192, 90, 70, 117,
    18, 174, 210, 226, 2, 26, 209, 68, 197, 59, 176, 13, 119, 31, 58, 168, 208, 72, 225, 250, 119,
    162, 85, 189, 224, 22, 148, 132, 130, 253, 165, 115, 0, 194, 177, 116, 202, 53, 89, 113, 130,
    231, 158, 131, 1, 43, 88, 155, 52, 57, 2, 202, 134, 126, 90, 152, 112, 169, 71, 233, 249, 27,
    243, 132, 125, 43, 63, 198, 182, 226, 210, 201, 241, 5, 47, 103, 177, 60, 50, 113, 158, 144,
    92, 52, 63, 138, 6, 32, 8, 82, 209, 130, 106, 61, 173, 217, 142, 8, 182, 13, 52, 169, 243, 245,
    213, 198, 141, 81, 203, 76, 164, 145, 197, 143, 221, 155, 105, 185, 9, 101, 8, 100, 5, 45, 26,
    74, 232, 146, 77, 182, 86, 86, 155, 55, 215, 195, 252, 107, 92, 17, 62, 55, 93, 32, 209, 75,
    37, 153, 248, 207, 118, 215, 12, 37, 242, 209, 32, 85, 20, 42, 22, 141, 66, 48, 217, 217, 55,
    250, 149, 248, 119, 172, 170, 78, 66, 229, 148, 255, 22, 42, 35, 135, 182, 150, 1, 193, 249,
    136, 143, 102, 144, 67, 43, 146, 101, 62, 119, 200, 68, 124, 232, 74, 80, 78, 200, 214, 72,
    131, 222, 208, 57, 160, 87, 46, 41, 173, 10, 42, 175, 159, 56, 154, 202, 183, 226, 6, 95, 247,
    114, 64, 0, 252, 73, 90, 213, 25, 174, 40, 225, 186, 7, 192, 204, 121, 208, 136, 171, 230, 84,
    26, 1, 254, 206, 185, 81, 135, 134, 101, 115, 161, 66, 80, 212, 93, 44, 139, 203, 232, 97, 200,
    173, 148, 213, 156, 94, 122, 110, 212, 134, 197, 8, 239, 198, 32, 63, 136, 86, 63, 229, 188,
    242, 138, 120, 31, 24, 224, 107, 169, 170, 233, 111, 169, 209, 68, 71, 178, 39, 91, 235, 52,
    59, 113, 146, 158, 156, 157, 222, 240, 47, 248, 210, 239, 185, 26, 13, 203, 44, 227, 212, 221,
    68, 250, 107, 244, 168, 245, 73, 205, 22, 58, 17, 3, 29, 67, 15, 219, 24, 69, 177, 113, 128,
    183, 191, 59, 213, 196, 238, 129, 126, 23, 56, 244, 133, 39, 253, 85, 12, 209, 253, 184, 224,
    75, 69, 132, 179, 17, 252, 100, 129, 120, 22, 5, 68, 5, 121, 1, 189, 45, 119, 2, 165, 4, 144,
    203, 121, 180, 122, 24, 86, 162, 218, 223, 1, 69, 99, 79, 248, 111, 221, 241, 242, 75, 94, 92,
    153, 76, 148, 185, 222, 170, 213, 21, 241, 181, 74, 141, 99, 254, 97, 125, 4, 229, 136, 162,
    175, 194, 185, 44, 113, 118, 210, 176, 118, 135, 250, 27, 69, 132, 99, 209, 157, 123, 102, 18,
    242, 168, 168, 171, 208, 36, 209, 190, 235, 181, 80, 242, 44, 5, 127, 93, 44, 214, 167, 232,
    188, 218, 184, 78, 6, 239, 173, 84, 59, 172, 75, 9, 124, 86, 158, 156, 150, 54, 56, 93, 81, 2,
    39, 131, 77, 152, 63, 245, 128, 34, 206, 152, 202, 210, 226, 76, 11, 197, 44, 215, 252, 16, 64,
    146, 92, 83, 197, 6, 155, 126, 137, 66, 60, 251, 222, 118, 228, 186, 8, 224, 120, 133, 47, 220,
    128, 126, 247, 76, 121, 40, 147, 243, 192, 121, 164, 37, 99, 137, 22, 12, 39, 50, 50, 182, 125,
    170, 233, 148, 157, 231, 117, 23, 114, 239, 181, 253, 234, 167, 229, 70, 234, 26, 14, 176, 98,
    140, 154, 20, 48, 20, 173, 186, 8, 190, 214, 140, 8, 38, 140, 120, 70, 90, 214, 203, 8, 244,
    34, 172, 168, 213, 30, 125, 169, 135, 36, 9, 148, 193, 111, 26, 149, 235, 162, 194, 210, 4, 20,
    39, 212, 40, 230, 2, 220, 131, 48, 204, 119, 49, 96, 236, 155, 24, 116, 2, 97, 158, 239, 23,
    156, 71, 142, 31, 174, 144, 250, 68, 101, 196, 65, 177, 82, 39, 48, 124, 153, 42, 186, 238, 69,
    206, 94, 231, 39, 166, 144, 155, 61, 33, 203, 167, 191, 30, 42, 195, 169, 192, 142, 18, 41, 77,
    54, 189, 119, 3, 27, 20, 147, 131, 62, 198, 146, 135, 175, 208, 91, 112, 221, 2, 160, 214, 1,
    167, 121, 217, 73, 103, 11, 94, 171, 80, 71, 221, 44, 5, 181, 218, 202, 17, 153, 7, 34, 51, 60,
    224, 51, 13, 195, 230, 238, 45, 51, 130, 248, 196, 72, 172, 25, 34, 239, 122, 3, 174, 57, 0,
    132, 9, 90, 143, 197, 232, 23, 94, 227, 254, 209, 227, 116, 166, 5, 3, 4, 157, 168, 113, 72,
    94, 85, 80, 152, 20, 94, 12, 65, 92, 215, 13, 250, 228, 207, 176, 32, 129, 94, 2, 149, 221,
    241, 37, 48, 175, 207, 102, 34, 178, 236, 188, 227, 65, 99, 133, 36, 5, 3, 50, 10, 157, 190,
    235, 196, 88, 151, 12, 121, 52, 165, 216, 185, 152, 187, 81, 136, 74, 186, 82, 215, 129, 136,
    157, 197, 102, 23, 187, 217, 64, 148, 112, 213, 158, 109, 20, 36, 246, 122, 15, 244, 156, 52,
    100, 157, 185, 76, 219, 137, 117, 79, 155, 35, 42, 218, 157, 175, 196, 68, 131, 133, 51, 192,
    75, 243, 135, 14, 203, 52, 53, 223, 147, 87, 195, 168, 209, 192, 150, 212, 53, 227, 89, 217,
    13, 225, 10, 218, 118, 234, 3, 24, 43, 19, 206, 130, 60, 84, 246, 233, 173, 23, 105, 115, 18,
    119, 193, 149, 191, 190, 242, 222, 219, 75, 187, 199, 149, 202, 131, 113, 123, 102, 109, 48,
    198, 45, 18, 153, 111, 13, 161, 253, 246, 17, 87, 130, 171, 160, 98, 175, 242, 24, 238, 75,
    220, 182, 131, 185, 69, 120, 228, 169, 156, 71, 88, 28, 87, 45, 209, 169, 195, 222, 165, 70,
    179, 205, 42, 36, 101, 203, 118, 248, 61, 28, 83, 85, 164, 255, 38, 241, 98, 243, 252, 90, 101,
    169, 3, 251, 61, 139, 103, 123, 173, 209, 125, 67, 56, 31, 65, 91, 218, 26, 165, 130, 73, 133,
    110, 89, 20, 162, 69, 120, 44, 95, 100, 113, 76, 121, 185, 136, 209, 97, 126, 230, 132, 40, 79,
    253, 73, 18, 84, 88, 42, 242, 112, 244, 103, 188, 154, 8, 222, 15, 82, 171, 247, 247, 73, 252,
    40, 124, 220, 140, 5, 56, 124, 191, 73, 165, 35, 231, 243, 173, 45, 75, 105, 143, 228, 110, 98,
    66, 78, 57, 86, 21, 7, 149, 81, 80, 120, 218, 106, 252, 251, 167, 144, 227, 125, 180, 240, 83,
    30, 74, 250, 100, 9, 178, 54, 226, 100, 135, 19, 26, 69, 173, 80, 105, 204, 245, 69, 15, 143,
    98, 30, 225, 51, 164, 245, 62, 72, 166, 199, 54, 135, 230, 204, 29, 184, 179, 243, 168, 160,
    230, 169, 93, 229, 176, 212, 217, 244, 16, 86, 159, 250, 97, 111, 236, 89, 136, 216, 50, 73,
    37, 93, 184, 120, 156, 122, 15, 146, 188, 18, 53, 54, 173, 205, 74, 241, 103, 129, 196, 108,
    21, 23, 169, 0, 168, 102, 33, 39, 105, 223, 250, 126, 178, 187, 135, 76, 8, 25, 18, 117, 168,
    233, 128, 85, 176, 30, 50, 173, 101, 62, 198, 58, 161, 106, 70, 103, 167, 203, 239, 211, 148,
    74, 201, 158, 177, 142, 158, 111, 82, 129, 27, 68, 207, 157, 228, 18, 49, 73, 110, 146, 62, 51,
    81, 241, 90, 254, 174, 243, 96, 201, 246, 237, 111, 164, 228, 241, 146, 7, 196, 62, 163, 32,
    89, 104, 174, 213, 206, 202, 164, 113, 135, 55, 132, 146, 190, 38, 138, 136, 16, 127, 98, 162,
    143, 10, 185, 107, 193, 182, 143, 181, 209, 110, 193, 175, 34, 250, 142, 235, 65, 91, 206, 147,
    163, 75, 164, 95, 21, 78, 201, 87, 223, 59, 83, 253, 183, 0, 197, 211, 47, 35, 214, 251, 40,
    175, 141, 189, 105, 250, 237, 103, 13, 223, 213, 166, 254, 135, 67, 242, 222, 29, 204, 212, 49,
    113, 219, 244, 25, 219, 80, 244, 254, 132, 243, 61, 142, 46, 62, 70, 148, 127, 132, 47, 0, 160,
    3, 223, 70, 19, 120, 2, 19, 176, 55, 53, 20, 29, 143, 185, 211, 157, 228, 173, 93, 183, 53,
    101, 239, 88, 68, 220, 159, 97, 26, 140, 227, 45, 14, 215, 185, 108, 12, 37, 35, 144, 96, 121,
    236, 137, 72, 157, 4, 198, 114, 37, 61, 9, 133, 141, 154, 138, 167, 25, 248, 196, 26, 237, 182,
    251, 130, 177, 250, 152, 86, 223, 224, 58, 150, 99, 196, 35, 228, 10, 52, 235, 170, 44, 197,
    207, 56, 157, 20, 110, 124, 150, 89, 64, 15, 132, 86, 46, 176, 2, 84, 174, 33, 115, 32, 7, 214,
    118, 226, 140, 199, 3, 201, 29, 85, 105, 178, 33, 176, 124, 187, 63, 87, 215, 178, 228, 139,
    204, 42, 152, 239, 152, 9, 203, 200, 207, 247, 104, 144, 35, 3, 103, 99, 164, 219, 32, 239,
    173, 130, 135, 192, 124, 179, 125, 91, 47, 77, 144, 74, 88, 53, 137, 244, 131, 123, 95, 55,
    172, 124, 221, 33, 235, 26, 31, 221, 249, 205, 121, 179, 161, 46, 55, 132, 32, 87, 136, 109,
    56, 104, 86, 85, 232, 48, 27, 56, 107, 11, 239, 231, 41, 182, 252, 102, 182, 238, 67, 205, 25,
    82, 90, 120, 73, 52, 213, 80, 163, 3, 162, 153, 56, 136, 64, 213, 90, 247, 61, 101, 104, 254,
    41, 209, 61, 79, 113, 35, 182, 114, 35, 218, 234, 5, 183, 85, 149, 250, 168, 97, 255, 146, 92,
    87, 235, 116, 59, 203, 97, 170, 197, 177, 218, 81, 194, 185, 221, 70, 63, 16, 34, 8, 121, 168,
    191, 147, 234, 95, 182, 66, 84, 248, 4, 178, 151, 152, 51, 47, 224, 50, 0, 40, 157, 100, 202,
    250, 195, 224, 230, 186, 30, 129, 24, 175, 108, 189, 192, 115, 194, 149, 207, 64, 221, 234, 26,
    1, 28, 158, 138, 164, 217, 72, 108, 192, 173, 106, 232, 129, 90, 254, 244, 71, 226, 198, 47,
    228, 52, 182, 55, 98, 103, 194, 144, 223, 115, 187, 103, 116, 36, 214, 59, 230, 12, 3, 35, 74,
    25, 28, 5, 176, 167, 170, 213, 71, 22, 163, 41, 163, 89, 111, 13, 173, 131, 21, 46, 238, 42,
    218, 17, 187, 37, 166, 250, 147, 24, 21, 57, 180, 7, 177, 205, 254, 8, 122, 6, 16, 196, 57,
    122, 66, 81, 86, 97, 94, 44, 151, 82, 189, 128, 172, 38, 43, 8, 197, 5, 5, 90, 95, 119, 148,
    255, 207, 76, 221, 143, 239, 148, 231, 176, 18, 118, 22, 191, 236, 88, 141, 17, 94, 202, 26,
    224, 212, 31, 247, 178, 147, 156, 150, 192, 99, 13, 209, 29, 219, 21, 141, 196, 130, 11, 33,
    236, 101, 94, 124, 247, 20, 244, 214, 75, 29, 188, 7, 211, 94, 222, 238, 175, 149, 74, 111,
    104, 76, 169, 94, 235, 146, 19, 241, 111, 145, 158, 174, 68, 107, 183, 159, 116, 83, 188, 123,
    136, 56, 114, 75, 113, 246, 89, 121, 76, 208, 87, 93, 243, 183, 78, 51, 188, 34, 134, 28, 23,
    155, 222, 72, 29, 8, 190, 227, 28, 213, 155, 45, 208, 86, 113, 2, 228, 250, 39, 98, 248, 209,
    65, 163, 202, 47, 178, 53, 28, 28, 98, 91, 131, 5, 165, 114, 51, 46, 172, 152, 175, 239, 222,
    26, 181, 189, 165, 202, 18, 179, 41, 238, 195, 200, 247, 139, 155, 100, 197, 193, 58, 128, 227,
    204, 228, 84, 158, 251, 93, 175, 50, 83, 158, 244, 144, 95, 118, 250, 207, 231, 195, 92, 208,
    182, 162, 176, 107, 236, 168, 224, 203, 178, 112, 17, 200, 204, 216, 99, 220, 140, 133, 78,
    189, 45, 19, 90, 196, 118, 49, 205, 213, 0, 247, 95, 51, 203, 70, 251, 13, 14, 65, 22, 11, 95,
    142, 22, 103, 175, 118, 45, 71, 126, 26, 165, 20, 103, 193, 108, 104, 245, 49, 89, 198, 26,
    251, 120, 118, 243, 148, 237, 29, 50, 158, 205, 200, 21, 73, 50, 194, 56, 82, 221, 191, 67, 92,
    180, 152, 151, 6, 99, 246, 211, 98, 91, 199, 142, 231, 246, 74, 13, 20, 117, 36, 230, 188, 42,
    37, 110, 239, 89, 67, 61, 243, 106, 166, 231, 199, 199, 59, 247, 189, 199, 88, 237, 168, 81,
    84, 131, 81, 43, 97, 49, 93, 234, 255, 94, 7, 42, 209, 173, 46, 213, 2, 65, 168, 62, 230, 237,
    110, 73, 240, 88, 216, 97, 91, 103, 227, 6, 152, 89, 123, 23, 31, 26, 193, 63, 39, 169, 63, 82,
    220, 163, 3, 114, 3, 199, 54, 20, 175, 212, 54, 69, 188, 116, 34, 82, 192, 171, 194, 29, 42,
    57, 254, 206, 225, 91, 168, 183, 217, 247, 217, 179, 189, 100, 119, 221, 21, 236, 148, 170,
    100, 154, 55, 9, 223, 197, 67, 1, 187, 147, 91, 199, 177, 96, 3, 91, 20, 34, 167, 140, 83, 25,
    17, 134, 253, 172, 38, 140, 175, 43, 96, 138, 178, 52, 228, 35, 115, 174, 166, 233, 13, 48, 71,
    214, 80, 168, 251, 125, 153, 179, 92, 123, 246, 244, 27, 46, 139, 251, 126, 136, 221, 141, 96,
    192, 64, 41, 229, 212, 136, 25, 59, 227, 144, 3, 57, 244, 209, 15, 28, 6, 222, 31, 220, 151,
    74, 246, 184, 238, 38, 134, 134, 15, 84, 110, 205, 54, 30, 13, 141, 49, 129, 250, 155, 206, 17,
    189, 29, 215, 184, 179, 192, 209, 244, 82, 14, 218, 239, 76, 237, 65, 83, 20, 169, 174, 190,
    27, 163, 108, 248, 39, 235, 198, 211, 200, 114, 217, 34, 186, 75, 22, 58, 14, 250, 249, 188,
    53, 10, 168, 156, 249, 167, 211, 181, 35, 104, 47, 32, 173, 159, 65, 43, 215, 210, 92, 59, 141,
    158, 72, 225, 218, 178, 194, 201, 247, 78, 219, 14, 173, 126, 156, 11, 183, 209, 167, 253, 168,
    113, 97, 146, 208, 5, 229, 253, 143, 109, 71, 25, 214, 122, 115, 85, 243, 196, 249, 118, 123,
    194, 135, 202, 208, 133, 17, 24, 79, 160, 52, 74, 83, 113, 239, 156, 127, 47, 237, 7, 195, 53,
    224, 83, 231, 61, 74, 65, 110, 205, 92, 180, 155, 73, 77, 133, 75, 18, 115, 10, 247, 73, 216,
    48, 190, 190, 62, 193, 44, 123, 220, 197, 101, 9, 132, 200, 19, 143, 34, 94, 191, 122, 20, 79,
    205, 183, 224, 126, 221, 100, 107, 67, 175, 171, 20, 78, 97, 204, 87, 165, 40, 18, 131, 214,
    226, 89, 179, 62, 185, 172, 61, 235, 97, 34, 184, 236, 212, 133, 239, 48, 255, 239, 234, 107,
    249, 177, 197, 80, 2, 215, 159, 169, 159, 100, 24, 127, 245, 139, 85, 168, 127, 12, 122, 68,
    45, 96, 38, 129, 211, 100, 123, 213, 222, 146, 166, 131, 209, 1, 147, 172, 92, 43, 60, 92, 205,
    217, 98, 255, 118, 171, 52, 48, 124, 251, 129, 207, 212, 216, 149, 58, 160, 232, 55, 20, 255,
    14, 128, 114, 8, 64, 144, 53, 132, 116, 137, 136, 144, 131, 183, 141, 72, 64, 184, 234, 72, 9,
    241, 25, 73, 246, 200, 132, 3, 172, 216, 51, 64, 253, 164, 180, 132, 126, 120, 233, 217, 246,
    130, 142, 14, 38, 254, 98, 136, 67, 80, 58, 179, 113, 172, 131, 106, 105, 205, 165, 189, 182,
    43, 227, 199, 214, 203, 252, 227, 8, 116, 250, 24, 53, 165, 61, 51, 172, 244, 38, 179, 177,
    165, 92, 149, 244, 229, 238, 88, 223, 2, 224, 69, 97, 137, 144, 233, 178, 86, 203, 241, 212,
    79, 143, 139, 178, 103, 132, 104, 255, 255, 142, 146, 23, 76, 94, 188, 171, 86, 73, 222, 178,
    233, 236, 111, 217, 142, 5, 102, 155, 225, 107, 60, 5, 194, 181, 8, 1, 25, 203, 210, 189, 217,
    27, 171, 112, 201, 97, 166, 159, 133, 17, 227, 132, 60, 115, 54, 157, 162, 88, 46, 202, 191,
    157, 239, 134, 40, 166, 35, 204, 3, 200, 38, 95, 3, 99, 178, 196, 61, 209, 63, 209, 82, 184,
    196, 185, 163, 243, 28, 11, 5, 250, 80, 142, 230, 73, 161, 225, 114, 15, 75, 116, 161, 166,
    208, 229, 242, 7, 10, 84, 102, 142, 153, 189, 234, 35, 57, 75, 84, 125, 130, 191, 253, 10, 63,
    133, 158, 168, 169, 244, 3, 18, 23, 99, 110, 112, 114, 147, 148, 8, 11, 88, 105, 171, 201, 226,
    232, 4, 62, 158, 170, 186, 147, 152, 154, 212, 249, 252, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 8, 16, 24, 31, 40, 48, 53, 59, 0,
];

const MESSAGE: [u8; 64] = [
    29, 204, 154, 221, 65, 56, 204, 167, 12, 130, 160, 47, 200, 7, 250, 159, 194, 82, 16, 98, 102,
    89, 177, 73, 39, 15, 105, 116, 233, 169, 31, 160, 5, 186, 46, 229, 44, 126, 198, 98, 20, 39,
    194, 203, 249, 170, 183, 196, 80, 111, 6, 194, 23, 17, 183, 73, 119, 95, 8, 123, 190, 17, 14,
    186,
];

const KEY_ID: KeyId = KeyId::KeyId1;

fn test_gen_key_pair() {
    let mut trng = unsafe {
        Trng::new(
            CsrngReg::new(),
            EntropySrcReg::new(),
            SocIfcTrngReg::new(),
            &SocIfcReg::new(),
        )
        .unwrap()
    };
    let mut entropy_gen = || trng.generate().map(|a| a.0);

    // This needs to happen in the first test
    CfiCounter::reset(&mut entropy_gen);

    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    let mut hmac = unsafe { Hmac::new(HmacReg::new()) };
    let key_out_1 = KeyWriteArgs {
        id: KEY_ID,
        usage: KeyUsage::default().set_mldsa_key_gen_seed_en(),
    };

    hmac.hmac(
        &HmacKey::from(&Array4x12::default()),
        &HmacData::from(&[0]),
        &mut trng,
        HmacTag::Key(key_out_1),
        HmacMode::Hmac384,
    )
    .unwrap();

    let seed = KeyReadArgs::new(KEY_ID);
    let public_key = ml_dsa87.key_pair(&seed, &mut trng).unwrap();
    assert_eq!(public_key, Mldsa87PubKey::from(PUBKEY));
}

fn test_sign() {
    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    let mut trng = unsafe {
        Trng::new(
            CsrngReg::new(),
            EntropySrcReg::new(),
            SocIfcTrngReg::new(),
            &SocIfcReg::new(),
        )
        .unwrap()
    };

    let sign_rnd = Mldsa87SignRnd::default(); // Deterministic signing
    let seed = KeyReadArgs::new(KEY_ID); // Reuse SEED

    let signature = ml_dsa87
        .sign(
            &seed,
            &Mldsa87PubKey::from(PUBKEY),
            &MESSAGE.into(),
            &sign_rnd,
            &mut trng,
        )
        .unwrap();

    assert_eq!(signature, Mldsa87Signature::from(SIGNATURE));
}

fn test_verify() {
    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    assert_eq!(
        ml_dsa87
            .verify(
                &Mldsa87PubKey::from(PUBKEY),
                &MESSAGE.into(),
                &Mldsa87Signature::from(SIGNATURE)
            )
            .unwrap(),
        Mldsa87Result::Success
    );
}

fn test_verify_failure() {
    let mut ml_dsa87 = unsafe { Mldsa87::new(MldsaReg::new()) };

    let msg = Mldsa87Msg::from([0xff; 64]);

    assert_eq!(
        ml_dsa87
            .verify(
                &Mldsa87PubKey::from(PUBKEY),
                &msg,
                &Mldsa87Signature::from(SIGNATURE)
            )
            .unwrap(),
        Mldsa87Result::SigVerifyFailed
    );
}

test_suite! {
    test_gen_key_pair,
    test_sign,
    test_verify,
    test_verify_failure,
}
