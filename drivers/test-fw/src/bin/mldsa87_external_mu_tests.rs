/*++

Licensed under the Apache-2.0 license.

File Name:

    ml_dsa87_tests.rs

Abstract:

    File contains test cases for ML_DSA87 API tests

--*/

#![no_std]
#![no_main]

use caliptra_cfi_lib::CfiCounter;
use caliptra_drivers::{
    Mldsa87, Mldsa87PrivKey, Mldsa87PubKey, Mldsa87Result, Mldsa87Seed, Mldsa87SignRnd,
    Mldsa87Signature, Trng,
};
use caliptra_registers::abr::AbrReg;
use caliptra_registers::csrng::CsrngReg;
use caliptra_registers::entropy_src::EntropySrcReg;
use caliptra_registers::soc_ifc::SocIfcReg;
use caliptra_registers::soc_ifc_trng::SocIfcTrngReg;
use caliptra_test_harness::test_suite;

mod acvp_vector {
    /// Test vector from https://github.com/usnistgov/ACVP-Server/blob/master/gen-val/json-files/ML-DSA-sigGen-FIPS204/internalProjection.json
    pub struct AcvpVector {
        /// Public key
        pub pk: [u32; 648],
        /// Private key
        pub sk: [u32; 1224],
        /// External mu to sign/verify
        pub external_mu: [u32; 16],
        // Expected signature. Actual signature size is 4627 bytes, the last word is padded with a zero.
        pub signature: [u32; 1157],
    }

    /// Test vector "tcId": 151
    pub const EXTERNAL_MU_TEST: AcvpVector = AcvpVector {
        pk: [
            0xc8243989, 0xefb40aaa, 0x735fc646, 0x5276eaf9, 0xe73dd5a9, 0xd7374096, 0x13f3d535,
            0x27bf23e3, 0xf4ff4633, 0x583991d5, 0x3f066bb9, 0x3cd09c4e, 0x0ab1cd2d, 0x302df185,
            0x08cd14a1, 0x09c7f0a2, 0x93933536, 0xa0f28cb6, 0xb1f362e0, 0x5a4c6feb, 0xaa281f51,
            0xf1f4e4c2, 0x22281a33, 0xac7164d4, 0x0ad77177, 0xa8f96287, 0x236ea11b, 0x4361f384,
            0xae4db555, 0xd717ee7c, 0xea7c8cc9, 0x239e9f91, 0xa0f2b20c, 0x55471c08, 0x01c4eceb,
            0x7fe0e268, 0x0f84ce7a, 0x150a97f8, 0x2fe677f0, 0xb1f4c195, 0xe7b3a427, 0xcdaf05e3,
            0x4a6eedf6, 0x4337266c, 0x7f8b98d7, 0x7fd76a91, 0x768f0d8e, 0x991b2e1a, 0x9e9d6202,
            0x8b7f0fa2, 0x4bd33950, 0x988953b6, 0x18545915, 0x4f210f15, 0x1e8b4d10, 0x90c4f2b9,
            0x41e57e22, 0x12c51baf, 0xab00e50a, 0x85f458d8, 0xb64a1712, 0x55504738, 0x25bd677f,
            0x421a50fa, 0x0440644e, 0x5ebf3c5c, 0x71f4d31c, 0x645b9c84, 0x1a96b342, 0x83b3d7d0,
            0xceec62bf, 0xdd2df1b0, 0xd68bab02, 0xe98e3772, 0x5e1ed615, 0x87966162, 0x7c12ac43,
            0x1dc68e44, 0x6b7aed4a, 0x1d810e33, 0xb7a47210, 0xad70a78b, 0x64fe868c, 0x716be1ec,
            0x8f4c23e3, 0x0a1c9dfe, 0x5fce90e8, 0x97811b28, 0x7202e2c3, 0xd03d5d38, 0x14217691,
            0x12d523e4, 0xe5645f16, 0x86b1e017, 0xb687ffe5, 0xed536067, 0xddfdd631, 0xa3545939,
            0xab43da6d, 0xe9830809, 0x8396f506, 0xe6090204, 0x7da9d8f2, 0x9cd8a885, 0xeb0c550e,
            0x9dde48e6, 0x7c53f88a, 0x705eb700, 0x66978ffc, 0xebdbb405, 0x4cdadc9c, 0xccd8ae95,
            0x949fbbc3, 0x6724a717, 0xa2f2a7f6, 0x80442d5a, 0xf273d7ef, 0xec69c947, 0xde17c799,
            0xb794c4f0, 0xfcf8fb0b, 0x725663bd, 0x4a512326, 0xfa4ea35c, 0xcfaf8d16, 0x768cc593,
            0xcab845b8, 0x7ff9d9ea, 0xfa15a7bb, 0xbb89ceab, 0xf608c371, 0xfbfa5318, 0x063e8c77,
            0x0c92f396, 0x4de1451e, 0xa7a90445, 0xec4d101d, 0xb9ae75c1, 0x1f965e4a, 0x26a36539,
            0x447c33e2, 0xec55b810, 0x6b9464a4, 0xd356f2ae, 0x09cde584, 0xa5488495, 0xcb606772,
            0xef149716, 0x997dcbc0, 0x52316971, 0xb402c4d5, 0x5f3d0346, 0xb66fb956, 0xcece22ad,
            0x66e0936f, 0x1db47d51, 0xa8c2d30a, 0x6dd6eb78, 0x2c348cdc, 0xb65a3b1f, 0xac255a8b,
            0x0c4f5044, 0xfe364a19, 0x137545ba, 0x074c261b, 0x0f81a5c0, 0xf0ac0a47, 0xf70a927c,
            0xd47bf146, 0x706ca6f0, 0x11b94f27, 0x662756d8, 0x28211d3c, 0x700f2a86, 0x4600ee1f,
            0x5684177b, 0x5871ca74, 0xe40d92fe, 0xb4e09e26, 0x36d5a303, 0x1ad6a923, 0x48129f35,
            0x63a5bb37, 0x1062d9fc, 0x75e69a12, 0x99458303, 0xe4f82142, 0x36ddde4e, 0x53dadfb3,
            0x4c851bc4, 0xe775526e, 0x1b77ec7f, 0x52d247a9, 0x9f74b842, 0x5a74f068, 0xe0a70575,
            0x4e98ded0, 0x8b3b0678, 0xe2559d0f, 0x622ce556, 0x0f5a046e, 0xbe241307, 0x057067be,
            0x1e0f7280, 0x11239211, 0x84b109af, 0x23ab75e8, 0x9e40ef3f, 0xa5c2449c, 0x033aae29,
            0x8bced945, 0x3bac5e84, 0xa2aa1544, 0xd6693a55, 0xeeed9565, 0x4c3aa09e, 0xedb856a4,
            0x23ec13ae, 0x6692544c, 0x83698aba, 0x0a107f6c, 0x6b919148, 0x4c147969, 0x7fe2a243,
            0xe4a26125, 0xde3289f5, 0x1006bbad, 0x60836457, 0x79a74c8a, 0x5f89cbc1, 0x73ba0f9a,
            0xe53ddd84, 0x85197e59, 0x0cfea5f7, 0x3b47a2d9, 0xefaf4837, 0xb5482921, 0x959f4bd9,
            0xa3188da9, 0xa81d2ba4, 0x742cb45e, 0x410d3286, 0x1d78e6c5, 0x00ae0ae6, 0x5d1a6da0,
            0x6256669f, 0x695bdfb8, 0x7b00b31c, 0x6db885aa, 0x26639d1c, 0xb37e144f, 0x72cdb8fb,
            0x8e7b83e3, 0x51ba4e38, 0xdf04d199, 0xf3a08aec, 0x19cde660, 0xa2d4ddeb, 0x22343d6d,
            0xdce095d8, 0xca6c3aeb, 0xf1d4a6dd, 0xe8a410fa, 0xb2d26712, 0x61a52d2a, 0x830b4e54,
            0x5ec12ccb, 0x4d0cd56c, 0x4630a940, 0x80481580, 0xc604cd9c, 0xcdca5e05, 0x481e88e5,
            0x8daba865, 0x245734c5, 0xfa4f3d32, 0x8a97aa20, 0xaa3338ad, 0x4a1e348c, 0xbab6ee34,
            0x4ee88b18, 0xd2f44b58, 0x8f4484f3, 0x31e925e2, 0xf56fbbeb, 0x180b896c, 0x9f6c5e3e,
            0xa55c05cc, 0x117a11da, 0xbd4a00ef, 0xc33aa4d8, 0xe9157caf, 0x1879ea01, 0xd299d05e,
            0x22aaaa6c, 0x8367ca56, 0x91bde9a9, 0x5fd71f8b, 0xffc57459, 0x940eecae, 0xb0024ff3,
            0xa4e833fe, 0x9336b396, 0x63b9c1d4, 0x4ab71bb5, 0x516ec190, 0x63e0017e, 0xc7512e45,
            0x42e80af3, 0x027f738e, 0x1e54aac8, 0x294cbc24, 0x7629deee, 0x6eacc2e9, 0x6728d325,
            0x10189813, 0x3fd2b9ec, 0x0e403a1c, 0x3429c17e, 0x9e84766c, 0x8ecf0c6d, 0xcfc51b61,
            0x6b54ad7a, 0xad005bfc, 0xb4806851, 0x87287123, 0xe1b04085, 0x1a0c239e, 0x6b3b4dc7,
            0xd9a121ec, 0x5f350092, 0xfb74874a, 0x22b6f5e0, 0xa56fd086, 0xaee94505, 0x32d524c5,
            0x26c938d3, 0x3871a105, 0x6fc74a5c, 0xf4c8f9d8, 0x9d24fc2b, 0xef6404aa, 0xd87ffb5d,
            0x6eedf338, 0x5f4b0b71, 0xf9adaf57, 0xc33b5192, 0xd5eb9b3c, 0x2a85bed6, 0x27afc2f9,
            0x5e27526c, 0x826139e6, 0xd8f26ce2, 0x192fee05, 0x88bd5ae1, 0xd71bc743, 0xbfe2fe4b,
            0x079e1b55, 0xf4b7fb3c, 0xf39fe4bd, 0x8813b99a, 0x4b21b882, 0x65e391da, 0x2e2718f0,
            0x308b65d1, 0x9ea23da1, 0x16417119, 0x55ce2efd, 0x936233f4, 0x87021308, 0x26d89562,
            0x26d97801, 0x59e265ae, 0x2f1331d0, 0x2045a99d, 0x5f7d7482, 0xf8d01f7c, 0xa89431e8,
            0xf14d55cc, 0xa9529227, 0x36460494, 0x4de1f8bd, 0x2d1d4ac7, 0x6b5d68cf, 0xba4a1741,
            0x651165ac, 0x38dddea9, 0xafad4e99, 0x0e0df157, 0x9a92c4fa, 0xdd434437, 0x1cd6601f,
            0x66430f9f, 0x5c1e9a2d, 0x0a9f02c2, 0x1640510a, 0x7619c610, 0xfc24cc60, 0xbfb4a0da,
            0xb371a532, 0x5f7e70f7, 0xf4cf289f, 0x639e879a, 0x27a7e8d6, 0x3247032e, 0x893d5456,
            0x18387f78, 0x961b3e2e, 0xe1e0ae85, 0x7f57f54d, 0xd536a067, 0xbda86619, 0x448f4941,
            0x71fcb695, 0x91662b6a, 0x12808e16, 0xa66817d9, 0x5d8ffcd6, 0xf45e51c8, 0xfce4a8aa,
            0xb08efb97, 0x74bbb6f1, 0x9eae6e97, 0xb4104bc7, 0x17d6b6c8, 0x4e413eb7, 0x45ae10f6,
            0xa9624426, 0xc55077bb, 0xd3a8d386, 0x74f67f3b, 0xc5dfa4fe, 0x57f9ca71, 0x308208b4,
            0x531db33d, 0x0fcd9fef, 0xe0a85656, 0xf52ee42d, 0xacfd1028, 0x7f889ceb, 0xa0ff5d9d,
            0x6a494f8a, 0x796d267f, 0x3421ae3b, 0xd136b499, 0x4b3eb9cd, 0x3932d989, 0x1e22e561,
            0x0df14727, 0x38f32517, 0x5ff98d8b, 0xd0d97f62, 0xf17fbe86, 0x6b3ed371, 0x07dc1f4c,
            0x2180d8ef, 0x95b60e18, 0xf2b272de, 0x8c5be2a0, 0x17918bd5, 0xc2ca32a5, 0x0e117366,
            0x4b237a30, 0xcbaec7d2, 0x3472b0f7, 0xb63641ae, 0xf0233a0e, 0x3a79b906, 0x008ca293,
            0x00152275, 0xcf332763, 0xd422bad3, 0xb62042eb, 0x5674e97a, 0x1856e91a, 0xbe0fa44f,
            0x008c1f3c, 0xf3d32819, 0xaa9e13ba, 0x49ad98be, 0x2cc85da7, 0x1158a35d, 0x5197d325,
            0xf1b889a0, 0xf61565b0, 0xb4ae704c, 0xfca421f2, 0x57ca53f8, 0xd6133289, 0xe63c9bdf,
            0x63d05603, 0xf30f2299, 0x737ded61, 0x3f5cdb83, 0xcf56f878, 0x3ca82f1b, 0xa6046340,
            0xbd5ba24f, 0xe9f4e12c, 0x8bae88d7, 0x3206912f, 0x4e061606, 0x2a8b440b, 0x3d610a84,
            0x5f6ce24d, 0x59367f62, 0x06c6996f, 0xa43338f5, 0xd7764b82, 0x4a577465, 0x78c2da14,
            0x0f74ebe8, 0xc01a6e3f, 0x1f4bd1be, 0x0dcb979c, 0x537ed079, 0xd123a1bd, 0xedd2f902,
            0xb860ee16, 0x360f242e, 0x852b4293, 0x8cabeb06, 0xe513c163, 0x8a082be5, 0x96377161,
            0x54a518cc, 0xc0ed83e3, 0xf3ba2b69, 0x698fb68c, 0x21f7705a, 0x649a28a5, 0x432b61c9,
            0xaff99cb6, 0x3c0f79db, 0x32ae1b25, 0xa597be6b, 0xe6289e25, 0xf721eb27, 0x37ceb0c1,
            0x7bcedef0, 0xd3860ac0, 0xb719a59d, 0xe849e9e6, 0x037356bf, 0xccead649, 0xedb51765,
            0xb879c15c, 0x4ec867a3, 0xe258f233, 0xe35d114d, 0xed02514c, 0x621c55ce, 0xee151b44,
            0x577a5f34, 0x171d6c5e, 0xb659f9f3, 0x99533268, 0xc710c844, 0x5b33684c, 0xa9aef28a,
            0x39b0a309, 0x16ec6439, 0xcd2e2742, 0x0ab4bf71, 0x7da76d58, 0x0fec3563, 0xd7471db0,
            0xaa95872b, 0x6761fecc, 0x698d6b06, 0x33d4c163, 0x321c0d86, 0x87ff511d, 0xe943a04d,
            0x4c926c36, 0x6dd0ce37, 0x429d42fe, 0x7fe2b221, 0x21a3c1f9, 0x97b916d6, 0xd348a001,
            0x428fd4aa, 0x8c51b18b, 0x387bfe1e, 0x9bb98b1b, 0x23145bde, 0x915e3747, 0x3458b5eb,
            0x0f2956d9, 0x29caefb8, 0x1cd16d70, 0xa0577b00, 0x3d826788, 0xd7724835, 0xbd726baa,
            0x5ed8d680, 0x461f02e0, 0xded4618c, 0xa37adfb8, 0xf16c7f4d, 0x15f659f2, 0xfbeb58c5,
            0x3d8696e4, 0x353b00ed, 0x1fef385e, 0xda6ef7cb, 0xf978d2d6, 0x743ee9ef, 0x33b49612,
            0x46bf3301, 0xe9b87ad0, 0x65cd0151, 0x9dc6bb5c, 0xebe88e10, 0xe6948730, 0xac7655ef,
            0xc63d9e30, 0x46f67e7e, 0x0fb03959, 0xfcc3edf0, 0x6d8f39c7, 0xf6cb42b2, 0xa66ce9f6,
            0x7a8b1548, 0x734c60ab, 0x193752ec, 0xf7c020cc, 0xac4fedf2, 0x67bbe429, 0x568c03b7,
            0x754d32b3, 0xf10f0e0e, 0x649ceafa, 0x30c244a2, 0x8f5c93ef, 0x545afa7a, 0x761f23b3,
            0xa30b3f18, 0x95b54a50, 0x4f9aea48, 0x28426e77, 0x9d6c359d, 0x73a83f80, 0x0c7ffa6e,
            0x43afc8b5, 0xf6a75f72, 0xf8d50b9b, 0x3ecbd8cd,
        ],
        sk: [
            0xc8243989, 0xefb40aaa, 0x735fc646, 0x5276eaf9, 0xe73dd5a9, 0xd7374096, 0x13f3d535,
            0x27bf23e3, 0x7d103e64, 0x86d3193a, 0x2a970c0a, 0xb674daaa, 0xb7f26dbd, 0x833ca404,
            0xabb4f390, 0xd7d135c9, 0x01027c60, 0xa6240083, 0xecad8514, 0xd4f8281f, 0x9fe555a1,
            0x1d0875f5, 0xbe897945, 0x28789f4c, 0x1b730d13, 0x3988d76d, 0x5a81c880, 0x3dd1c5f8,
            0x94141017, 0xb40285a1, 0x9c42eb06, 0x3ad44bf8, 0x8330c48c, 0x38d341c4, 0x60b4a081,
            0xcb7130a0, 0x369a9194, 0x2136e40e, 0x244db618, 0x369c0482, 0x0d470302, 0x900a4248,
            0x38402480, 0x6e485971, 0x5c902814, 0x80221248, 0x72141980, 0xd009a2d8, 0xc8046110,
            0x85340845, 0x21661503, 0x08886db9, 0x32165181, 0x4491904c, 0x96c27036, 0x61941a60,
            0xe33206d9, 0xb0116220, 0x28029990, 0xc185101a, 0x09014a38, 0x8a221929, 0x9c4cc320,
            0x370a8580, 0x09951b31, 0x9b60a118, 0xa8042d88, 0x6d952250, 0x19224219, 0x49088920,
            0x2996da46, 0x53843220, 0x920b4c14, 0x25a6920c, 0xca30c8e0, 0xa91a40a8, 0x21a64220,
            0xdb290441, 0x402321a8, 0x31129168, 0xd831b014, 0xb2590088, 0x49c11285, 0x0b2a02a3,
            0x13236a01, 0x41920c48, 0x2108c21a, 0x47086cc0, 0x2610224e, 0x8a2498d4, 0x88cb6cc0,
            0x00886068, 0x408800c2, 0x10102600, 0x08051021, 0xc20986d0, 0x36927148, 0x8c330b8d,
            0x0b82225b, 0x04043107, 0x4008d110, 0x5a249059, 0xb2224606, 0x2c46910d, 0x596d491b,
            0x36505188, 0x20c4c461, 0x820a12e3, 0x08880c10, 0x4526a400, 0xe46e14d0, 0x389991c6,
            0x2a08e392, 0x424a0499, 0x900a4108, 0x08a8c280, 0xa220a8d2, 0x044b8c40, 0x4d92e171,
            0x03643454, 0xb4926203, 0x25a84430, 0x9a41100b, 0xa6d16a26, 0x68c71291, 0x2104b898,
            0x944a09b5, 0x2d361928, 0xd9908909, 0xb4592180, 0x0c308021, 0xcc29a408, 0x289a69b4,
            0x2e40014c, 0xd201941b, 0xb30a70c4, 0x8406d34d, 0x0c0e08a2, 0x90606414, 0x6031226c,
            0xc8311652, 0x05238a16, 0x5116a328, 0x643004a4, 0x808c11b2, 0x4d32c171, 0x02419658,
            0x389c2a44, 0x51802440, 0xa20540a3, 0x34d380c2, 0x61310b2e, 0x512c1821, 0x92242520,
            0x0a042248, 0xa2652249, 0x86108802, 0x40945b89, 0x09463314, 0x92cb6626, 0x8216c12c,
            0x014dc452, 0x845c5210, 0x4c084c60, 0xdb64b501, 0xb28b6c82, 0x9009048d, 0x0c264414,
            0x40d28140, 0x6c04a128, 0x142e40cb, 0x172350a9, 0x90b04111, 0x5a514808, 0xc8236e20,
            0x2cb46205, 0x142c44d2, 0x469b4893, 0x0db5124a, 0xc8004863, 0x14a32610, 0x71481c90,
            0xdc6cc654, 0x30190d38, 0x9244d26a, 0xcc510880, 0x071b8dc0, 0x08b51228, 0x08041689,
            0x945c50b4, 0x89422111, 0x1b2cc521, 0x08204812, 0x40460169, 0xd249b2dc, 0x045c8498,
            0x8816a34d, 0xe444a08c, 0x92146492, 0x05245388, 0x14322294, 0x18602515, 0x4da2a482,
            0x9046341c, 0xb0202dc4, 0x50311421, 0x20303901, 0x27208d97, 0x4510a110, 0x94009251,
            0x08141024, 0x04402405, 0x6111c6c4, 0xc2082508, 0x4e28c221, 0x03618302, 0x24524646,
            0x2c84a061, 0x196e400a, 0x08106849, 0x2190e38c, 0x8c40a45b, 0xc8a44dc0, 0x29224c84,
            0xa3310814, 0x97242144, 0x09c0008c, 0x8a003484, 0x30498886, 0x4a365849, 0x086d8123,
            0x40db89a3, 0x02485020, 0x18693023, 0x28422216, 0x0d826100, 0x5a12180a, 0x32195222,
            0x11a4040c, 0x02913524, 0x42024124, 0x0990e244, 0x182428e1, 0x131b51b2, 0x8da49386,
            0x12040844, 0x968a0827, 0x4d369250, 0xe26032c2, 0x30d12d98, 0x0634e289, 0x0041c119,
            0x46520d44, 0x2da72064, 0x0885888a, 0x265231c8, 0x01190882, 0xc32a2863, 0x35110408,
            0x6d170320, 0x580632da, 0x400a6816, 0x51a48a0c, 0x0a5216a0, 0xb4900883, 0x2c97018c,
            0x9b008819, 0x241b6880, 0x6d185c0e, 0x5a2d311b, 0xa29c0924, 0x90265925, 0x9308a4a0,
            0x86d04a40, 0x50a2244c, 0x24120409, 0x30506513, 0x8c86016a, 0xc345970a, 0x404809c8,
            0x50981a01, 0x1304389b, 0x86e308a5, 0x06452444, 0x83483282, 0x320b6d22, 0x44010808,
            0x588024d9, 0x389a2cc4, 0x28a66201, 0x1a019280, 0x06e02d09, 0x1236646a, 0x0c0c94c2,
            0x36984c45, 0x0926db8a, 0xa44e445c, 0x22248c80, 0x32129b86, 0x138448cb, 0x00635249,
            0x2d308b24, 0x820db823, 0x29189148, 0x0500d371, 0x20709683, 0x229a2519, 0x7130216d,
            0xe42e169b, 0x40dc2c06, 0x2cc60482, 0x0464c049, 0x82136e49, 0x04805169, 0x88640888,
            0x820c1008, 0x46325a45, 0x812c3091, 0xb21a8484, 0x05330001, 0x9a12424b, 0x40629002,
            0x8938448e, 0x9245c890, 0x888b6128, 0x31430b68, 0xa0024320, 0x84cb8c86, 0x4218840c,
            0x926db324, 0xc5020108, 0x26362460, 0x5b201309, 0xa84c64c6, 0x0918da0d, 0x13914001,
            0x99080d04, 0x84948200, 0xa2924291, 0xa8107008, 0x4244a28c, 0xa2260291, 0x02240246,
            0x2d445c8d, 0xa290025b, 0x07240e02, 0x6a184380, 0x6365405b, 0x069b25c6, 0x28c68904,
            0x4109a682, 0xb5214542, 0x2c902281, 0x922a10d9, 0x39088e12, 0x0da2586d, 0x82043022,
            0x024c2438, 0x89348928, 0xc050c650, 0xb0d89046, 0x88a52321, 0x980e1860, 0x37116e12,
            0x6c901169, 0x428c98c3, 0xa2832624, 0x2d88e149, 0x43083489, 0xb8886a26, 0x04145345,
            0x5c094921, 0x910a6090, 0x11144b8d, 0xc1861841, 0x84212d16, 0x2e240c68, 0xd2259001,
            0x12106082, 0x7088904c, 0x0a824712, 0x14802981, 0x2994d061, 0x0084330a, 0xb6192223,
            0x11a6d890, 0x0328b524, 0xb8992c33, 0x60949320, 0x1b421514, 0x110c4a33, 0x0c084460,
            0x99be1e90, 0xc3633112, 0x0e3a98de, 0x7933baac, 0x3c00df50, 0xb9d0caab, 0x1fd9514c,
            0xe60e6870, 0xe218f943, 0x6eb6790b, 0x2be329a3, 0xf4b1bd96, 0x25986420, 0x1e1b01c2,
            0xa89bf8c0, 0x0875fc91, 0x3b9b9c8b, 0x7d400c54, 0x5e90a086, 0xb5f05519, 0x1abb9322,
            0x0ada836a, 0xa88f3be8, 0xa48a0996, 0xe8a012cd, 0xc4dd363f, 0xbfeadf40, 0x9f384156,
            0xe14bca4d, 0x3e6b1e5e, 0x48a27b91, 0xfdc90f38, 0x29220bb7, 0x84824274, 0x42761133,
            0x55f87329, 0x95ee819f, 0xd92cbe80, 0x458aad69, 0xcbbba48a, 0x704d7582, 0x57461dc5,
            0xc1d1761d, 0x71abe7fc, 0x6dfe3f3d, 0x4d7d979f, 0x046dc868, 0xca5fcde5, 0xa918a316,
            0x21d641da, 0x6c86ce40, 0x14e871ee, 0x782c6db3, 0xe6cc8538, 0x3025c6ce, 0x6aa77841,
            0xfb0e7194, 0xb6cc90b3, 0xaccd953a, 0x2cfe93ab, 0x419c00cf, 0xa9676bfc, 0xfaf940f7,
            0x1123231e, 0xbd0099a3, 0x24714aec, 0x1c827764, 0x79fd1a48, 0x910225a9, 0x981981a0,
            0x0e1f6c63, 0x7ca6c302, 0xfcae5de3, 0x2a8f58f0, 0xf8dc18d8, 0x6f07eb43, 0xf110f708,
            0x38512709, 0xd2af3bfa, 0xa4b68c98, 0xf41ffe08, 0x6798f5c9, 0xb31af31a, 0x253a7f08,
            0x48c895d5, 0x5c2efb30, 0x8d827b3e, 0x45d82ce0, 0x8e13d07e, 0x006380b8, 0x7e6c54a0,
            0xbc37de08, 0x4196a130, 0xa5fc9918, 0x0d1f0cac, 0x47de43cd, 0x6e0d6ea8, 0x71c1e101,
            0x01356bb7, 0xde34c427, 0xf7a12efb, 0x63c653db, 0x7c705eec, 0x6a4b606e, 0x332d905b,
            0x91e16123, 0x3f04db42, 0xe485755b, 0xfd7e60c8, 0xcd484011, 0x142982b4, 0xa578367f,
            0x31ffe828, 0x4aca43d9, 0x6bd343d6, 0x4f7570cc, 0x184568f2, 0x3e0f8cfe, 0x520e2975,
            0xeb0488ed, 0x64647f3a, 0x798460fa, 0xc7e65643, 0x710d0fa5, 0x396de1c8, 0x8ed6ab2d,
            0xfc9c57d0, 0x48775a75, 0xb9f9bc4f, 0xd1c9d8b2, 0x51b9f3bf, 0x15aecd96, 0x39bf6172,
            0x78af7bc3, 0x5f6ad800, 0x2f077f97, 0xeb8b0ff9, 0x144b7788, 0x2b32f263, 0xc99519d0,
            0xa9eebd90, 0x0f2b3803, 0xe88e1b3d, 0x031f267d, 0x6770f61c, 0xd308f24c, 0xce93c3a5,
            0x7f53ad6c, 0x982e297b, 0x99a6a0d1, 0x9ee27e34, 0xe7cef355, 0xe6f27b35, 0x870f581c,
            0xa4da7fcc, 0x3d19c88a, 0x02fb3cce, 0x84c6577d, 0xba542117, 0x8478c7b4, 0x430cd6b8,
            0x866c73ef, 0xca037353, 0x71c296e3, 0xec5e2981, 0x9973e118, 0xe16b36aa, 0x3abe5954,
            0x53115de1, 0x21096407, 0x5dc57b63, 0xb65d5430, 0xdc4e98ad, 0xd5f58983, 0x05184482,
            0x91184bd7, 0x0eee18fb, 0xdc694e9f, 0x6daf8d55, 0x785edf3c, 0x524b09f4, 0x62c242cd,
            0x403d1bca, 0xef1016cb, 0xcb43c09f, 0xe185d8cf, 0xedf7164f, 0x9ab83aaa, 0xf3576f62,
            0x8f743d43, 0x3660ab23, 0x75d9e589, 0xa16b8699, 0xd1c65778, 0x3833c81a, 0x362ed2e5,
            0x86835d2a, 0xd8522d6f, 0x6bc9509a, 0x604c4dc6, 0x97b1c225, 0x8d14a2d1, 0xc48c18bc,
            0x0c2bb469, 0xdc00e84c, 0xebfc01d4, 0x4a39f30a, 0x3f502529, 0xf10f3613, 0x14f8c9cf,
            0x550ef3e3, 0x590134fd, 0xc3753cff, 0xd5e328a4, 0xe1f3c5b6, 0x4b3de46b, 0x04ccccd8,
            0x80f4ed24, 0x5a551b09, 0xc02ce9e5, 0x0b73c10b, 0x2bc8a7d4, 0xd8b1df9c, 0xf19f3d3a,
            0x16545781, 0x48615b2a, 0xefe77f0c, 0xd5201867, 0x8416b1a2, 0xc49d5d29, 0x5e8d4dab,
            0x96c67f8a, 0x0166ad81, 0x5eba8943, 0x20aded53, 0x15158d4a, 0x23692f78, 0x16df9077,
            0xad0b7595, 0x1317f327, 0xcbeb935b, 0x6acb6400, 0x07ab8888, 0x91b00275, 0x162aa0f0,
            0xcff0f27f, 0x0872b1fc, 0xeda23e89, 0x695089e9, 0x30137e73, 0x4e3198c8, 0x1a16d4d0,
            0x16464813, 0x6ee5b6a9, 0x7f89a5e0, 0x605ca8dc, 0x5413b798, 0x738fbca6, 0xab4fccb9,
            0x3bf2c7fe, 0x72ff16ad, 0xbadd06fe, 0xfed78ad2, 0x5ab8a398, 0x60373829, 0x6414673f,
            0x9be8c5fb, 0x4d42a472, 0x06f484b4, 0x31029935, 0x55a61ed7, 0x6be540e4, 0x0894cb3a,
            0x358e22c7, 0x2a25b976, 0xfa4730d3, 0xa21fb155, 0x4e64d494, 0x414a8dd4, 0x0c33bf24,
            0xd9125f34, 0x65ef86d3, 0x1769cbb1, 0xf3cd2f6e, 0xe848994e, 0xaff778c9, 0x6b28c97d,
            0x3e4cdacc, 0xa931eb5b, 0x4411d7b2, 0x278b6d8d, 0xe98deb89, 0x724acd28, 0x796e1a1a,
            0x423e4f2c, 0x4aa3333c, 0x64d71ebf, 0xc6597274, 0xaf5f2025, 0x14cd1223, 0x5f2bd807,
            0x98b04e67, 0xdf393b12, 0x90be5f0b, 0xbab19f4b, 0xcd4783ab, 0x0fe58660, 0x78eea5ee,
            0x4f53a37f, 0x0fb09608, 0xa26e0b71, 0xd84d4629, 0x14ec2129, 0x23ccccc2, 0x149ad7cd,
            0xc6aa53d8, 0xf08b234e, 0xd3f58aa5, 0x0e5c0084, 0x188ea9f7, 0x7791365b, 0x7f92c798,
            0x6be69ae7, 0xe8e909a3, 0xc4b93ee3, 0xc7b6a7b8, 0x5a8bce38, 0x8bb0f354, 0xb73fae73,
            0x05012ff4, 0xb8a33104, 0xa6b0f24f, 0x19f46f75, 0xd52c10de, 0xeced14ea, 0x5051abe3,
            0x3d151279, 0xcbc03acd, 0xda9fc0d8, 0x89174f3e, 0x27f005e7, 0x6a07c36d, 0x2687a825,
            0x1a233009, 0x52d9286e, 0x8d2015ad, 0xed0c7b8a, 0x55d51010, 0x8fef932d, 0xc360a9df,
            0x8f007cbd, 0x3ccb44be, 0xda686dde, 0x555ad4b1, 0xce37db50, 0x81bb4257, 0x85d3164a,
            0x6e60674a, 0xab43dcd3, 0xa8341164, 0x16de2172, 0x97224c52, 0x778f5559, 0x7605d3d1,
            0xa15c6d9d, 0xcaa0200e, 0x06902836, 0x3fac59b4, 0xcba8a180, 0x2f2f7a78, 0xdc438226,
            0x1daa4498, 0x3974aa61, 0x05469092, 0x4b473a8f, 0x34ee34ed, 0x5145b37b, 0x25291574,
            0xf02c2721, 0x99b4b110, 0x4f43fe09, 0x8d55f1ab, 0x26d6603d, 0x3303f9c8, 0xf8fae429,
            0x83f80b85, 0x20810258, 0xfdd67075, 0xe38811e5, 0xe8a8b3a6, 0x22f57ec4, 0x43726f48,
            0x1e6c73c3, 0xdfc504a3, 0xd04ea9bd, 0xec0e396e, 0x35dcfbe2, 0x85164ca6, 0x4bf45b75,
            0xfbc0f3ca, 0xaab81cd3, 0x964d9414, 0xf7d21636, 0x4b627c1f, 0xdc97d5e4, 0x7a933863,
            0x76410327, 0x409946a8, 0x41324627, 0x23130a7c, 0xe826df81, 0xc618fad6, 0x375f62f4,
            0x0c912cf4, 0x646f7ad2, 0x0bbd6752, 0x2405f42e, 0x070197be, 0xdc55379b, 0x57f0b741,
            0x8b63f9eb, 0x9e76886f, 0xfd682154, 0xf2c2711e, 0xcae0f7c5, 0xed03dd5d, 0x15492f07,
            0xe3f50bf6, 0xcb5a31c9, 0x2e867858, 0xca10e510, 0x159e3c0e, 0xcdae2c8b, 0x04b4f7d7,
            0xdb172fee, 0xdddab09c, 0xdc90eca5, 0x9a5cfcc7, 0x70c6ecfc, 0xbd1f1a4d, 0x4914b0bc,
            0x1128cbf1, 0xa00f5c44, 0x70cb9994, 0xfb28bdf7, 0xfe7c93ee, 0xe929d9b3, 0x9d42ea8f,
            0x62e0e37f, 0xbbd40ca8, 0x098c92be, 0xa6eced43, 0x1a61a2be, 0x4da054a9, 0xd76a9529,
            0x1871617c, 0xf06b0911, 0x4ea2fdf1, 0x50a9c9b7, 0xcb4aed8b, 0x3b9d41b3, 0xd747cee2,
            0x34e4a3ec, 0x3f0fa067, 0x99cdbfa6, 0x60b5a155, 0xcfcae90e, 0x72f947c2, 0xbfba2b0d,
            0x83e596cc, 0xd31fcf9c, 0x2d768c61, 0x29f351b2, 0x9a00c11e, 0x4811842f, 0x1931e60a,
            0x9c067101, 0x904d9e56, 0xd1502475, 0x3e7bce38, 0xecc03237, 0x42db7228, 0xfd586c9b,
            0xead94185, 0x29be336e, 0x37c424a9, 0xad927b88, 0x158b8e1b, 0x8cbabce8, 0x0802ade5,
            0x50d52c8d, 0xe4d8a7df, 0xe3a40592, 0xb7737909, 0xf0d8ef62, 0xf32d5272, 0xaa2bbc07,
            0x968cb2d2, 0xf05f888b, 0x9a0a859f, 0x83860060, 0x1500b453, 0x65c546aa, 0x8bbb8005,
            0x9da9e57f, 0x6facacf2, 0x1b9a51cb, 0x8a52d9f6, 0xeb2dfd09, 0xe78a02ac, 0xb0910d21,
            0xec342576, 0xc478b97a, 0x6c3068cd, 0xb41067e1, 0x2b0070d9, 0x5b72a78d, 0x7d3b5b7d,
            0xfcc5547f, 0xb100c85e, 0xafaf7230, 0x9ece429b, 0xf11e3d44, 0xa3791f44, 0x0bbd1c73,
            0xd088f680, 0x8d5c21b0, 0x93b563f8, 0x62923899, 0xeaddadf1, 0xb4dc4317, 0x530e70f8,
            0x80d72757, 0xfded56c4, 0xe815ebe3, 0xd58c2080, 0x688744af, 0x7ad27228, 0xedff37f9,
            0xa54d829c, 0x861c6bc9, 0x1f21f82c, 0x73004223, 0x5583f50f, 0xcedb3c94, 0xc9fea982,
            0x3983f37b, 0xabd3927b, 0x28270555, 0x6f81335e, 0x93cad8a4, 0x0813924c, 0xc5b3f764,
            0xe997540e, 0xb7ab9677, 0x2d7da0aa, 0x78f5bb10, 0x6844bb3d, 0x48948f88, 0x274070e3,
            0x9b3eab56, 0x8c1d1618, 0x5520ef07, 0x74838929, 0xb2654d85, 0x762dc6ed, 0x4093c773,
            0x728c9bb3, 0x8c0adedd, 0xb5db1128, 0xb0c5d177, 0x71e00fdd, 0x3c64d16a, 0x99323e0f,
            0x5ba35f78, 0xe858e840, 0xc27a2473, 0xcebddf2f, 0x2fefda33, 0x2da74420, 0x50c0ac12,
            0x6f213fba, 0x00765262, 0x4374b474, 0xd8414925, 0x4a9f6d87, 0x4df520e1, 0x188bb6f3,
            0x6e21748b, 0x823f7238, 0x9c1b85b2, 0x1b0410b2, 0x7ff2bc3f, 0xcc74b844, 0xbb37360f,
            0xf88a2143, 0x8b90293f, 0x299ab72a, 0x617ab6f2, 0xdac13c88, 0xc04f53d7, 0x846fce8a,
            0xd1ee56cb, 0xe3b6c390, 0x0b566f48, 0x26220c68, 0x9c5df85a, 0xe13d30c4, 0x8599a530,
            0xefe675ad, 0x164285dd, 0x2fcad8a0, 0x3dc42d36, 0x5b0f254c, 0x21b1d72d, 0x25a99c59,
            0x60a34a2f, 0x2d7937b9, 0x0eb99da7, 0xce51dd79, 0x3c2fa20b, 0x3f6d7c7c, 0x6599d471,
            0x4eca091f, 0x0d9b9ef6, 0x36c54c6f, 0x250376ff, 0x209ad9fe, 0x01609477, 0x0af08c34,
            0x1cb5b175, 0x50a5111b, 0x24176660, 0x058c6784, 0xc0ceea85, 0x0c6c32ec, 0xc6e0e171,
            0x6c5cb49f, 0xa123fea2, 0xbb47b842, 0x7f047a85, 0x1361536d, 0x0ca8ca90, 0x6d07af4e,
            0x05f1fe74, 0x6130ebda, 0x5ead6eee, 0x1ee6c267, 0x31d7fb2a, 0x276b8311, 0xef09c222,
            0x063bda6c, 0x6323ed6c, 0x661dc4f9, 0x4dfdfcb5, 0x584644e5, 0x2f436e17, 0x4c329091,
            0xc3e2efc7, 0x455953f1, 0x27e1e0d6, 0x60ab2e1d, 0x7ab66ea6, 0x6789d2c9, 0x601f1cd5,
            0xdb18c082, 0x69c7d79c, 0xdd82e314, 0x59a27df8, 0x8acbd77d, 0x7a1f8be2, 0x392df067,
            0xf0fdd543, 0xc77f3335, 0x4674e487, 0xc2e057de, 0x793deca5, 0xc02f4967, 0x3cf38c02,
            0x35adc436, 0x34177e11, 0xe0757b0b, 0xebafa4fb, 0x1e66c721, 0x10d167aa, 0x445169c8,
            0x885a9350, 0x6b1deae6, 0x049e77d1, 0x3e779dbd, 0x39ac151f, 0x81e80d00, 0x46eb09b6,
            0x905ee460, 0x74664584, 0x1c668bcf, 0x23aa7757, 0xe7a8de4e, 0x1dad13a0, 0xd555a2eb,
            0xaa840f75, 0x373e7844, 0x806411c8, 0x22280e95, 0xea798173, 0x37be07b4, 0xc9c65753,
            0xbb4b417b, 0xb466d36b, 0xf75a1acb, 0x725410ca, 0x36ccf2b9, 0x636f387a, 0x491951cf,
            0x5aa8476f, 0x925a2164, 0xa45aa275, 0xe14ba1d3, 0xce092e11, 0xdee6473e, 0x30bc2dcd,
            0x3b907d72, 0xad51a4c8, 0x4ad69b7d, 0xcdf179db, 0x0995a628, 0x3cdb094b, 0xa6eaef22,
            0x04bbe7e3, 0x7605cc67, 0x1d37fe4b, 0xe1fdb734, 0xc4c95107, 0x50ec521b, 0xa1a5129f,
            0x3bfecc56, 0x9c70c0f8, 0x2245828d, 0x22f93af1, 0x549b0087, 0x86b8fa03, 0x03420171,
            0xbe31c4e2, 0x42a3abcd, 0xfdafb7d5, 0xd05ae3fa, 0x5577683a, 0xfbb54bca, 0x2b31e2d4,
            0x5f3798b3, 0xb47de1da, 0xe9beb9d8, 0x3a97df14, 0xb563584f, 0xd12cdf20, 0x2a0a8053,
            0x56fd3c7d, 0x750e0995, 0x9714667f, 0xf304fea9, 0xc5329fda, 0x59b7ffd5, 0xdeb09692,
            0x4e4dc1be, 0x5cfb4d98, 0x12e9c5bb, 0xcabd99b8, 0x8e90145a, 0xbbe4db5a, 0xc5a240b8,
            0xd23c2373, 0x48a2949a, 0xaf19981b, 0x8c2e99cd, 0x899a6cd9, 0xf8d4bf8d, 0xd839510b,
            0x91570f09, 0x998a5d14, 0x2a71c6ec, 0x6e026e77, 0xc8bfdf32, 0x29f7e42f, 0x2558bcca,
            0xc82ffd0f, 0x640115d6, 0x22feab97, 0xdc3175b1, 0x1805d50f, 0xeb5a3e20, 0xf74e8510,
            0x45ffe225, 0xd7dd7a2d, 0x7278c074, 0x2b67a539, 0xbb8a8a4d, 0xab02f5e8, 0xd13878bb,
            0xfe660fd6, 0xd160174e, 0xb0ec0055, 0x92b158fd, 0xd6a1d0f3, 0xaa1966f1, 0x70d9fefd,
            0x60961f62, 0x2f68e81c, 0xf26450f0, 0x43bb1160, 0x141a66c6, 0x2d690508, 0xfe6d3e04,
            0xad1a097e, 0xfbb595fe, 0xd8921368, 0xfd34d4b0, 0x10cad09c, 0xaf3ad32d, 0x3b139d5d,
            0xb02d74c1, 0x5ee3f50a, 0x8c327b0e, 0x71cffc75, 0x215a04f4, 0x29ce8aec, 0x42df96d2,
            0xa3288f79, 0xe30eb5e0, 0xfa6aace1, 0xb01067bf, 0xf5dec1bf, 0x708e203a,
        ],
        external_mu: [
            0xb007f182, 0x605a1141, 0x93369bfc, 0x9a6b8a50, 0x457ed4d8, 0x52e7291b, 0x1161e463,
            0xb2d04ca3, 0x02efe87e, 0x5da85bc9, 0xc03e9b9e, 0x4f522d92, 0xf81643a5, 0x71fd0f9f,
            0xea0cd0f3, 0x3bfcf86f,
        ],
        signature: [
            0xd1476e71, 0xe540e209, 0x6f507b9c, 0x085ca49f, 0xbf9e8671, 0x14c85d6c, 0x62e11e2d,
            0x7c9e1104, 0x1564289f, 0x3dbfb579, 0x0a6a796d, 0x514baee7, 0xd8dab167, 0x7614a9d2,
            0x479c8508, 0x52a7c1aa, 0xb0d53384, 0x7c83e34d, 0x49c185a6, 0x171d1ecf, 0x3d221a19,
            0xa1a6dc94, 0x2be97791, 0x1d0754ef, 0xfc3d6a99, 0x20073b11, 0xdf3164bf, 0xe3e94a4f,
            0xced8b19a, 0xd3a7be27, 0x624eb472, 0xab7cb030, 0xff322000, 0xf95e1eb6, 0x47aabcad,
            0xb641f29c, 0x1cf768a7, 0xa4833d0f, 0x69f1a772, 0xff99d8d2, 0x71ed0454, 0xbef2030f,
            0xb52ff8a6, 0xb61e8054, 0x5d5a9d09, 0xfddb1e2f, 0xf61b730a, 0xa50b7a0b, 0x968c464f,
            0x2239509b, 0x72ab216c, 0x87d17acc, 0x922f61f1, 0x99b91619, 0x11cef6d2, 0xbb5e4a0f,
            0x73c27ad5, 0x6b65bfeb, 0xa2c18b5f, 0xc3d205b2, 0x438f3f1d, 0x18a2069e, 0x52a75439,
            0x78481f86, 0x191555f4, 0x27eb32ff, 0xc7b8392f, 0xfbe3009d, 0xba64d03e, 0xd9ac0b10,
            0x8c422f18, 0xa3f6be30, 0xf5ffc0ea, 0x7335aa5b, 0x28513f91, 0x27331158, 0x1c2f08fd,
            0xae378aa9, 0xad8970f9, 0x435f3115, 0x9b4629eb, 0x3e589fc9, 0x602cfb22, 0xc82c5917,
            0xd9e9f7cf, 0x7c40c717, 0x2b9d56cf, 0x7fd4c3d5, 0x2beeebb1, 0xaa595ccb, 0x5aa8d387,
            0xfdc712ac, 0x9e764710, 0xef812998, 0x60073cc1, 0x78b0d6d7, 0x0309c6b3, 0x1dabe820,
            0xd0251d83, 0x5d1c1d25, 0x96d5cb12, 0xebdbf6de, 0x088c7ab1, 0x7d1a93ab, 0xf968a1ad,
            0x15aa96e9, 0x157e3c60, 0x8d70ab83, 0x64ab4e45, 0x8d834eae, 0xfaf5e219, 0x34053a96,
            0x3d2a192d, 0xba7b8288, 0xfa5d679d, 0x2c9614dc, 0xf596870a, 0x22327f29, 0x893a23f7,
            0xf96f3c7b, 0xd5359101, 0xdb972eee, 0xac4793be, 0xe9d37258, 0xca9f72ae, 0x64f08df5,
            0xd6a6eaa3, 0xf1ab7fa2, 0xea67018f, 0x6d27abac, 0xdd05c929, 0x280b3e17, 0xb98919a8,
            0x8c177e0f, 0xd87ad086, 0xea3ab8fc, 0x2fd247f9, 0x46deb8a3, 0x1a441421, 0x457b698f,
            0xf2d99fee, 0xdff5aec4, 0x6330935d, 0xb037fa8a, 0x87aa9c95, 0x7b195b58, 0x5c662bfb,
            0x22fba96f, 0xc5161b24, 0x54c76d9b, 0xb2f07726, 0xee11f1a2, 0xd72bd48b, 0xf76c593a,
            0x275b687c, 0xe81457f3, 0xc8ca5173, 0x212ec41c, 0x42a027e0, 0x5b5737b1, 0xfad4b26d,
            0x756d4934, 0x83b2dc8d, 0x37c68f67, 0xce30b0f5, 0x7ee72d37, 0xa9a03ea6, 0x208eecaf,
            0x821d6ee8, 0xfe7a809a, 0xba2c5683, 0x174bcbba, 0xd21e9a7e, 0xe687eb9a, 0xa5247a26,
            0x3885622b, 0x051a281e, 0xf2a17817, 0x38b48396, 0x2e0a81d8, 0xa9cc20f8, 0xeea094d8,
            0x244a79ad, 0x7743dfde, 0x7def2383, 0xce157521, 0x63e3e1e2, 0x45c1cd8e, 0x3b802787,
            0x1300f275, 0x6fbffa6e, 0x68a69cec, 0x3c1dc66a, 0xc5a541f2, 0xa664c169, 0xc18b5c1f,
            0x1fd12e4c, 0x6c364de7, 0x39c4c2ad, 0x89b41125, 0xc3d1f30c, 0xb1df20c8, 0xc391d355,
            0x0e2c7e7f, 0x9d469bbb, 0x271ae745, 0x1dd7fe2b, 0x0bebefba, 0xa4eec71b, 0xaf684405,
            0x5667bca7, 0x394d174b, 0xab6c1e7d, 0x22ad9d0f, 0x28ff808b, 0x67db03e9, 0xfc68b0ff,
            0x6cbf19c1, 0x08b3a9b3, 0xba897fed, 0xcbe1e6a8, 0xd6657138, 0x39a867c9, 0x23fbda57,
            0x30181912, 0xfd6922e6, 0x2de738d2, 0xf3e896c1, 0x47bdc3c2, 0xd6c4ee6d, 0x3435d738,
            0x7bd5ec47, 0xcd2133d4, 0xb08978d3, 0x49ba5418, 0x002186b8, 0x5e864f38, 0x81f86378,
            0x8bf33e48, 0xf69f4f94, 0xdcdcf325, 0x6624ed86, 0x04967421, 0x0632d587, 0x4374042f,
            0x5a8d62bf, 0xb6916d69, 0x7375be21, 0x26cca817, 0x5ec7c575, 0x508c0c84, 0x2e55231e,
            0x76d19d19, 0x1d181a4a, 0xac514f2c, 0x12b616f4, 0x5ab27d01, 0x769da6c0, 0xc2f8689f,
            0xd7c7c6e8, 0x06a6591d, 0x9d9c00ea, 0xa0d8ebb1, 0x13bf1c60, 0x5dbb01d0, 0x3ba3f19f,
            0x0b0b189c, 0xac37732e, 0xc010c203, 0x31865af8, 0xc86be617, 0xd95da317, 0x0fa45a6e,
            0x0ef83892, 0x851a8b42, 0x612d307f, 0x00525f48, 0xa1d261fb, 0xb288d6dc, 0x670194ff,
            0xf92cac1a, 0xbc58b617, 0xee9ff570, 0x21a0807c, 0x4a8f5f47, 0xbeb77b33, 0xf762faee,
            0xe51f51a2, 0xa01c6629, 0xa41c6e49, 0xc82dec5a, 0x216c592d, 0x633839a3, 0x8065b344,
            0xc9338356, 0x01e7d7b6, 0x0d0c0748, 0xa70ba77a, 0x0c397e22, 0xbf4a1266, 0xf23eacaf,
            0x29972b6b, 0x570bd120, 0x80c50403, 0x0b7c64eb, 0xe1a2c60e, 0x5f15084e, 0xd75190eb,
            0x15f9e877, 0xc048420d, 0x4dcd78c4, 0x4a8af446, 0xd0ec614c, 0x6b8c5f4f, 0x56aded83,
            0xda50e9d8, 0x293a0305, 0x081fbca5, 0x87aded27, 0xe8939071, 0x2ebc29ba, 0xb7e5baeb,
            0x06fa3850, 0x4655bf52, 0x6b395a89, 0xfaea1fb2, 0x208af1ea, 0xaec08614, 0xde174060,
            0x8087eb2d, 0xdbe5175d, 0x7c3df14f, 0x49f7d0f8, 0x640baf6f, 0x857f5112, 0x956aa0cb,
            0xf8f491f9, 0x99eaaea5, 0x673367d8, 0x72d4ab26, 0xe7986b38, 0xc40eb3fd, 0x9b7a6a8f,
            0x15bf53f9, 0x8a9efa70, 0x71f76f25, 0x54e61eda, 0xfe5d102c, 0x62e6d235, 0x03720b1d,
            0x40432e6d, 0xa32ad988, 0x5b913801, 0x7fab9d90, 0x79d2279b, 0xb9e5fbfa, 0x01848bd2,
            0x552ae89b, 0x92262428, 0x07f8449a, 0x98e60d55, 0xd61101d4, 0x0e07e33c, 0xeaae6cfd,
            0x812616fc, 0x83a1e6a3, 0x8ad5b388, 0x1b06d6a9, 0x672162f1, 0x6a009f46, 0x41762b61,
            0x069041f8, 0xaee86862, 0x2916d21e, 0xeeb5edf9, 0xeb722f6b, 0xe61c7dd7, 0x5085e24a,
            0x72bab09d, 0x88cb3b85, 0xabb5272f, 0x277bb498, 0xdd8b772d, 0xf7758b66, 0x5264ded1,
            0x2138668e, 0x623164e5, 0x9879a822, 0xa8be6351, 0x339286ec, 0x9966ee94, 0x83d553f5,
            0x8e83bb42, 0x9a679b93, 0xdba891f4, 0xa2fe1295, 0x01c0e644, 0xe0830b21, 0xcf3afbe7,
            0xa0199b51, 0xb2344d48, 0x75ac6883, 0x667e80d7, 0xe38a0414, 0x7f3d8ba1, 0xb7eb586f,
            0x6ae4c7c2, 0x4df90974, 0xa1ebc48f, 0x7c296dec, 0x0e1aace0, 0x0b86bd7e, 0x719541f7,
            0x80527347, 0xc1948b70, 0x29deea1f, 0x2b916ec0, 0x47a97b28, 0x53356d4d, 0x32f28b81,
            0xaa499a01, 0xfc94025f, 0x6f1a84e2, 0xad8e08bf, 0x89d89e94, 0xbf6cd013, 0x3de01f4f,
            0xc165601b, 0xd313ae56, 0x2c4acad3, 0xbbbd0676, 0x8b9a5773, 0xf45edd66, 0x588a738d,
            0x3ce56781, 0xc9d23456, 0x4a902570, 0x3fc27d0c, 0x2de30470, 0x1084d74b, 0x842d7b4d,
            0x3062b764, 0xd61b992b, 0x0f60069b, 0x5322cb00, 0xa5bcda8d, 0x89f60864, 0x17745f1e,
            0x0fa00118, 0x2dc3aee4, 0x98858e8a, 0x9d1a338c, 0xdce35346, 0xe7bd13c5, 0x05a210f2,
            0x619b3786, 0x8795e9a4, 0xec16c1f7, 0xb461de29, 0xbc9f3860, 0x9e8397cf, 0x91ed8af3,
            0x04b5d133, 0x27a049fe, 0x8a3baea8, 0xd5c10327, 0x20ab912f, 0x85e53355, 0xaf1aae13,
            0xbd8ed409, 0x761bd809, 0x09b18618, 0xba509517, 0xe1a1bec4, 0x7e8a6f24, 0x2d2de1b2,
            0xcf8b6d12, 0x074c8264, 0x20f72e42, 0x00228e77, 0x3cdfcf72, 0x70d809d3, 0xcc2ee6b2,
            0xd4d471c1, 0x3735459d, 0x992cd846, 0x66903f3a, 0x99011430, 0xeed1da67, 0x26cb9a4b,
            0xaf9bab34, 0xf34d0cc6, 0x785079a2, 0xbb5c66d8, 0x09b3e8cd, 0x396177f9, 0x263f6c51,
            0x8d15bb7b, 0x526ce165, 0x0e206f01, 0x9b84d17a, 0x6d9d8344, 0x203e9a35, 0xb2a06c48,
            0xc3098770, 0x6abf4cda, 0xa3744737, 0x9c3d0643, 0x7df9a85c, 0x08b68b86, 0x4de7bb30,
            0x43e4f440, 0xba111183, 0x86b1b2a3, 0x868b891c, 0xb0bf2284, 0xdd284a67, 0x2d3186b6,
            0x6887a3d1, 0xbf182808, 0xacac09dc, 0x68c960f8, 0x7bea98e9, 0x693cdf55, 0x75f1445b,
            0xe8f268f1, 0x18bb7d6d, 0xc9bed38e, 0x6e9dfd34, 0x1a03e4df, 0x9c57527c, 0x9fbddc11,
            0x332dce41, 0xff239212, 0xcd93f283, 0xbb55f114, 0xc9a8108d, 0xfbc98f60, 0x00a8e170,
            0x21871868, 0xabaa5212, 0x6cfa566e, 0xeb048796, 0xbea69480, 0xd284903d, 0x06804073,
            0xb940c180, 0xe4ea2571, 0xf968e57b, 0x07a77820, 0x509f6101, 0x1bc865f9, 0xeae85357,
            0x337aaa18, 0x0234b149, 0xf3a6df7e, 0xe93fb31b, 0xc157f3d7, 0xb637db85, 0x20ee2996,
            0xc43acb05, 0xdc8b122c, 0x554e4fb2, 0xb9a5e6c1, 0xb1030c83, 0x855cb959, 0xb0dbeb78,
            0x8571ac21, 0xd97a9c05, 0xf196de5f, 0xfc1230b5, 0x0e36ce8d, 0x4b101701, 0x4d01b5df,
            0x9ab48530, 0x24401450, 0x21988788, 0x68acf26f, 0xf3b460eb, 0x11f27855, 0x79ac3499,
            0xbbbde6f5, 0x76dd1704, 0x2f36f735, 0x3afb49b1, 0xf721755e, 0x48204306, 0xbdd9d2fb,
            0x8e653bd1, 0xcf6cacd3, 0xc939b1ef, 0xa88d91b7, 0x7dd6785a, 0x623ccb11, 0x1d09d954,
            0x830c878d, 0x9ef99c74, 0xa6c9596d, 0xf16d6e83, 0x3eb0fadc, 0xf17babcb, 0xef33c0c1,
            0x2ac217e1, 0xe917e165, 0x33841b1a, 0xcfa09764, 0x61057294, 0x88146131, 0xc6819be1,
            0x695177e2, 0x9ec6f33f, 0x1b033664, 0x0d296996, 0xa479c18f, 0x5210ac1f, 0x13298b98,
            0x68615069, 0x04b4d6b4, 0x989fe00b, 0x8cf822b7, 0x1b07293e, 0x3b99520e, 0xe43f7bbb,
            0x5a36eac5, 0xfbc9fe0d, 0xf879e54b, 0x3b240286, 0xb2fc50f4, 0xb2b59896, 0xfc58ba68,
            0x272ad693, 0xfd47731f, 0x976a8f27, 0xdec27b10, 0xd0958d2c, 0x44d9afef, 0x833ab4e5,
            0x6ca59f4d, 0x88a0d669, 0x31dd3179, 0xe7150734, 0xb8d99673, 0xa7ccd521, 0x476ef48e,
            0x9e58829f, 0x60a6e75b, 0x476e05cf, 0x99cb37ab, 0x9d492f5a, 0xcda0a317, 0x9db5c286,
            0x59bfc47d, 0x29489757, 0x18bb52db, 0xb6b685ff, 0xaafebf54, 0xe261c420, 0x257b00f0,
            0x789bf617, 0xb810fffe, 0x1e3d0c33, 0xa96ac57e, 0x6f076d24, 0x905d6f81, 0x2bf9165a,
            0xb14893dc, 0x227fd830, 0xdadebfb8, 0xabcc69ea, 0xa5aee940, 0x4d9fe12e, 0xda58577e,
            0x42244860, 0xee88dd37, 0xf75aa932, 0xf2ccfb2c, 0xda2666f6, 0x72a04ce7, 0x19f19018,
            0xc962659d, 0x51e7118f, 0x0fdce156, 0xbdcb46b1, 0x1862320a, 0x5a75420e, 0x7f0ff2bb,
            0x1114b32d, 0x2ba7c46d, 0xfb739440, 0xe487895a, 0x09e9ab28, 0x1281c656, 0x6cab311a,
            0x6372f6f9, 0xa26310bb, 0xcfaa7553, 0x411bb434, 0x5b594169, 0xcaf6af1b, 0x5045dcce,
            0xbeb18ed1, 0x38c6c485, 0x8654fca2, 0x0ef3a572, 0xbc747982, 0xf8934c0e, 0x96c11ea4,
            0x037108e0, 0x4f366649, 0xdf37584c, 0xb3a50bf7, 0xe2833491, 0xe915c85d, 0xc83a34cc,
            0xe550bc67, 0x66cde5f9, 0x45986907, 0xc0fdfbdd, 0xbc14d55e, 0x330eb0be, 0x5d4542c5,
            0xb95e867b, 0x898215b2, 0x548d7f20, 0x6c371a57, 0x26f2ca78, 0x01344e8c, 0x94650ce1,
            0x109bde1f, 0x93de095a, 0x0ca757a7, 0x5a3319c6, 0x723623b3, 0x73cf7298, 0xcdca7c48,
            0x3de86ed1, 0x06d2254c, 0x2ecc2c0a, 0xf3879fed, 0xce7f5fbc, 0x9878f50f, 0xe9c2a395,
            0x4a6ea137, 0x185ee484, 0xa09af879, 0xa8b577a8, 0xbcb16aa4, 0x4629ad19, 0x3c4ad1b0,
            0xe98a77d8, 0x02c1512d, 0xd9978493, 0x40fff7bd, 0xa906b83a, 0x8ea423e4, 0xdb4a1248,
            0xa921c857, 0xd09c4038, 0xb42c7686, 0x3ebe915e, 0xa53a8482, 0xedb594da, 0xc793d50c,
            0xacfcac9c, 0xfac581f1, 0x6f78517d, 0x6eac44ab, 0x039e2d1b, 0x5ed34ad4, 0xd50d72f3,
            0x74ad851e, 0x5835fe20, 0xde1ddbf2, 0x8444b9d8, 0xee428740, 0x4c74cb70, 0x9169de2b,
            0x2ecb4f8d, 0xebf1a8fb, 0xdc8fbd2e, 0x93d74df8, 0xa40661c8, 0x4a4432b4, 0xfa695342,
            0xf64048b9, 0x48e572b7, 0xc461096d, 0x612740ba, 0xfd703a7c, 0x58ff386d, 0x8e44cd3e,
            0xcfb8c4e9, 0xfc36d331, 0x8a811839, 0x768c252b, 0xea24d11e, 0xc3f483b7, 0xd7331686,
            0x1c587b6d, 0x0749296a, 0xa3bc8fab, 0xcaf4bc1a, 0x2c1543f2, 0xc5576faa, 0x53910ccf,
            0x44a8ebbf, 0xc8bb8201, 0xd3d64e7f, 0x844d7979, 0x68263aa1, 0xeea22a0c, 0x8a2daf92,
            0x6e375407, 0x7868d595, 0x1c534304, 0xece1cc59, 0x3b6cd743, 0x8c283bcb, 0x29710f86,
            0x3f09cbd1, 0x451b766c, 0xe175db5a, 0x80324f3a, 0xbac3a209, 0x47116bfc, 0x79606812,
            0x6e6e28a1, 0xceb822ca, 0xabf12331, 0x4da278e4, 0xfd184ab8, 0x70a12ddc, 0x72d2bcb1,
            0x8b974b08, 0x01345931, 0x908aac26, 0xe375af99, 0x76472182, 0xc442aec0, 0xdbdf13e2,
            0xd852798f, 0x7430f81b, 0xa0edde97, 0x01b3afe4, 0xcb4389aa, 0x441337af, 0xab5a33b8,
            0x62efff53, 0xcb864caf, 0x5d02a96a, 0xb2afa154, 0x1320b997, 0x8f27aee7, 0xf83b9753,
            0x1303b229, 0xb9e33786, 0x84ce28e8, 0x54d5bdec, 0x162d5cf7, 0xd00329e6, 0xa6044b5e,
            0x7e17dab9, 0xb9360bfa, 0xf4cba9ef, 0x7514c63f, 0x26564beb, 0x230aac92, 0xf95bde60,
            0x94a59099, 0xc84e1d28, 0x8eaf55f4, 0xccf0b808, 0xf2b0e94b, 0x5c23f4b8, 0x3450a594,
            0x45ddecb7, 0x21241b45, 0x89e03cf1, 0x1bdac320, 0x67bd635b, 0x6c97f170, 0xa8675282,
            0xcc166bc4, 0x103b0789, 0xc8276e3c, 0x2efacef9, 0xf79031ac, 0x5e2b3ee0, 0xc37b1e8f,
            0xe8b9ddfb, 0x1c0b1aee, 0x273bd0a8, 0x7c22438b, 0xa4569de9, 0xd0d319e8, 0x3ded70fc,
            0x544e1639, 0x6f0ff72b, 0x432dbe94, 0xc7ade66a, 0x48d55038, 0xba2bda55, 0xc86f6c99,
            0x29edf439, 0x2a6ced53, 0x966aad84, 0xd3145f77, 0x14f1e2da, 0x953eaa5d, 0xb22a8adb,
            0x2562cf32, 0x0956c8e6, 0xe6313587, 0x40f8e355, 0x861f1a82, 0x29406068, 0x6d76ac3a,
            0xcc0f7af4, 0xb07e691f, 0xff44aac6, 0xa4f15e6b, 0xd8b781ba, 0x9b2438f6, 0xf6697f47,
            0x4c98ac8c, 0x7655f0f5, 0x43d88c7f, 0x4a28691b, 0x442995dc, 0x4b2ac80e, 0xb5b42ee5,
            0x0534bc4f, 0x541a82f0, 0xc7e989ec, 0xd58260ae, 0xde264954, 0xed04872a, 0x95312bbe,
            0xd1cd8e07, 0x89a0a062, 0xcb3c09dc, 0x70ec0ab0, 0xf8bffe64, 0x616e10c7, 0xa02ad78b,
            0x7601b157, 0x05e93a18, 0x368450b4, 0x9d38be68, 0xad13e603, 0xb1c2fcbd, 0xf0004a12,
            0xe80cda02, 0x31440f9c, 0x23d6f2c3, 0xabefce0b, 0x4a585ac9, 0x8b6c7c59, 0xb8df2198,
            0x9c1ec85f, 0x644252aa, 0x7883e0b4, 0x92b4edea, 0x33995bde, 0x7104dc61, 0xf82c2e30,
            0x9b5bb6f7, 0x671beead, 0x77571640, 0x6de517fa, 0x25c294d8, 0x2e42f94c, 0x81cdbf3d,
            0x4692794c, 0x3bc8de62, 0x1659ee91, 0x63fc744d, 0x666f6cea, 0x0a0e61ee, 0xe3206c3e,
            0x88a0fd23, 0x8355eab9, 0x8daa4199, 0x61a874e2, 0x6cc7b3d9, 0x6d1228e9, 0x4ba073e0,
            0x5155775a, 0x818302d8, 0x551067d1, 0x3eeac632, 0x4cc4ce14, 0x8f616395, 0x2daa2006,
            0x47f39374, 0xd53c0b2d, 0x7b1fcef8, 0xf25a2e10, 0xfdaa543d, 0x11c93f56, 0x1131d348,
            0x5a636c28, 0x73ddee4f, 0x54ea1e06, 0x829f4b01, 0xad718346, 0xf5c91926, 0x7407577d,
            0x4c2e08b4, 0xf13072fd, 0x98f57472, 0xa592bba9, 0xd2488102, 0x51471cc4, 0x0ff1f82f,
            0x0248abbb, 0xb8f3bccb, 0xcfabd085, 0x48954897, 0x1eda3508, 0x83d43466, 0xddfbbe02,
            0xbd39e6e1, 0x7573e2ed, 0xa524da05, 0x217e2c0d, 0xa264844d, 0x736f238f, 0x848fbaeb,
            0xaa131565, 0xe8107eed, 0x96a8d341, 0xa8544659, 0xf8fb37ef, 0xc60446fd, 0xcb0b5591,
            0x415b7188, 0xa1a13d09, 0xd4800103, 0xf191bbde, 0xbb26ab7e, 0xa9a5a644, 0x2c57e0f5,
            0x741988d1, 0x9cbf46a4, 0xfec994c1, 0x772c27e5, 0x83510461, 0x84c7a308, 0x02e4b7cf,
            0x63ad4472, 0x9088bf90, 0x56b92b1d, 0xa4c6cc48, 0xcd9da88d, 0x3afc2635, 0x2a5796a5,
            0x97b99c63, 0xd994a575, 0x826143dd, 0x71ea2f31, 0x9baddb4a, 0x7728b593, 0x8983ad01,
            0xcea20934, 0xbedbc360, 0xf5c75327, 0x3b30db69, 0x3cda622c, 0x1b18ae1e, 0x5fc2dc3b,
            0x4aa361a4, 0x3c226c96, 0xb4cbcd59, 0x41951244, 0xea9d7874, 0xa4485208, 0x9c10a258,
            0x07342ed6, 0x7371f848, 0x58fa5109, 0xdaf6dc1c, 0xd8f31bc1, 0xbef28f1a, 0xe11ae4f1,
            0x016efa1e, 0xbd1d2440, 0x419db32c, 0x917d36dc, 0xd1eca3d0, 0x48b757d5, 0xb14bec40,
            0x82f8bce8, 0xf61e5025, 0x4b6dc705, 0x621cd6aa, 0x2546671c, 0xfadcf1dd, 0x7c7c1db7,
            0x50c81032, 0xdce4b8db, 0x25bc5bc7, 0xa94d9098, 0x9e9cc3c3, 0x346ad4b0, 0x72edc1a4,
            0x25dc19a4, 0x5b688dda, 0xc70bf934, 0xee8fa3a6, 0xd6823d60, 0x5b032c77, 0x7cd7cd43,
            0x8b496772, 0x75013b32, 0x4e26b848, 0x5cb00eca, 0xe7b41fbd, 0x23d4868d, 0x722e7646,
            0x78235e64, 0xcc70dde3, 0x6d4c78bf, 0x10debf80, 0xe75f4bad, 0xe7042098, 0x1c3c80cb,
            0x80ac4548, 0x6f8faf7e, 0x445b2526, 0xa35a5e1e, 0x4cd1f860, 0x98a92986, 0x028203d0,
            0x6a6f7b02, 0x0013b180, 0x5c4f252f, 0xf4908a63, 0x96908e65, 0x210fe8c3, 0x56514428,
            0x27085f5d, 0xada94f43, 0x9969e2d9, 0x3a2abca5, 0x908d544a, 0x231bdfc9, 0x89875146,
            0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x01000000,
            0x1e160e08, 0x00302a22,
        ],
    };
}

pub fn test_sign_external_mu() {
    let mut trng = unsafe {
        Trng::new(
            CsrngReg::new(),
            EntropySrcReg::new(),
            SocIfcTrngReg::new(),
            &SocIfcReg::new(),
        )
        .unwrap()
    };
    let mut entropy_gen = || trng.generate4();

    // This needs to happen in the first test
    CfiCounter::reset(&mut entropy_gen);

    let mut ml_dsa87 = unsafe { Mldsa87::new(AbrReg::new()) };

    let sign_rnd = Mldsa87SignRnd::default(); // Deterministic signing
    let test = acvp_vector::EXTERNAL_MU_TEST;

    let signature = ml_dsa87
        .sign_external_mu(
            Mldsa87Seed::PrivKey(&Mldsa87PrivKey::from(test.sk)),
            &Mldsa87PubKey::from(test.pk),
            &test.external_mu.into(),
            &sign_rnd,
            &mut trng,
        )
        .unwrap();
    assert_eq!(signature, Mldsa87Signature::from(test.signature));
}

pub fn test_verify_external_mu() {
    let mut ml_dsa87 = unsafe { Mldsa87::new(AbrReg::new()) };

    let test = acvp_vector::EXTERNAL_MU_TEST;
    assert_eq!(
        ml_dsa87
            .verify_external_mu(
                &Mldsa87PubKey::from(test.pk),
                &test.external_mu.into(),
                &Mldsa87Signature::from(test.signature)
            )
            .unwrap(),
        Mldsa87Result::Success
    );
}

test_suite! {
    test_sign_external_mu,
    test_verify_external_mu,
}
